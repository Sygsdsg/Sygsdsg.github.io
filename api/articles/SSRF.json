{"title":"SSRF","uid":"41141451a0f1e1bb096d2164075e94d3","slug":"SSRF","date":"2024-10-24T06:13:31.000Z","updated":"2024-10-24T06:14:48.899Z","comments":true,"path":"api/articles/SSRF.json","keywords":null,"cover":"/image/2.jpg","content":"<h1 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h1><p><img src=\"/post/SSRF/clip_image002.png\" alt=\"img\"></p>\n<p><img src=\"/post/SSRF/clip_image004.png\" alt=\"img\"></p>\n<h2 id=\"SSRF信息收集\"><a href=\"#SSRF信息收集\" class=\"headerlink\" title=\"SSRF信息收集\"></a>SSRF信息收集</h2><h2 id=\"ssrf信息收集File伪协议-扫描内网主机\"><a href=\"#ssrf信息收集File伪协议-扫描内网主机\" class=\"headerlink\" title=\"ssrf信息收集File伪协议 扫描内网主机\"></a>ssrf信息收集File伪协议 扫描内网主机</h2><h3 id=\"查看内网地址-file-etc-host\"><a href=\"#查看内网地址-file-etc-host\" class=\"headerlink\" title=\"查看内网地址 file:&#x2F;&#x2F;&#x2F;etc&#x2F;host\"></a>查看内网地址 <a href=\"file:///etc/host\">file:&#x2F;&#x2F;&#x2F;etc&#x2F;host</a></h3><p><img src=\"/post/SSRF/clip_image006.png\" alt=\"img\"></p>\n<h3 id=\"寻找内网其他主机-file-proc-net-arp\"><a href=\"#寻找内网其他主机-file-proc-net-arp\" class=\"headerlink\" title=\"寻找内网其他主机 file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arp\"></a>寻找内网其他主机 <a href=\"file:///proc/net/arp\">file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arp</a></h3><p><strong>Arp协议</strong>可无视防火墙 只要在工作即可扫出来</p>\n<p>配合BP扫描该<strong>网段</strong></p>\n<p><img src=\"/post/SSRF/clip_image008.png\" alt=\"img\"><img src=\"/post/SSRF/clip_image010.png\" alt=\"img\"><img src=\"/post/SSRF/clip_image012.png\" alt=\"img\"></p>\n<h2 id=\"ssrf信息收集Ditc伪协议-扫描内网主机端口\"><a href=\"#ssrf信息收集Ditc伪协议-扫描内网主机端口\" class=\"headerlink\" title=\"ssrf信息收集Ditc伪协议 扫描内网主机端口\"></a>ssrf信息收集Ditc伪协议 扫描内网主机端口</h2><h3 id=\"运用BP集束炸弹模式扫描网段和端口\"><a href=\"#运用BP集束炸弹模式扫描网段和端口\" class=\"headerlink\" title=\"运用BP集束炸弹模式扫描网段和端口\"></a>运用BP<strong>集束炸弹模式</strong>扫描<strong>网段</strong>和<strong>端口</strong></h3><p>​    <strong>操作同理</strong></p>\n<p><img src=\"/post/SSRF/clip_image014.png\" alt=\"img\"></p>\n<h3 id=\"Ditc伪协议-扫描速度快\"><a href=\"#Ditc伪协议-扫描速度快\" class=\"headerlink\" title=\"Ditc伪协议 扫描速度快\"></a><strong>Ditc伪协议 扫描速度快</strong></h3><p>端口扫描常用端口</p>\n<p><img src=\"/post/SSRF/clip_image016.png\" alt=\"img\"></p>\n<h2 id=\"ssrf信息收集HTTP伪协议-扫描子域\"><a href=\"#ssrf信息收集HTTP伪协议-扫描子域\" class=\"headerlink\" title=\"ssrf信息收集HTTP伪协议 扫描子域\"></a>ssrf信息收集HTTP伪协议 扫描子域</h2><h3 id=\"配合BP导入字典扫描\"><a href=\"#配合BP导入字典扫描\" class=\"headerlink\" title=\"配合BP导入字典扫描\"></a><strong>配合BP导入字典扫描</strong></h3><p><strong><img src=\"/post/SSRF/clip_image018.png\" alt=\"img\"></strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image020.png\" alt=\"img\"><img src=\"/post/SSRF/clip_image022.png\" alt=\"img\"></strong></p>\n<h2 id=\"SSRF-Gopher伪协议\"><a href=\"#SSRF-Gopher伪协议\" class=\"headerlink\" title=\"SSRF Gopher伪协议\"></a>SSRF Gopher伪协议</h2><p>​    <img src=\"/post/SSRF/clip_image024.png\" alt=\"img\"></p>\n<h3 id=\"GET传参poc\"><a href=\"#GET传参poc\" class=\"headerlink\" title=\"GET传参poc\"></a>GET传参poc</h3><p>​    <img src=\"/post/SSRF/clip_image026.png\" alt=\"img\"></p>\n<p><strong>进行url编码</strong></p>\n<p>[gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;**_**GET%20&#x2F;name.php%3fname&#x3D;benben%20HTTP&#x2F;1.1%0d%0AHost:%20172.250.250.4%0d%0A](gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;_GET &#x2F;name.php%3fname&#x3D;benben HTTP&#x2F;1.1 Host: 172.250.250.4 )  </p>\n<p>GET提交最后一定要增加一个换行符 %0d%0a</p>\n<p>​    <img src=\"/post/SSRF/clip_image028.png\" alt=\"img\"><img src=\"/post/SSRF/clip_image030.png\" alt=\"img\">、</p>\n<p>也可以传一个 <strong>gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;_</strong> <strong>再将poc粘贴在后边</strong>（记得要2次URL编码可搭配BP或Hackbar）演示方法如下</p>\n<h3 id=\"POST传参poc\"><a href=\"#POST传参poc\" class=\"headerlink\" title=\"POST传参poc\"></a><strong>POST传参poc</strong></h3><p><strong><img src=\"/post/SSRF/clip_image032.png\" alt=\"img\"></strong></p>\n<p>Content-length 要和提交长度相对应 如上 <strong>name&#x3D;jianjian 有十三个</strong>字符 <strong>leangth为13</strong> </p>\n<p><strong>将poc放入拦截网站下划线后</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image034.png\" alt=\"img\"></strong></p>\n<p><strong>选中的部分进行两次URL编码</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image036.png\" alt=\"img\"></strong></p>\n<p><strong>编码后如图</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image038.png\" alt=\"img\"></strong></p>\n<p><strong>放行即可</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image040.png\" alt=\"img\"></strong></p>\n<p><img src=\"/post/SSRF/clip_image042.png\" alt=\"img\"></p>\n<h2 id=\"SSRF之回环地址绕过\"><a href=\"#SSRF之回环地址绕过\" class=\"headerlink\" title=\"SSRF之回环地址绕过\"></a>SSRF之回环地址绕过</h2><p><strong><img src=\"/post/SSRF/clip_image044.png\" alt=\"img\"></strong></p>\n<p>​    <strong>可见 127.0.0.1被禁止</strong></p>\n<h3 id=\"可以将点分十进制转换成十进制\"><a href=\"#可以将点分十进制转换成十进制\" class=\"headerlink\" title=\"可以将点分十进制转换成十进制\"></a>可以将点分十进制转换成十进制</h3><p>​    <strong>2130706433 即可绕过</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image046.png\" alt=\"img\"></strong></p>\n<p>​    <strong>其他进制同理</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image048.png\" alt=\"img\"></strong></p>\n<h2 id=\"SSRF之302重定向绕过\"><a href=\"#SSRF之302重定向绕过\" class=\"headerlink\" title=\"SSRF之302重定向绕过\"></a>SSRF之302重定向绕过</h2><p><img src=\"/post/SSRF/clip_image050.png\" alt=\"img\"></p>\n<p><strong>先搭建一个公网服务 （用php搭建）</strong></p>\n<p><strong>代码如下</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image052.png\" alt=\"img\"></strong></p>\n<p><strong>实现一个302重定向到127.0.0.1的功能</strong></p>\n<p>开启网站服务</p>\n<p><strong><img src=\"/post/SSRF/clip_image054.png\" alt=\"img\"></strong></p>\n<p>再将监听的ip映射到<strong>公网服务器</strong>上</p>\n<p>访问公网ip之后即可重定向并返回到对方服务器下的flag.php的内容<img src=\"/post/SSRF/clip_image056.png\" alt=\"img\"></p>\n<p><img src=\"/post/SSRF/clip_image058.png\" alt=\"img\"></p>\n<h3 id=\"SSRF之DNS重绑定绕过\"><a href=\"#SSRF之DNS重绑定绕过\" class=\"headerlink\" title=\"SSRF之DNS重绑定绕过\"></a>SSRF之DNS重绑定绕过</h3><p>​    DNS重绑定网站 <a href=\"http://lock.cmpxchg8b.com/rebinder.html\">http://lock.cmpxchg8b.com/rebinder.html</a></p>\n<p>​    <img src=\"/post/SSRF/clip_image060.png\" alt=\"img\"> </p>\n<p>​    <img src=\"/post/SSRF/clip_image062.png\" alt=\"img\"></p>\n<h2 id=\"SSRF之命令执行\"><a href=\"#SSRF之命令执行\" class=\"headerlink\" title=\"SSRF之命令执行\"></a>SSRF之命令执行</h2><p>​    <strong>可以直接传cmd命令</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image064.png\" alt=\"img\"></strong></p>\n<p>​    <strong>也可以搭配gopher协议使用 来传POST参数</strong></p>\n<h2 id=\"SSRF之XXE漏洞利用\"><a href=\"#SSRF之XXE漏洞利用\" class=\"headerlink\" title=\"SSRF之XXE漏洞利用\"></a>SSRF之XXE漏洞利用</h2><p>​    <strong>通过快照可知为post传参</strong></p>\n<p> <strong><img src=\"/post/SSRF/clip_image066.png\" alt=\"img\"></strong></p>\n<p>​    <strong>通过源代码可知content-type为xml 从而可以利用xxe漏洞</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image068.png\" alt=\"img\"></strong></p>\n<p>​    <strong>Poc构造如下</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image070.png\" alt=\"img\"></strong></p>\n<p>​    <strong>最后再利用gopher伪协议来提交POST参数</strong></p>\n<h2 id=\"SSRF之SQL注入\"><a href=\"#SSRF之SQL注入\" class=\"headerlink\" title=\"SSRF之SQL注入\"></a>SSRF之SQL注入</h2><p>GET注意两点即可</p>\n<p>​    <strong>1</strong></p>\n<p>​    <strong><img src=\"/post/SSRF/clip_image072.png\" alt=\"img\"></strong></p>\n<p><strong>2</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image074.png\" alt=\"img\"></strong></p>\n<h3 id=\"POST注入\"><a href=\"#POST注入\" class=\"headerlink\" title=\"POST注入\"></a>POST注入</h3><p><strong>仍是利用gophar构造poc</strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image076.png\" alt=\"img\"></strong></p>\n<h2 id=\"SSRF之文件上传\"><a href=\"#SSRF之文件上传\" class=\"headerlink\" title=\"SSRF之文件上传\"></a>SSRF之文件上传</h2><p>​    <strong>利用gophar构造poc （注意content-type变化）</strong></p>\n<p> <strong><img src=\"/post/SSRF/clip_image078.png\" alt=\"img\"></strong></p>\n<p>Ps:boundary&#x3D;xxxxx xxxxx可<strong>自定义 在上边poc中 –xxxxx为分割符 –xxxxx–为结束符</strong></p>\n<p>​    <strong>上传完成之后访问文件目录即可</strong><strong><img src=\"/post/SSRF/clip_image080.png\" alt=\"img\"></strong></p>\n<p><strong><img src=\"/post/SSRF/clip_image082.png\" alt=\"img\"></strong></p>\n<h2 id=\"SSRF写入操作\"><a href=\"#SSRF写入操作\" class=\"headerlink\" title=\"SSRF写入操作\"></a>SSRF写入操作</h2><p>​    <strong>【0x016 使用SSRF对mysql进行未授权查询】</strong><a href=\"https://www.bilibili.com/video/BV1qQ4y1u7S4?vd_source=dbbe851caa5969ed57ce1b7f9b095e7c\"><strong>https://www.bilibili.com/video/BV1qQ4y1u7S4?vd_source&#x3D;dbbe851caa5969ed57ce1b7f9b095e7c</strong></a></p>\n<p>​    <strong>16-21</strong></p>\n<p>​    </p>\n<h1 id=\"常见的绕过方式总结\"><a href=\"#常见的绕过方式总结\" class=\"headerlink\" title=\"常见的绕过方式总结\"></a>常见的绕过方式总结</h1><h3 id=\"1、限制为http-www-xxx-com-域名时（利用-）\"><a href=\"#1、限制为http-www-xxx-com-域名时（利用-）\" class=\"headerlink\" title=\"1、限制为http://www.xxx.com 域名时（利用@）\"></a>1、限制为<a href=\"http://www.xxx.com/\">http://www.xxx.com</a> 域名时（利用@）</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">可以尝试采用http基本身份认证的方式绕过</span></span>\n<span class=\"line\"><span style=\"color: #575279\">如：http://www.aaa.com@www.bbb.com@www.ccc.com，在对@解析域名中，不同的处理函数存在处理差异</span></span>\n<span class=\"line\"><span style=\"color: #575279\">在PHP的parse_url中会识别www.ccc.com，而libcurl则识别为www.bbb.com。</span></span></code></pre></div><h3 id=\"2-采用短网址绕过\"><a href=\"#2-采用短网址绕过\" class=\"headerlink\" title=\"2.采用短网址绕过\"></a>2.采用短网址绕过</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">比如百度短地址https://dwz.cn/</span></span></code></pre></div><h3 id=\"3-采用进制转换\"><a href=\"#3-采用进制转换\" class=\"headerlink\" title=\"3.采用进制转换\"></a>3.采用进制转换</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">127.0.0.1八进制：0177.0.0.1。十六进制：0x7f.0.0.1。十进制：2130706433.</span></span></code></pre></div><p>在这里插入图片描述</p>\n<h3 id=\"4-利用特殊域名\"><a href=\"#4-利用特殊域名\" class=\"headerlink\" title=\"4.利用特殊域名\"></a>4.利用特殊域名</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">原理是DNS解析。xip.io可以指向任意域名，即</span></span>\n<span class=\"line\"><span style=\"color: #575279\">127.0.0.1.xip.io，可解析为127.0.0.1</span></span>\n<span class=\"line\"><span style=\"color: #575279\">(xip.io 现在好像用不了了，可以找找其他的)</span></span></code></pre></div><h3 id=\"5-利用\"><a href=\"#5-利用\" class=\"headerlink\" title=\"5.利用[::]\"></a>5.利用[::]</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">可以利用[::]来绕过localhost</span></span>\n<span class=\"line\"><span style=\"color: #575279\">http://169.254.169.254&gt;&gt;http://[::169.254.169.254]</span></span></code></pre></div><h3 id=\"6-利用句号\"><a href=\"#6-利用句号\" class=\"headerlink\" title=\"6.利用句号\"></a>6.利用句号</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">127。0。0。1 &gt;&gt;&gt; 127.0.0.1</span></span></code></pre></div><h3 id=\"7、CRLF-编码绕过\"><a href=\"#7、CRLF-编码绕过\" class=\"headerlink\" title=\"7、CRLF 编码绕过\"></a>7、CRLF 编码绕过</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">%0d-&gt;0x0d-&gt;\\r回车</span></span>\n<span class=\"line\"><span style=\"color: #575279\">%0a-&gt;0x0a-&gt;\\n换行</span></span>\n<span class=\"line\"><span style=\"color: #575279\">进行HTTP头部注入</span></span></code></pre></div><p>example.com&#x2F;?url&#x3D;<a href=\"http://eval.com%0d%0aHOST:fuzz.com%0d%0a\">http://eval.com%0d%0aHOST:fuzz.com%0d%0a</a> </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">1</span></span></code></pre></div><h3 id=\"8-利用封闭的字母数字\"><a href=\"#8-利用封闭的字母数字\" class=\"headerlink\" title=\"8.利用封闭的字母数字\"></a>8.利用封闭的字母数字</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki rose-pine-dawn\" style=\"background-color: #2b0a37\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #575279\">利用Enclosed alphanumerics</span></span>\n<span class=\"line\"><span style=\"color: #575279\">ⓔⓧⓐⓜⓟⓛⓔ.ⓒⓞⓜ &gt;&gt;&gt; example.com</span></span>\n<span class=\"line\"><span style=\"color: #575279\">http://169.254.169.254&gt;&gt;&gt;http://[::①⑥⑨｡②⑤④｡⑯⑨｡②⑤④]</span></span>\n<span class=\"line\"><span style=\"color: #575279\">List:</span></span>\n<span class=\"line\"><span style=\"color: #575279\">① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩ ⑪ ⑫ ⑬ ⑭ ⑮ ⑯ ⑰ ⑱ ⑲ ⑳</span></span>\n<span class=\"line\"><span style=\"color: #575279\">⑴ ⑵ ⑶ ⑷ ⑸ ⑹ ⑺ ⑻ ⑼ ⑽ ⑾ ⑿ ⒀ ⒁ ⒂ ⒃ ⒄ ⒅ ⒆ ⒇</span></span>\n<span class=\"line\"><span style=\"color: #575279\">⒈ ⒉ ⒊ ⒋ ⒌ ⒍ ⒎ ⒏ ⒐ ⒑ ⒒ ⒓ ⒔ ⒕ ⒖ ⒗ ⒘ ⒙ ⒚ ⒛</span></span>\n<span class=\"line\"><span style=\"color: #575279\">⒜ ⒝ ⒞ ⒟ ⒠ ⒡ ⒢ ⒣ ⒤ ⒥ ⒦ ⒧ ⒨ ⒩ ⒪ ⒫ ⒬ ⒭ ⒮ ⒯ ⒰ ⒱ ⒲ ⒳ ⒴ ⒵</span></span>\n<span class=\"line\"><span style=\"color: #575279\">Ⓐ Ⓑ Ⓒ Ⓓ Ⓔ Ⓕ Ⓖ Ⓗ Ⓘ Ⓙ Ⓚ Ⓛ Ⓜ Ⓝ Ⓞ Ⓟ Ⓠ Ⓡ Ⓢ Ⓣ Ⓤ Ⓥ Ⓦ Ⓧ Ⓨ Ⓩ</span></span>\n<span class=\"line\"><span style=\"color: #575279\">ⓐ ⓑ ⓒ ⓓ ⓔ ⓕ ⓖ ⓗ ⓘ ⓙ ⓚ ⓛ ⓜ ⓝ ⓞ ⓟ ⓠ ⓡ ⓢ ⓣ ⓤ ⓥ ⓦ ⓧ ⓨ ⓩ</span></span>\n<span class=\"line\"><span style=\"color: #575279\">⓪ ⓫ ⓬ ⓭ ⓮ ⓯ ⓰ ⓱ ⓲ ⓳ ⓴</span></span>\n<span class=\"line\"><span style=\"color: #575279\">⓵ ⓶ ⓷ ⓸ ⓹ ⓺ ⓻ ⓼ ⓽ ⓾ ⓿</span></span></code></pre></div>","text":"SSRF SSRF信息收集ssrf信息收集File伪协议 扫描内网主机查看内网地址 file:///etc/host 寻找内网其他主机 file:///proc...","permalink":"/post/SSRF","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"ctf","slug":"ctf","count":7,"path":"api/tags/ctf.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#SSRF\"><span class=\"toc-text\">SSRF</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\"><span class=\"toc-text\">SSRF信息收集</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ssrf%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86File%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E6%89%AB%E6%8F%8F%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA\"><span class=\"toc-text\">ssrf信息收集File伪协议 扫描内网主机</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E5%86%85%E7%BD%91%E5%9C%B0%E5%9D%80-file-etc-host\"><span class=\"toc-text\">查看内网地址 file:&#x2F;&#x2F;&#x2F;etc&#x2F;host</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AF%BB%E6%89%BE%E5%86%85%E7%BD%91%E5%85%B6%E4%BB%96%E4%B8%BB%E6%9C%BA-file-proc-net-arp\"><span class=\"toc-text\">寻找内网其他主机 file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ssrf%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86Ditc%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E6%89%AB%E6%8F%8F%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E7%AB%AF%E5%8F%A3\"><span class=\"toc-text\">ssrf信息收集Ditc伪协议 扫描内网主机端口</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BF%90%E7%94%A8BP%E9%9B%86%E6%9D%9F%E7%82%B8%E5%BC%B9%E6%A8%A1%E5%BC%8F%E6%89%AB%E6%8F%8F%E7%BD%91%E6%AE%B5%E5%92%8C%E7%AB%AF%E5%8F%A3\"><span class=\"toc-text\">运用BP集束炸弹模式扫描网段和端口</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Ditc%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E6%89%AB%E6%8F%8F%E9%80%9F%E5%BA%A6%E5%BF%AB\"><span class=\"toc-text\">Ditc伪协议 扫描速度快</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ssrf%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86HTTP%E4%BC%AA%E5%8D%8F%E8%AE%AE-%E6%89%AB%E6%8F%8F%E5%AD%90%E5%9F%9F\"><span class=\"toc-text\">ssrf信息收集HTTP伪协议 扫描子域</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E5%90%88BP%E5%AF%BC%E5%85%A5%E5%AD%97%E5%85%B8%E6%89%AB%E6%8F%8F\"><span class=\"toc-text\">配合BP导入字典扫描</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF-Gopher%E4%BC%AA%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">SSRF Gopher伪协议</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GET%E4%BC%A0%E5%8F%82poc\"><span class=\"toc-text\">GET传参poc</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#POST%E4%BC%A0%E5%8F%82poc\"><span class=\"toc-text\">POST传参poc</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8B%E5%9B%9E%E7%8E%AF%E5%9C%B0%E5%9D%80%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">SSRF之回环地址绕过</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%AF%E4%BB%A5%E5%B0%86%E7%82%B9%E5%88%86%E5%8D%81%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%E6%88%90%E5%8D%81%E8%BF%9B%E5%88%B6\"><span class=\"toc-text\">可以将点分十进制转换成十进制</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8B302%E9%87%8D%E5%AE%9A%E5%90%91%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">SSRF之302重定向绕过</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8BDNS%E9%87%8D%E7%BB%91%E5%AE%9A%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">SSRF之DNS重绑定绕过</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C\"><span class=\"toc-text\">SSRF之命令执行</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8BXXE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">SSRF之XXE漏洞利用</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8BSQL%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">SSRF之SQL注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#POST%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">POST注入</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\"><span class=\"toc-text\">SSRF之文件上传</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SSRF%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">SSRF写入操作</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">常见的绕过方式总结</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E3%80%81%E9%99%90%E5%88%B6%E4%B8%BAhttp-www-xxx-com-%E5%9F%9F%E5%90%8D%E6%97%B6%EF%BC%88%E5%88%A9%E7%94%A8-%EF%BC%89\"><span class=\"toc-text\">1、限制为http:&#x2F;&#x2F;www.xxx.com 域名时（利用@）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E9%87%87%E7%94%A8%E7%9F%AD%E7%BD%91%E5%9D%80%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">2.采用短网址绕过</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E9%87%87%E7%94%A8%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2\"><span class=\"toc-text\">3.采用进制转换</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E5%88%A9%E7%94%A8%E7%89%B9%E6%AE%8A%E5%9F%9F%E5%90%8D\"><span class=\"toc-text\">4.利用特殊域名</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5-%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">5.利用[::]</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#6-%E5%88%A9%E7%94%A8%E5%8F%A5%E5%8F%B7\"><span class=\"toc-text\">6.利用句号</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#7%E3%80%81CRLF-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">7、CRLF 编码绕过</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#8-%E5%88%A9%E7%94%A8%E5%B0%81%E9%97%AD%E7%9A%84%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97\"><span class=\"toc-text\">8.利用封闭的字母数字</span></a></li></ol></li></ol></li></ol>","author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"sudo","uid":"411ff314093c5c27d7d9daaaa1c43d8a","slug":"sudo","date":"2024-10-30T11:01:49.000Z","updated":"2024-10-30T11:06:54.705Z","comments":true,"path":"api/articles/sudo.json","keywords":null,"cover":"/image/10.png","text":"SUDOGTFOBins 1sudo -l CVE-2019-14287aptapache2ashawkbase64bashcpcpulimitcurldate...","permalink":"/post/sudo","photos":[],"count_time":{"symbolsCount":397,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"sudo提权","slug":"sudo提权","count":1,"path":"api/tags/sudo提权.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"LFI","uid":"8b370a147ba28b5f9bf92d0ab1030d7d","slug":"LFI","date":"2024-10-23T13:05:28.000Z","updated":"2024-11-12T12:04:18.398Z","comments":true,"path":"api/articles/LFI.json","keywords":null,"cover":"/image/5.jpg","text":"文件包含相关函数文件读取函数 fopen(): 打开一个文件或 URL，返回文件句柄。 fread(): 读取文件的指定字节数。 fgets(): 从文件指针中...","permalink":"/post/LFI","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[{"name":"ctf入门","slug":"ctf入门","count":7,"path":"api/categories/ctf入门.json"}],"tags":[{"name":"ctf","slug":"ctf","count":7,"path":"api/tags/ctf.json"}],"author":{"name":"Sygsdsg","slug":"blog-author","avatar":"https://img.picui.cn/free/2024/10/23/6718a2ef955e1.jpg","link":"/","description":"嘻嘻","socials":{"github":"https://github.com/Sygsdsg/Sygsdsg.github.io","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}